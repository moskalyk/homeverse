(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PCrypto=(()=>{var ec=Object.create;var en=Object.defineProperty;var rc=Object.getOwnPropertyDescriptor;var nc=Object.getOwnPropertyNames;var ic=Object.getPrototypeOf,oc=Object.prototype.hasOwnProperty;var Q=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),bt=(t,e)=>{for(var r in e)en(t,r,{get:e[r],enumerable:!0})},na=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of nc(e))!oc.call(t,i)&&i!==r&&en(t,i,{get:()=>e[i],enumerable:!(n=rc(e,i))||n.enumerable});return t};var Et=(t,e,r)=>(r=t!=null?ec(ic(t)):{},na(e||!t||!t.__esModule?en(r,"default",{value:t,enumerable:!0}):r,t)),ac=t=>na(en({},"__esModule",{value:!0}),t);var ft=Q((Yp,aa)=>{aa.exports={options:{usePureJavaScript:!1}}});var ca=Q((Zp,fa)=>{var ri={};fa.exports=ri;var sa={};ri.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=sc(t,e);else{var i=0,o=e.length,s=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<a.length;++f)c+=a[f]<<8,a[f]=c%o,c=c/o|0;for(;c>0;)a.push(c%o),c=c/o|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};ri.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=sa[e];if(!r){r=sa[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),s=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var f=0,c=a;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===o&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function sc(t,e){var r=0,n=e.length,i=e.charAt(0),o=[0];for(r=0;r<t.length();++r){for(var s=0,a=t.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=o.length-1;r>=0;--r)f+=e[o[r]];return f}});var Bt=Q(($p,da)=>{var ua=ft(),ha=ca(),g=da.exports=ua.util=ua.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(a){return setImmediate(a)};return}if(g.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=a,t="forge.setImmediate",e=[];g.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var o=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),o(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self>"u"?window:self}();g.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};g.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};g.isArrayBufferView=function(t){return t&&g.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Lr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}g.ByteBuffer=ni;function ni(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(g.isArrayBuffer(t)||g.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof ni||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}g.ByteStringBuffer=ni;var fc=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>fc&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};g.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};g.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};g.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(g.encodeUtf8(t))};g.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};g.ByteStringBuffer.prototype.putInt=function(t,e){Lr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};g.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};g.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};g.ByteStringBuffer.prototype.getInt=function(t){Lr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};g.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};g.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var t=g.createBuffer(this.data);return t.read=this.read,t};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function cc(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=g.isArrayBuffer(t),n=g.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}g.DataBuffer=cc;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};g.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};g.DataBuffer.prototype.putBytes=function(t,e){if(g.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof g.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&g.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof g.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var o;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(t,o,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(t,o,this.write),this;if(e==="utf8"&&(t=g.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(o),this;if(e==="utf16")return this.accommodate(t.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};g.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};g.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};g.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(t,e){Lr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};g.DataBuffer.prototype.putSignedInt=function(t,e){return Lr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};g.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};g.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};g.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};g.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};g.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};g.DataBuffer.prototype.getInt=function(t){Lr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};g.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};g.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return g.binary.raw.encode(e);if(t==="hex")return g.binary.hex.encode(e);if(t==="base64")return g.binary.base64.encode(e);if(t==="utf8")return g.text.utf8.decode(e);if(t==="utf16")return g.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};g.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=g.encodeUtf8(t)),new g.ByteBuffer(t)};g.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};g.xorBytes=function(t,e,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o,n};g.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};g.bytesToHex=function(t){return g.createBuffer(t).toHex()};g.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var De="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ne=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],la="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.length;)i=t.charCodeAt(a++),o=t.charCodeAt(a++),s=t.charCodeAt(a++),r+=De.charAt(i>>2),r+=De.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=De.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":De.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,o,s=0;s<t.length;)r=Ne[t.charCodeAt(s++)-43],n=Ne[t.charCodeAt(s++)-43],i=Ne[t.charCodeAt(s++)-43],o=Ne[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(e+=String.fromCharCode((i&3)<<6|o)));return e};g.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};g.decodeUtf8=function(t){return decodeURIComponent(escape(t))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:ha.encode,decode:ha.decode}};g.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};g.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,o=r;for(t.length&1&&(i=1,n[o++]=parseInt(t[0],16));i<t.length;i+=2)n[o++]=parseInt(t.substr(i,2),16);return e?o-r:n};g.binary.base64.encode=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.byteLength;)i=t[a++],o=t[a++],s=t[a++],r+=De.charAt(i>>2),r+=De.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=De.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":De.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,s,a,f=0,c=r;f<t.length;)i=Ne[t.charCodeAt(f++)-43],o=Ne[t.charCodeAt(f++)-43],s=Ne[t.charCodeAt(f++)-43],a=Ne[t.charCodeAt(f++)-43],n[c++]=i<<2|o>>4,s!==64&&(n[c++]=(o&15)<<4|s>>2,a!==64&&(n[c++]=(s&3)<<6|a));return e?c-r:n.subarray(0,c)};g.binary.base58.encode=function(t,e){return g.binary.baseN.encode(t,la,e)};g.binary.base58.decode=function(t,e){return g.binary.baseN.decode(t,la,e)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(t,e,r){t=g.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};g.text.utf8.decode=function(t){return g.decodeUtf8(String.fromCharCode.apply(null,t))};g.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,s=r,a=0;a<t.length;++a)i[s++]=t.charCodeAt(a),o+=2;return e?o-r:n};g.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};g.deflate=function(t,e,r){if(e=g.decode64(t.deflate(g.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};g.inflate=function(t,e,r){var n=t.inflate(g.encode64(e)).rval;return n===null?null:g.decode64(n)};var ii=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=g.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},oi=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},uc=function(t,e,r,n){var i=oi(t,e);i===null&&(i={}),i[r]=n,ii(t,e,i)},hc=function(t,e,r){var n=oi(t,e);return n!==null&&(n=r in n?n[r]:null),n},lc=function(t,e,r){var n=oi(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),ii(t,e,n)}},dc=function(t,e){ii(t,e,null)},rn=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,s=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),o=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),o=!0)}catch(f){s=f}if(o)break}if(!o)throw s;return n};g.setItem=function(t,e,r,n,i){rn(uc,arguments,i)};g.getItem=function(t,e,r,n){return rn(hc,arguments,n)};g.removeItem=function(t,e,r,n){rn(lc,arguments,n)};g.clearItems=function(t,e,r){rn(dc,arguments,r)};g.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};g.format=function(t){for(var e=/%./g,r,n,i=0,o=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&o.push(n),s=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(t.substring(s)),o.join("")};g.formatNumber=function(t,e,r,n){var i=t,o=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,a=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+a:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-c).toFixed(o).slice(2):"")};g.formatSize=function(t){return t>=1073741824?t=g.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=g.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=g.formatNumber(t/1024,0)+" KiB":t=g.formatNumber(t,0)+" bytes",t};g.bytesFromIP=function(t){return t.indexOf(".")!==-1?g.bytesFromIPv4(t):t.indexOf(":")!==-1?g.bytesFromIPv6(t):null};g.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=g.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};g.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=g.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=g.hexToBytes(t[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};g.bytesToIP=function(t){return t.length===4?g.bytesToIPv4(t):t.length===16?g.bytesToIPv6(t):null};g.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};g.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var o=g.bytesToHex(t[i]+t[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var s=r[r.length-1],a=e.length;!s||a!==s.end+1?r.push({start:a,end:a}):(s.end=a,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(o)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};g.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in g&&!t.update)return e(null,g.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,e(null,g.cores);if(typeof Worker>"u")return g.cores=1,e(null,g.cores);if(typeof Blob>"u")return g.cores=2,e(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var a=Date.now(),f=a+4;Date.now()<f;);self.postMessage({st:a,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,a,f){if(a===0){var c=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return g.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,g.cores)}i(f,function(u,h){s.push(o(f,h)),n(s,a-1,f)})}function i(s,a){for(var f=[],c=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===s){for(var x=0;x<s;++x)f[x].terminate();a(null,c)}}),f.push(h)}for(var u=0;u<s;++u)f[u].postMessage(u)}function o(s,a){for(var f=[],c=0;c<s;++c)for(var u=a[c],h=f[c]=[],l=0;l<s;++l)if(c!==l){var x=a[l];(u.st>x.st&&u.st<x.et||x.st>u.st&&x.st<u.et)&&h.push(l)}return f.reduce(function(d,p){return Math.max(d,p.length)},0)}}});var si=Q((Qp,pa)=>{var _t=ft();Bt();pa.exports=_t.cipher=_t.cipher||{};_t.cipher.algorithms=_t.cipher.algorithms||{};_t.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=_t.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new _t.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};_t.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=_t.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new _t.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};_t.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),_t.cipher.algorithms[t]=e};_t.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in _t.cipher.algorithms?_t.cipher.algorithms[t]:null};var ai=_t.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};ai.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=_t.util.createBuffer(),this.output=t.output||_t.util.createBuffer(),this.mode.start(e)};ai.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ai.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var ci=Q((Xp,ya)=>{var Rt=ft();Bt();Rt.cipher=Rt.cipher||{};var X=ya.exports=Rt.cipher.modes=Rt.cipher.modes||{};X.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};X.ecb.prototype.start=function(t){};X.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};X.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};X.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};X.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};X.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};X.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=nn(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};X.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};X.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};X.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};X.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};X.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0};X.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=nn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0};X.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=nn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};X.ofb.prototype.decrypt=X.ofb.prototype.encrypt;X.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0};X.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=nn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};X.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}on(this._inBlock)};X.ctr.prototype.decrypt=X.ctr.prototype.encrypt;X.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};X.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Rt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Rt.util.createBuffer(t.additionalData):r=Rt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Rt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(fi(n*8)))}this._inBlock=this._j0.slice(0),on(this._inBlock),this._partialBytes=0,r=Rt.util.createBuffer(r),this._aDataLength=fi(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};X.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),on(this._inBlock)};X.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),on(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};X.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Rt.util.createBuffer();var n=this._aDataLength.concat(fi(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};X.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var o=t[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};X.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};X.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,o=this._m[r][i];e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3]}return e};X.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};X.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;a[f]=1<<e-1<<c,o[s]=this.generateSubHashTable(this.multiply(a,t),e)}return o};X.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],f=i[s];i[o+s]=[a[0]^f[0],a[1]^f[1],a[2]^f[2],a[3]^f[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var c=i[o^n];i[o]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function nn(t,e){if(typeof t=="string"&&(t=Rt.util.createBuffer(t)),Rt.util.isArray(t)&&t.length>4){var r=t;t=Rt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Rt.util.isArray(t)){for(var i=[],o=e/4,n=0;n<o;++n)i.push(t.getInt32());t=i}return t}function on(t){t[t.length-1]=t[t.length-1]+1&4294967295}function fi(t){return[t/4294967296|0,t&4294967295]}});var sn=Q((Jp,va)=>{var ut=ft();si();ci();Bt();va.exports=ut.aes=ut.aes||{};ut.aes.startEncrypting=function(t,e,r,n){var i=an({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};ut.aes.createEncryptionCipher=function(t,e){return an({key:t,output:null,decrypt:!1,mode:e})};ut.aes.startDecrypting=function(t,e,r,n){var i=an({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};ut.aes.createDecryptionCipher=function(t,e){return an({key:t,output:null,decrypt:!0,mode:e})};ut.aes.Algorithm=function(t,e){li||ga();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return hi(r._w,n,i,!1)},decrypt:function(n,i){return hi(r._w,n,i,!0)}}}),r._init=!1};ut.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=ut.util.createBuffer(e);else if(ut.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=ut.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!ut.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!ut.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=ma(e,t.decrypt&&!s),this._init=!0}};ut.aes._expandKey=function(t,e){return li||ga(),ma(t,e)};ut.aes._updateBlock=hi;cr("AES-ECB",ut.cipher.modes.ecb);cr("AES-CBC",ut.cipher.modes.cbc);cr("AES-CFB",ut.cipher.modes.cfb);cr("AES-OFB",ut.cipher.modes.ofb);cr("AES-CTR",ut.cipher.modes.ctr);cr("AES-GCM",ut.cipher.modes.gcm);function cr(t,e){var r=function(){return new ut.aes.Algorithm(t,e)};ut.cipher.registerAlgorithm(t,r)}var li=!1,fr=4,Ot,ui,xa,We,Qt;function ga(){li=!0,xa=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Ot=new Array(256),ui=new Array(256),We=new Array(4),Qt=new Array(4);for(var e=0;e<4;++e)We[e]=new Array(256),Qt[e]=new Array(256);for(var r=0,n=0,i,o,s,a,f,c,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Ot[r]=a,ui[a]=r,f=t[a],i=t[r],o=t[i],s=t[o],c=f<<24^a<<16^a<<8^(a^f),u=(i^o^s)<<24^(r^s)<<16^(r^o^s)<<8^(r^i^s);for(var h=0;h<4;++h)We[h][r]=c,Qt[h][a]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function ma(t,e){for(var r=t.slice(0),n,i=1,o=r.length,s=o+6+1,a=fr*s,f=o;f<a;++f)n=r[f-1],f%o===0?(n=Ot[n>>>16&255]<<24^Ot[n>>>8&255]<<16^Ot[n&255]<<8^Ot[n>>>24]^xa[i]<<24,i++):o>6&&f%o===4&&(n=Ot[n>>>24]<<24^Ot[n>>>16&255]<<16^Ot[n>>>8&255]<<8^Ot[n&255]),r[f]=r[f-o]^n;if(e){var c,u=Qt[0],h=Qt[1],l=Qt[2],x=Qt[3],d=r.slice(0);a=r.length;for(var f=0,p=a-fr;f<a;f+=fr,p-=fr)if(f===0||f===a-fr)d[f]=r[p],d[f+1]=r[p+3],d[f+2]=r[p+2],d[f+3]=r[p+1];else for(var y=0;y<fr;++y)c=r[p+y],d[f+(3&-y)]=u[Ot[c>>>24]]^h[Ot[c>>>16&255]]^l[Ot[c>>>8&255]]^x[Ot[c&255]];r=d}return r}function hi(t,e,r,n){var i=t.length/4-1,o,s,a,f,c;n?(o=Qt[0],s=Qt[1],a=Qt[2],f=Qt[3],c=ui):(o=We[0],s=We[1],a=We[2],f=We[3],c=Ot);var u,h,l,x,d,p,y;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],x=e[n?1:3]^t[3];for(var m=3,E=1;E<i;++E)d=o[u>>>24]^s[h>>>16&255]^a[l>>>8&255]^f[x&255]^t[++m],p=o[h>>>24]^s[l>>>16&255]^a[x>>>8&255]^f[u&255]^t[++m],y=o[l>>>24]^s[x>>>16&255]^a[u>>>8&255]^f[h&255]^t[++m],x=o[x>>>24]^s[u>>>16&255]^a[h>>>8&255]^f[l&255]^t[++m],u=d,h=p,l=y;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[x&255]^t[++m],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[x>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[l>>>24]<<24^c[x>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++m],r[n?1:3]=c[x>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^t[++m]}function an(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=ut.cipher.createDecipher(r,t.key):n=ut.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof ut.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var dn=Q((j1,za)=>{var Or=ft();Or.pki=Or.pki||{};var Oi=za.exports=Or.pki.oids=Or.oids=Or.oids||{};function I(t,e){Oi[t]=e,Oi[e]=t}function ot(t,e){Oi[t]=e}I("1.2.840.113549.1.1.1","rsaEncryption");I("1.2.840.113549.1.1.4","md5WithRSAEncryption");I("1.2.840.113549.1.1.5","sha1WithRSAEncryption");I("1.2.840.113549.1.1.7","RSAES-OAEP");I("1.2.840.113549.1.1.8","mgf1");I("1.2.840.113549.1.1.9","pSpecified");I("1.2.840.113549.1.1.10","RSASSA-PSS");I("1.2.840.113549.1.1.11","sha256WithRSAEncryption");I("1.2.840.113549.1.1.12","sha384WithRSAEncryption");I("1.2.840.113549.1.1.13","sha512WithRSAEncryption");I("1.3.101.112","EdDSA25519");I("1.2.840.10040.4.3","dsa-with-sha1");I("1.3.14.3.2.7","desCBC");I("1.3.14.3.2.26","sha1");I("1.3.14.3.2.29","sha1WithRSASignature");I("2.16.840.1.101.3.4.2.1","sha256");I("2.16.840.1.101.3.4.2.2","sha384");I("2.16.840.1.101.3.4.2.3","sha512");I("2.16.840.1.101.3.4.2.4","sha224");I("2.16.840.1.101.3.4.2.5","sha512-224");I("2.16.840.1.101.3.4.2.6","sha512-256");I("1.2.840.113549.2.2","md2");I("1.2.840.113549.2.5","md5");I("1.2.840.113549.1.7.1","data");I("1.2.840.113549.1.7.2","signedData");I("1.2.840.113549.1.7.3","envelopedData");I("1.2.840.113549.1.7.4","signedAndEnvelopedData");I("1.2.840.113549.1.7.5","digestedData");I("1.2.840.113549.1.7.6","encryptedData");I("1.2.840.113549.1.9.1","emailAddress");I("1.2.840.113549.1.9.2","unstructuredName");I("1.2.840.113549.1.9.3","contentType");I("1.2.840.113549.1.9.4","messageDigest");I("1.2.840.113549.1.9.5","signingTime");I("1.2.840.113549.1.9.6","counterSignature");I("1.2.840.113549.1.9.7","challengePassword");I("1.2.840.113549.1.9.8","unstructuredAddress");I("1.2.840.113549.1.9.14","extensionRequest");I("1.2.840.113549.1.9.20","friendlyName");I("1.2.840.113549.1.9.21","localKeyId");I("1.2.840.113549.1.9.22.1","x509Certificate");I("1.2.840.113549.1.12.10.1.1","keyBag");I("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");I("1.2.840.113549.1.12.10.1.3","certBag");I("1.2.840.113549.1.12.10.1.4","crlBag");I("1.2.840.113549.1.12.10.1.5","secretBag");I("1.2.840.113549.1.12.10.1.6","safeContentsBag");I("1.2.840.113549.1.5.13","pkcs5PBES2");I("1.2.840.113549.1.5.12","pkcs5PBKDF2");I("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");I("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");I("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");I("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");I("1.2.840.113549.2.7","hmacWithSHA1");I("1.2.840.113549.2.8","hmacWithSHA224");I("1.2.840.113549.2.9","hmacWithSHA256");I("1.2.840.113549.2.10","hmacWithSHA384");I("1.2.840.113549.2.11","hmacWithSHA512");I("1.2.840.113549.3.7","des-EDE3-CBC");I("2.16.840.1.101.3.4.1.2","aes128-CBC");I("2.16.840.1.101.3.4.1.22","aes192-CBC");I("2.16.840.1.101.3.4.1.42","aes256-CBC");I("2.5.4.3","commonName");I("2.5.4.4","surname");I("2.5.4.5","serialNumber");I("2.5.4.6","countryName");I("2.5.4.7","localityName");I("2.5.4.8","stateOrProvinceName");I("2.5.4.9","streetAddress");I("2.5.4.10","organizationName");I("2.5.4.11","organizationalUnitName");I("2.5.4.12","title");I("2.5.4.13","description");I("2.5.4.15","businessCategory");I("2.5.4.17","postalCode");I("2.5.4.42","givenName");I("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");I("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");I("2.16.840.1.113730.1.1","nsCertType");I("2.16.840.1.113730.1.13","nsComment");ot("2.5.29.1","authorityKeyIdentifier");ot("2.5.29.2","keyAttributes");ot("2.5.29.3","certificatePolicies");ot("2.5.29.4","keyUsageRestriction");ot("2.5.29.5","policyMapping");ot("2.5.29.6","subtreesConstraint");ot("2.5.29.7","subjectAltName");ot("2.5.29.8","issuerAltName");ot("2.5.29.9","subjectDirectoryAttributes");ot("2.5.29.10","basicConstraints");ot("2.5.29.11","nameConstraints");ot("2.5.29.12","policyConstraints");ot("2.5.29.13","basicConstraints");I("2.5.29.14","subjectKeyIdentifier");I("2.5.29.15","keyUsage");ot("2.5.29.16","privateKeyUsagePeriod");I("2.5.29.17","subjectAltName");I("2.5.29.18","issuerAltName");I("2.5.29.19","basicConstraints");ot("2.5.29.20","cRLNumber");ot("2.5.29.21","cRLReason");ot("2.5.29.22","expirationDate");ot("2.5.29.23","instructionCode");ot("2.5.29.24","invalidityDate");ot("2.5.29.25","cRLDistributionPoints");ot("2.5.29.26","issuingDistributionPoint");ot("2.5.29.27","deltaCRLIndicator");ot("2.5.29.28","issuingDistributionPoint");ot("2.5.29.29","certificateIssuer");ot("2.5.29.30","nameConstraints");I("2.5.29.31","cRLDistributionPoints");I("2.5.29.32","certificatePolicies");ot("2.5.29.33","policyMappings");ot("2.5.29.34","policyConstraints");I("2.5.29.35","authorityKeyIdentifier");ot("2.5.29.36","policyConstraints");I("2.5.29.37","extKeyUsage");ot("2.5.29.46","freshestCRL");ot("2.5.29.54","inhibitAnyPolicy");I("1.3.6.1.4.1.11129.2.4.2","timestampList");I("1.3.6.1.5.5.7.1.1","authorityInfoAccess");I("1.3.6.1.5.5.7.3.1","serverAuth");I("1.3.6.1.5.5.7.3.2","clientAuth");I("1.3.6.1.5.5.7.3.3","codeSigning");I("1.3.6.1.5.5.7.3.4","emailProtection");I("1.3.6.1.5.5.7.3.8","timeStamping")});var qr=Q((ty,Wa)=>{var lt=ft();Bt();dn();var P=Wa.exports=lt.asn1=lt.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(lt.util.isArray(n)){for(var o=[],s=0;s<n.length;++s)n[s]!==void 0&&o.push(n[s]);n=o}var a={tagClass:t,type:e,constructed:r,composed:r||lt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=P.copy(a)),a};P.copy=function(t,e){var r;if(lt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(lt.util.isArray(t)){if(!lt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Mr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var Bu=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;Mr(t,e,o),n=t.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=lt.util.createBuffer(t));var r=t.length(),n=pn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function pn(t,e,r,n){var i;Mr(t,e,2);var o=t.getByte();e--;var s=o&192,a=o&31;i=t.length();var f=Bu(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,l=(o&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Mr(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(pn(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(pn(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&f>1){var x=t.read,d=e,p=0;if(a===P.Type.BITSTRING&&(Mr(t,e,1),p=t.getByte(),e--),p===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},m=pn(t,e,r+1,y),E=i-t.length();e-=E,a==P.Type.BITSTRING&&E++;var b=m.tagClass;E===f&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=x,e=d)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(a===P.Type.BMPSTRING)for(u="";f>0;f-=2)Mr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var R=h===void 0?null:{bitStringContents:h};return P.create(s,a,l,u,R)}P.toDer=function(t){var e=lt.util.createBuffer(),r=t.tagClass|t.type,n=lt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var o=0;o<t.value.length;++o)t.value[o]!==void 0&&n.putBuffer(P.toDer(t.value[o]))}else if(t.type===P.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)n.putInt16(t.value.charCodeAt(o));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),a="";do a+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)e.putByte(a.charCodeAt(o))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=lt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,o,s,a=2;a<e.length;++a){n=!0,i=[],o=parseInt(e[a],10);do s=o&127,o=o>>>7,n||(s|=128),i.push(s),n=!1;while(o>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=lt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(a=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var x=parseInt(t.substr(h+1,2),10),d=parseInt(t.substr(h+4,2),10);c=x*60+d,c*=6e4,l==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(o,s,a,f)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=lt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=lt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&lt.util.isArray(e.value))for(var o=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[o]&&(i=P.validate(t.value[o],e.value[s],r,n),i?++o:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Ga=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",o=0;o<e*r;++o)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,a="",o=0;o<t.value.length;++o)t.value[o]!==void 0&&(s+=1,a+=P.prettyPrint(t.value[o],e+1,r),o+1<t.value.length&&(a+=","));n+=i+"Sub values: "+s+a}else{if(n+=i+"Value: ",t.type===P.Type.OID){var f=P.derToOid(t.value);n+=f,lt.pki&&lt.pki.oids&&f in lt.pki.oids&&(n+=" ("+lt.pki.oids[f]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+lt.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+lt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)Ga.test(t.value)||(n+="("+t.value+") "),n+="0x"+lt.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=lt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+lt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:Ga.test(t.value)?n+="0x"+lt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var $a=Q((ey,Za)=>{var yt=ft();si();ci();Bt();Za.exports=yt.des=yt.des||{};yt.des.startEncrypting=function(t,e,r,n){var i=yn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};yt.des.createEncryptionCipher=function(t,e){return yn({key:t,output:null,decrypt:!1,mode:e})};yt.des.startDecrypting=function(t,e,r,n){var i=yn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};yt.des.createDecryptionCipher=function(t,e){return yn({key:t,output:null,decrypt:!0,mode:e})};yt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Ya(r._keys,n,i,!1)},decrypt:function(n,i){return Ya(r._keys,n,i,!0)}}}),r._init=!1};yt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=yt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Du(e),this._init=!0}};fe("DES-ECB",yt.cipher.modes.ecb);fe("DES-CBC",yt.cipher.modes.cbc);fe("DES-CFB",yt.cipher.modes.cfb);fe("DES-OFB",yt.cipher.modes.ofb);fe("DES-CTR",yt.cipher.modes.ctr);fe("3DES-ECB",yt.cipher.modes.ecb);fe("3DES-CBC",yt.cipher.modes.cbc);fe("3DES-CFB",yt.cipher.modes.cfb);fe("3DES-OFB",yt.cipher.modes.ofb);fe("3DES-CTR",yt.cipher.modes.ctr);function fe(t,e){var r=function(){return new yt.des.Algorithm(t,e)};yt.cipher.registerAlgorithm(t,r)}var Su=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Au=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Cu=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Tu=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Iu=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],_u=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Ru=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Lu=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Du(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],x=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,R=0;R<p;R++){var w=t.getInt32(),B=t.getInt32();b=(w>>>4^B)&252645135,B^=b,w^=b<<4,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>2^B)&858993459,B^=b,w^=b<<2,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=(B>>>8^w)&16711935,w^=b,B^=b<<8,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=w<<8|B>>>20&240,w=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=b;for(var L=0;L<m.length;++L){m[L]?(w=w<<2|w>>>26,B=B<<2|B>>>26):(w=w<<1|w>>>27,B=B<<1|B>>>27),w&=-15,B&=-15;var D=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|o[w>>>12&15]|s[w>>>8&15]|a[w>>>4&15],G=f[B>>>28]|c[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|l[B>>>12&15]|x[B>>>8&15]|d[B>>>4&15];b=(G>>>16^D)&65535,y[E++]=D^b,y[E++]=G^b<<16}}return y}function Ya(t,e,r,n){var i=t.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,a=e[0],f=e[1];s=(a>>>4^f)&252645135,f^=s,a^=s<<4,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,a=a<<1|a>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=o[c+1],h=o[c+2],l=o[c];l!=u;l+=h){var x=f^t[l],d=(f>>>4|f<<28)^t[l+1];s=a,a=f,f=s^(Au[x>>>24&63]|Tu[x>>>16&63]|_u[x>>>8&63]|Lu[x&63]|Su[d>>>24&63]|Cu[d>>>16&63]|Iu[d>>>8&63]|Ru[d&63])}s=a,a=f,f=s}a=a>>>1|a<<31,f=f>>>1|f<<31,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(a>>>4^f)&252645135,f^=s,a^=s<<4,r[0]=a,r[1]=f}function yn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=yt.cipher.createDecipher(r,t.key):n=yt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof yt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var Ze=Q((ry,Qa)=>{var xn=ft();Qa.exports=xn.md=xn.md||{};xn.md.algorithms=xn.md.algorithms||{}});var Ja=Q((ny,Xa)=>{var we=ft();Ze();Bt();var Nu=Xa.exports=we.hmac=we.hmac||{};Nu.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(o,s){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in we.md.algorithms)e=we.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else e=o;if(s===null)s=t;else{if(typeof s=="string")s=we.util.createBuffer(s);else if(we.util.isArray(s)){var a=s;s=we.util.createBuffer();for(var f=0;f<a.length;++f)s.putByte(a[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=we.util.createBuffer(),n=we.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var a=s.at(f);r.putByte(54^a),n.putByte(92^a)}if(c<e.blockLength)for(var a=e.blockLength-c,f=0;f<a;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(o){e.update(o)},i.getMac=function(){var o=e.digest().bytes();return e.start(),e.update(n),e.update(o),e.digest()},i.digest=i.getMac,i}});var gn=Q(()=>{});var Mi=Q((ay,ja)=>{var Mt=ft();Ja();Ze();Bt();var ku=Mt.pkcs5=Mt.pkcs5||{},Be;Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&(Be=gn());ja.exports=Mt.pbkdf2=ku.pbkdf2=function(t,e,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&Be.pbkdf2&&(i===null||typeof i!="object")&&(Be.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?Be.pbkdf2Sync.length===4?Be.pbkdf2(t,e,r,n,function(b,R){if(b)return o(b);o(null,R.toString("binary"))}):Be.pbkdf2(t,e,r,n,i,function(b,R){if(b)return o(b);o(null,R.toString("binary"))}):Be.pbkdf2Sync.length===4?Be.pbkdf2Sync(t,e,r,n).toString("binary"):Be.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Mt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Mt.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var a=new Error("Derived key is too long.");if(o)return o(a);throw a}var f=Math.ceil(n/s),c=n-(f-1)*s,u=Mt.hmac.create();u.start(i,t);var h="",l,x,d;if(!o){for(var p=1;p<=f;++p){u.start(null,null),u.update(e),u.update(Mt.util.int32ToBytes(p)),l=d=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(d),x=u.digest().getBytes(),l=Mt.util.xorBytes(l,x,s),d=x;h+=p<f?l:l.substr(0,c)}return h}var p=1,y;function m(){if(p>f)return o(null,h);u.start(null,null),u.update(e),u.update(Mt.util.int32ToBytes(p)),l=d=u.digest().getBytes(),y=2,E()}function E(){if(y<=r)return u.start(null,null),u.update(d),x=u.digest().getBytes(),l=Mt.util.xorBytes(l,x,s),d=x,++y,Mt.util.setImmediate(E);h+=p<f?l:l.substr(0,c),++p,m()}m()}});var rs=Q((sy,es)=>{var vn=ft();Bt();var ts=es.exports=vn.pem=vn.pem||{};ts.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=mn(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=mn(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=mn(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=mn(t.headers[i]);return t.procType&&(r+=`\r
`),r+=vn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};ts.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(t),!!o;){var s=o[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var a={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:vn.util.decode64(o[3])};if(e.push(a),!!o[2]){for(var f=o[2].split(i),c=0;o&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(o=u.match(n),o){for(var x={name:o[1],values:[]},d=o[2].split(","),p=0;p<d.length;++p)x.values.push(Pu(d[p]));if(a.procType)if(!a.contentDomain&&x.name==="Content-Domain")a.contentDomain=d[0]||"";else if(!a.dekInfo&&x.name==="DEK-Info"){if(x.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:d[0],parameters:d[1]||null}}else a.headers.push(x);else{if(x.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(x.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:d[0],type:d[1]}}}++c}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function mn(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var o=0,s=-1,i=0;i<e.length;++i,++o)if(o>65&&s!==-1){var a=e[s];a===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+a+e.substr(s+1),o=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Pu(t){return t.replace(/^\s+/,"")}});var fs=Q((fy,ss)=>{var ce=ft();Ze();Bt();var is=ss.exports=ce.sha256=ce.sha256||{};ce.md.sha256=ce.md.algorithms.sha256=is;is.create=function(){os||Uu();var t=null,e=ce.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=ce.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=ce.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),ns(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ce.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(qi.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};ns(h,r,i);var l=ce.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var qi=null,os=!1,as=null;function Uu(){qi=String.fromCharCode(128),qi+=ce.util.fillString(String.fromCharCode(0),64),as=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],os=!0}function ns(t,e,r){for(var n,i,o,s,a,f,c,u,h,l,x,d,p,y,m,E=r.length();E>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,l=t.h2,x=t.h3,d=t.h4,p=t.h5,y=t.h6,m=t.h7,c=0;c<64;++c)s=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),a=y^d&(p^y),o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=m+s+a+as[c]+e[c],i=o+f,m=y,y=p,p=d,d=x+n>>>0,x=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+x|0,t.h4=t.h4+d|0,t.h5=t.h5+p|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,E-=64}}});var us=Q((cy,cs)=>{var ue=ft();Bt();var bn=null;ue.util.isNodejs&&!ue.options.usePureJavaScript&&!process.versions["node-webkit"]&&(bn=gn());var Ku=cs.exports=ue.prng=ue.prng||{};Ku.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,l=e.plugin.increment,x=e.plugin.formatKey,d=e.plugin.formatSeed,p=ue.util.createBuffer();e.key=null,y();function y(m){if(m)return u(m);if(p.length()>=c)return u(null,p.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return ue.util.nextTick(function(){o(y)});var E=h(e.key,e.seed);e.generated+=E.length,p.putBytes(E),e.key=x(h(e.key,l(e.seed))),e.seed=d(h(e.key,e.seed)),ue.util.setImmediate(y)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,x=e.plugin.formatSeed;e.key=null;for(var d=ue.util.createBuffer();d.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var p=u(e.key,e.seed);e.generated+=p.length,d.putBytes(p),e.key=l(u(e.key,h(e.seed))),e.seed=x(u(e.key,e.seed))}return d.getBytes(c)};function o(c){if(e.pools[0].messageLength>=32)return a(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return c(h);e.collect(l),a(),c()})}function s(){if(e.pools[0].messageLength>=32)return a();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var l=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(c){var u=null,h=ue.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(w){return l.getRandomValues(w)});var x=ue.util.createBuffer();if(u)for(;x.length()<c;){var d=Math.max(1,Math.min(c-x.length(),65536)/4),p=new Uint32Array(Math.floor(d));try{u(p);for(var y=0;y<p.length;++y)x.putInt32(p[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(x.length()<c)for(var m,E,b,R=Math.floor(Math.random()*65536);x.length()<c;){E=16807*(R&65535),m=16807*(R>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),R=E&4294967295;for(var y=0;y<3;++y)b=R>>>(y<<3),b^=Math.floor(Math.random()*256),x.putByte(b&255)}return x.getBytes(c)}return bn?(e.seedFile=function(c,u){bn.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(c){return bn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,l){function x(d){var p=d.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",x),l(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",x),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(x,d){c.postMessage({forge:{prng:{err:x,bytes:d}}})})};c.addEventListener("message",u)}},e}});var Vr=Q((uy,Vi)=>{var Dt=ft();sn();fs();us();Bt();(function(){if(Dt.random&&Dt.random.getBytes){Vi.exports=Dt.random;return}(function(t){var e={},r=new Array(4),n=Dt.util.createBuffer();e.formatKey=function(h){var l=Dt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Dt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Dt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Dt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Dt.md.sha256;function i(){var h=Dt.prng.create(e);return h.getBytes=function(l,x){return h.generate(l,x)},h.getBytesSync=function(l){return h.generate(l)},h}var o=i(),s=null,a=Dt.util.globalScope,f=a.crypto||a.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),Dt.options.usePureJavaScript||!Dt.util.isNodejs&&!s){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}o.collect(c),c=null}t&&(t().mousemove(function(h){o.collectInt(h.clientX,16),o.collectInt(h.clientY,16)}),t().keypress(function(h){o.collectInt(h.charCode,8)}))}if(!Dt.random)Dt.random=o;else for(var u in o)Dt.random[u]=o[u];Dt.random.createInstance=i,Vi.exports=Dt.random})(typeof jQuery<"u"?jQuery:null)})()});var ps=Q((hy,ds)=>{var qt=ft();Bt();var Fi=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],hs=[1,2,3,5],Ou=function(t,e){return t<<e&65535|(t&65535)>>16-e},Mu=function(t,e){return(t&65535)>>e|t<<16-e&65535};ds.exports=qt.rc2=qt.rc2||{};qt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=qt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,o=Math.ceil(i/8),s=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Fi[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-o,Fi[r.at(128-o)&s]),a=127-o;a>=0;a--)r.setAt(a,Fi[r.at(a+1)^r.at(a+o)]);return r};var ls=function(t,e,r){var n=!1,i=null,o=null,s=null,a,f,c,u,h=[];for(t=qt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(a=function(d){for(c=0;c<4;c++)d[c]+=h[u]+(d[(c+3)%4]&d[(c+2)%4])+(~d[(c+3)%4]&d[(c+1)%4]),d[c]=Ou(d[c],hs[c]),u++},f=function(d){for(c=0;c<4;c++)d[c]+=h[d[(c+3)%4]&63]}):(a=function(d){for(c=3;c>=0;c--)d[c]=Mu(d[c],hs[c]),d[c]-=h[u]+(d[(c+3)%4]&d[(c+2)%4])+(~d[(c+3)%4]&d[(c+1)%4]),u--},f=function(d){for(c=3;c>=0;c--)d[c]-=h[d[(c+3)%4]&63]});var l=function(d){var p=[];for(c=0;c<4;c++){var y=i.getInt16Le();s!==null&&(r?y^=s.getInt16Le():s.putInt16Le(y)),p.push(y&65535)}u=r?0:63;for(var m=0;m<d.length;m++)for(var E=0;E<d[m][0];E++)d[m][1](p);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(p[c]):p[c]^=s.getInt16Le()),o.putInt16Le(p[c])},x=null;return x={start:function(d,p){d&&typeof d=="string"&&(d=qt.util.createBuffer(d)),n=!1,i=qt.util.createBuffer(),o=p||new qt.util.createBuffer,s=d,x.output=o},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)l([[5,a],[1,f],[6,a],[1,f],[5,a]])},finish:function(d){var p=!0;if(r)if(d)p=d(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(p&&(n=!0,x.update()),!r&&(p=i.length()===0,p))if(d)p=d(8,o,!r);else{var m=o.length(),E=o.at(m-1);E>m?p=!1:o.truncate(E)}return p}},x};qt.rc2.startEncrypting=function(t,e,r){var n=qt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};qt.rc2.createEncryptionCipher=function(t,e){return ls(t,e,!0)};qt.rc2.startDecrypting=function(t,e,r){var n=qt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};qt.rc2.createDecryptionCipher=function(t,e){return ls(t,e,!1)}});var Bn=Q((ly,ws)=>{var Hi=ft();ws.exports=Hi.jsbn=Hi.jsbn||{};var Se,qu=0xdeadbeefcafe,ys=(qu&16777215)==15715070;function C(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Hi.jsbn.BigInteger=C;function rt(){return new C(null)}function Vu(t,e,r,n,i,o){for(;--o>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Fu(t,e,r,n,i,o){for(var s=e&32767,a=e>>15;--o>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=a*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+a*c+(i>>>30),r.data[n++]=f&1073741823}return i}function xs(t,e,r,n,i,o){for(var s=e&16383,a=e>>14;--o>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=a*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+a*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(C.prototype.am=xs,Se=28):ys&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=Fu,Se=30):ys&&navigator.appName!="Netscape"?(C.prototype.am=Vu,Se=26):(C.prototype.am=xs,Se=28);C.prototype.DB=Se;C.prototype.DM=(1<<Se)-1;C.prototype.DV=1<<Se;var zi=52;C.prototype.FV=Math.pow(2,zi);C.prototype.F1=zi-Se;C.prototype.F2=2*Se-zi;var Hu="0123456789abcdefghijklmnopqrstuvwxyz",En=new Array,xr,Gt;xr="0".charCodeAt(0);for(Gt=0;Gt<=9;++Gt)En[xr++]=Gt;xr="a".charCodeAt(0);for(Gt=10;Gt<36;++Gt)En[xr++]=Gt;xr="A".charCodeAt(0);for(Gt=10;Gt<36;++Gt)En[xr++]=Gt;function gs(t){return Hu.charAt(t)}function ms(t,e){var r=En[t.charCodeAt(e)];return r??-1}function zu(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Gu(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Pe(t){var e=rt();return e.fromInt(t),e}function Wu(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=r==8?t[n]&255:ms(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&t[0]&128&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&C.ZERO.subTo(this,this)}function Yu(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Zu(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=gs(n));s>=0;)a<e?(n=(this.data[s]&(1<<a)-1)<<e-a,n|=this.data[--s]>>(a+=this.DB-e)):(n=this.data[s]>>(a-=e)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=gs(n));return i?o:"0"}function $u(){var t=rt();return C.ZERO.subTo(this,t),t}function Qu(){return this.s<0?this.negate():this}function Xu(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function wn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Ju(){return this.t<=0?0:this.DB*(this.t-1)+wn(this.data[this.t-1]^this.s&this.DM)}function ju(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function th(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function eh(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(t/this.DB),s=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+o+1]=this.data[a]>>n|s,s=(this.data[a]&i)<<r;for(a=o-1;a>=0;--a)e.data[a]=0;e.data[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function rh(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&o)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function nh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function ih(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&C.ZERO.subTo(e,e)}function oh(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function ah(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=rt());var o=rt(),s=this.s,a=t.s,f=this.DB-wn(n.data[n.t-1]);f>0?(n.lShiftTo(f,o),i.lShiftTo(f,r)):(n.copyTo(o),i.copyTo(r));var c=o.t,u=o.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?o.data[c-2]>>this.F2:0),l=this.FV/h,x=(1<<this.F1)/h,d=1<<this.F2,p=r.t,y=p-c,m=e??rt();for(o.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),C.ONE.dlShiftTo(c,m),m.subTo(o,o);o.t<c;)o.data[o.t++]=0;for(;--y>=0;){var E=r.data[--p]==u?this.DM:Math.floor(r.data[p]*l+(r.data[p-1]+d)*x);if((r.data[p]+=o.am(0,E,r,y,0,c))<E)for(o.dlShiftTo(y,m),r.subTo(m,r);r.data[p]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=a&&C.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&C.ZERO.subTo(r,r)}}}function sh(t){var e=rt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(C.ZERO)>0&&t.subTo(e,e),e}function $e(t){this.m=t}function fh(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function ch(t){return t}function uh(t){t.divRemTo(this.m,null,t)}function hh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function lh(t,e){t.squareTo(e),this.reduce(e)}$e.prototype.convert=fh;$e.prototype.revert=ch;$e.prototype.reduce=uh;$e.prototype.mulTo=hh;$e.prototype.sqrTo=lh;function dh(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Qe(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function ph(t){var e=rt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(C.ZERO)>0&&this.m.subTo(e,e),e}function yh(t){var e=rt();return t.copyTo(e),this.reduce(e),e}function xh(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function gh(t,e){t.squareTo(e),this.reduce(e)}function mh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Qe.prototype.convert=ph;Qe.prototype.revert=yh;Qe.prototype.reduce=xh;Qe.prototype.mulTo=mh;Qe.prototype.sqrTo=gh;function vh(){return(this.t>0?this.data[0]&1:this.s)==0}function bh(t,e){if(t>4294967295||t<1)return C.ONE;var r=rt(),n=rt(),i=e.convert(this),o=wn(t)-1;for(i.copyTo(r);--o>=0;)if(e.sqrTo(r,n),(t&1<<o)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Eh(t,e){var r;return t<256||e.isEven()?r=new $e(e):r=new Qe(e),this.exp(t,r)}C.prototype.copyTo=zu;C.prototype.fromInt=Gu;C.prototype.fromString=Wu;C.prototype.clamp=Yu;C.prototype.dlShiftTo=ju;C.prototype.drShiftTo=th;C.prototype.lShiftTo=eh;C.prototype.rShiftTo=rh;C.prototype.subTo=nh;C.prototype.multiplyTo=ih;C.prototype.squareTo=oh;C.prototype.divRemTo=ah;C.prototype.invDigit=dh;C.prototype.isEven=vh;C.prototype.exp=bh;C.prototype.toString=Zu;C.prototype.negate=$u;C.prototype.abs=Qu;C.prototype.compareTo=Xu;C.prototype.bitLength=Ju;C.prototype.mod=sh;C.prototype.modPowInt=Eh;C.ZERO=Pe(0);C.ONE=Pe(1);function wh(){var t=rt();return this.copyTo(t),t}function Bh(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Sh(){return this.t==0?this.s:this.data[0]<<24>>24}function Ah(){return this.t==0?this.s:this.data[0]<<16>>16}function Ch(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Th(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Ih(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Pe(r),i=rt(),o=rt(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function _h(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,o=0,s=0,a=0;a<t.length;++a){var f=ms(t,a);if(f<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),i&&C.ZERO.subTo(this,this)}function Rh(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(C.ONE.shiftLeft(t-1),Gi,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(C.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Lh(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Dh(t){return this.compareTo(t)==0}function Nh(t){return this.compareTo(t)<0?this:t}function kh(t){return this.compareTo(t)>0?this:t}function Ph(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Uh(t,e){return t&e}function Kh(t){var e=rt();return this.bitwiseTo(t,Uh,e),e}function Gi(t,e){return t|e}function Oh(t){var e=rt();return this.bitwiseTo(t,Gi,e),e}function vs(t,e){return t^e}function Mh(t){var e=rt();return this.bitwiseTo(t,vs,e),e}function bs(t,e){return t&~e}function qh(t){var e=rt();return this.bitwiseTo(t,bs,e),e}function Vh(){for(var t=rt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Fh(t){var e=rt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Hh(t){var e=rt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function zh(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Gh(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+zh(this.data[t]);return this.s<0?this.t*this.DB:-1}function Wh(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Yh(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Wh(this.data[r]^e);return t}function Zh(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function $h(t,e){var r=C.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Qh(t){return this.changeBit(t,Gi)}function Xh(t){return this.changeBit(t,bs)}function Jh(t){return this.changeBit(t,vs)}function jh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function tl(t){var e=rt();return this.addTo(t,e),e}function el(t){var e=rt();return this.subTo(t,e),e}function rl(t){var e=rt();return this.multiplyTo(t,e),e}function nl(t){var e=rt();return this.divRemTo(t,e,null),e}function il(t){var e=rt();return this.divRemTo(t,null,e),e}function ol(t){var e=rt(),r=rt();return this.divRemTo(t,e,r),new Array(e,r)}function al(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function sl(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Fr(){}function Es(t){return t}function fl(t,e,r){t.multiplyTo(e,r)}function cl(t,e){t.squareTo(e)}Fr.prototype.convert=Es;Fr.prototype.revert=Es;Fr.prototype.mulTo=fl;Fr.prototype.sqrTo=cl;function ul(t){return this.exp(t,new Fr)}function hl(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function ll(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function gr(t){this.r2=rt(),this.q3=rt(),C.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function dl(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=rt();return t.copyTo(e),this.reduce(e),e}function pl(t){return t}function yl(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function xl(t,e){t.squareTo(e),this.reduce(e)}function gl(t,e,r){t.multiplyTo(e,r),this.reduce(r)}gr.prototype.convert=dl;gr.prototype.revert=pl;gr.prototype.reduce=yl;gr.prototype.mulTo=gl;gr.prototype.sqrTo=xl;function ml(t,e){var r=t.bitLength(),n,i=Pe(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new $e(e):e.isEven()?o=new gr(e):o=new Qe(e);var s=new Array,a=3,f=n-1,c=(1<<n)-1;if(s[1]=o.convert(this),n>1){var u=rt();for(o.sqrTo(s[1],u);a<=c;)s[a]=rt(),o.mulTo(u,s[a-2],s[a]),a+=2}var h=t.t-1,l,x=!0,d=rt(),p;for(r=wn(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&c:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),x)s[l].copyTo(i),x=!1;else{for(;a>1;)o.sqrTo(i,d),o.sqrTo(d,i),a-=2;a>0?o.sqrTo(i,d):(p=i,i=d,d=p),o.mulTo(d,s[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)o.sqrTo(i,d),p=i,i=d,d=p,--r<0&&(r=this.DB-1,--h)}return o.revert(i)}function vl(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function bl(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function El(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return C.ZERO;for(var r=t.clone(),n=this.clone(),i=Pe(1),o=Pe(0),s=Pe(0),a=Pe(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),e&&s.subTo(i,s),a.subTo(o,a))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var Xt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],wl=(1<<26)/Xt[Xt.length-1];function Bl(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Xt[Xt.length-1]){for(e=0;e<Xt.length;++e)if(r.data[0]==Xt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Xt.length;){for(var n=Xt[e],i=e+1;i<Xt.length&&n<wl;)n*=Xt[i++];for(n=r.modInt(n);e<i;)if(n%Xt[e++]==0)return!1}return r.millerRabin(t)}function Sl(t){var e=this.subtract(C.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Al(),o,s=0;s<t;++s){do o=new C(this.bitLength(),i);while(o.compareTo(C.ONE)<=0||o.compareTo(e)>=0);var a=o.modPow(n,this);if(a.compareTo(C.ONE)!=0&&a.compareTo(e)!=0){for(var f=1;f++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(C.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function Al(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=Ch;C.prototype.toRadix=Ih;C.prototype.fromRadix=_h;C.prototype.fromNumber=Rh;C.prototype.bitwiseTo=Ph;C.prototype.changeBit=$h;C.prototype.addTo=jh;C.prototype.dMultiply=al;C.prototype.dAddOffset=sl;C.prototype.multiplyLowerTo=hl;C.prototype.multiplyUpperTo=ll;C.prototype.modInt=bl;C.prototype.millerRabin=Sl;C.prototype.clone=wh;C.prototype.intValue=Bh;C.prototype.byteValue=Sh;C.prototype.shortValue=Ah;C.prototype.signum=Th;C.prototype.toByteArray=Lh;C.prototype.equals=Dh;C.prototype.min=Nh;C.prototype.max=kh;C.prototype.and=Kh;C.prototype.or=Oh;C.prototype.xor=Mh;C.prototype.andNot=qh;C.prototype.not=Vh;C.prototype.shiftLeft=Fh;C.prototype.shiftRight=Hh;C.prototype.getLowestSetBit=Gh;C.prototype.bitCount=Yh;C.prototype.testBit=Zh;C.prototype.setBit=Qh;C.prototype.clearBit=Xh;C.prototype.flipBit=Jh;C.prototype.add=tl;C.prototype.subtract=el;C.prototype.multiply=rl;C.prototype.divide=nl;C.prototype.remainder=il;C.prototype.divideAndRemainder=ol;C.prototype.modPow=ml;C.prototype.modInverse=El;C.prototype.pow=ul;C.prototype.gcd=vl;C.prototype.isProbablePrime=Bl});var Ts=Q((dy,Cs)=>{var he=ft();Ze();Bt();var Ss=Cs.exports=he.sha1=he.sha1||{};he.md.sha1=he.md.algorithms.sha1=Ss;Ss.create=function(){As||Cl();var t=null,e=he.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=he.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=he.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Bs(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=he.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Wi.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Bs(h,r,i);var l=he.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Wi=null,As=!1;function Cl(){Wi=String.fromCharCode(128),Wi+=he.util.fillString(String.fromCharCode(0),64),As=!0}function Bs(t,e,r){for(var n,i,o,s,a,f,c,u,h=r.length();h>=64;){for(i=t.h0,o=t.h1,s=t.h2,a=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o&s|a&(o^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+3395469782+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+s|0,t.h3=t.h3+a|0,t.h4=t.h4+f|0,h-=64}}});var Rs=Q((py,_s)=>{var le=ft();Bt();Vr();Ts();var Is=_s.exports=le.pkcs1=le.pkcs1||{};Is.encode_rsa_oaep=function(t,e,r){var n,i,o,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),o?o.start():o=le.md.sha1.create(),s||(s=o);var a=Math.ceil(t.n.bitLength()/8),f=a-2*o.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),o.update(n,"raw");for(var u=o.digest(),h="",l=f-e.length,x=0;x<l;x++)h+="\0";var d=u.getBytes()+h+""+e;if(!i)i=le.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=o.digestLength,c}var p=Sn(i,a-o.digestLength-1,s),y=le.util.xorBytes(d,p,d.length),m=Sn(y,o.digestLength,s),E=le.util.xorBytes(i,m,i.length);return"\0"+E+y};Is.decode_rsa_oaep=function(t,e,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=s,y}if(i===void 0?i=le.md.sha1.create():i.start(),o||(o=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=Sn(u,i.digestLength,o),l=le.util.xorBytes(c,h,c.length),x=Sn(l,s-i.digestLength-1,o),d=le.util.xorBytes(u,x,u.length),p=d.substring(0,i.digestLength),y=f!=="\0",m=0;m<i.digestLength;++m)y|=a.charAt(m)!==p.charAt(m);for(var E=1,b=i.digestLength,R=i.digestLength;R<d.length;R++){var w=d.charCodeAt(R),B=w&1^1,L=E?65534:0;y|=w&L,E=E&B,b+=E}if(y||d.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(b+1)};function Sn(t,e,r){r||(r=le.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),o=0;o<i;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var Ls=Q((yy,Yi)=>{var Ue=ft();Bt();Bn();Vr();(function(){if(Ue.prime){Yi.exports=Ue.prime;return}var t=Yi.exports=Ue.prime=Ue.prime||{},e=Ue.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,x){typeof l=="function"&&(x=l,l={}),l=l||{};var d=l.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var p=l.prng||Ue.random,y={nextBytes:function(m){for(var E=p.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=E.charCodeAt(b)}};if(d.name==="PRIMEINC")return o(h,y,d.options,x);throw new Error("Invalid prime generation algorithm: "+d.name)};function o(h,l,x,d){return"workers"in x?f(h,l,x,d):s(h,l,x,d)}function s(h,l,x,d){var p=c(h,l),y=0,m=u(p.bitLength());"millerRabinTests"in x&&(m=x.millerRabinTests);var E=10;"maxBlockTime"in x&&(E=x.maxBlockTime),a(p,h,l,y,m,E,d)}function a(h,l,x,d,p,y,m){var E=+new Date;do{if(h.bitLength()>l&&(h=c(l,x)),h.isProbablePrime(p))return m(null,h);h.dAddOffset(r[d++%8],0)}while(y<0||+new Date-E<y);Ue.util.setImmediate(function(){a(h,l,x,d,p,y,m)})}function f(h,l,x,d){if(typeof Worker>"u")return s(h,l,x,d);var p=c(h,l),y=x.workers,m=x.workLoad||100,E=m*30/8,b=x.workerScript||"forge/prime.worker.js";if(y===-1)return Ue.util.estimateCores(function(w,B){w&&(B=2),y=B-1,R()});R();function R(){y=Math.max(1,y);for(var w=[],B=0;B<y;++B)w[B]=new Worker(b);for(var L=y,B=0;B<y;++B)w[B].addEventListener("message",G);var D=!1;function G(z){if(!D){--L;var V=z.data;if(V.found){for(var J=0;J<w.length;++J)w[J].terminate();return D=!0,d(null,new e(V.prime,16))}p.bitLength()>h&&(p=c(h,l));var ct=p.toString(16);z.target.postMessage({hex:ct,workLoad:m}),p.dAddOffset(E,0)}}}}function c(h,l){var x=new e(h,l),d=h-1;return x.testBit(d)||x.bitwiseTo(e.ONE.shiftLeft(d),i,x),x.dAddOffset(31-x.mod(n).byteValue(),0),x}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Cn=Q((xy,Os)=>{var q=ft();qr();Bn();dn();Rs();Ls();Vr();Bt();typeof et>"u"&&(et=q.jsbn.BigInteger);var et,Zi=q.util.isNodejs?gn():null,v=q.asn1,Wt=q.util;q.pki=q.pki||{};Os.exports=q.pki.rsa=q.rsa=q.rsa||{};var W=q.pki,Tl=[6,4,2,4,2,4,6,2],Il={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},_l={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Rl={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Ll=q.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Dl={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Nl=function(t){var e;if(t.algorithm in W.oids)e=W.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=v.oidToDer(e).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),o=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);o.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),o.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var s=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(o),i.value.push(s),v.toDer(i).getBytes()},Us=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(et.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(et.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new et(q.util.bytesToHex(q.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(et.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);var s=i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};W.rsa.encrypt=function(t,e,r){var n=r,i,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Ks(t,e,r)):(i=q.util.createBuffer(),i.putBytes(t));for(var s=new et(i.toHex(),16),a=Us(s,e,n),f=a.toString(16),c=q.util.createBuffer(),u=o-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(q.util.hexToBytes(f)),c.getBytes()};W.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=t.length,o.expected=i,o}var s=new et(q.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Us(s,e,r),f=a.toString(16),c=q.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(q.util.hexToBytes(f)),n!==!1?An(c.getBytes(),e,r):c.getBytes()};W.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||q.random,i={nextBytes:function(a){for(var f=n.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=f.charCodeAt(c)}},o=r.algorithm||"PRIMEINC",s;if(o==="PRIMEINC")s={algorithm:o,state:0,bits:t,rng:i,eInt:e||65537,e:new et(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+o);return s};W.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new et(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},o=+new Date,s,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new et(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(et.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Pl(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Tl[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(et.ONE),t.q1=t.q.subtract(et.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(et.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:W.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:W.rsa.setPublicKey(t.n,t.e)}}s=+new Date,a+=s-o,o=s}return t.keys!==null};W.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!q.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(Ds("generateKeyPair"))return Zi.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,f,c){if(a)return n(a);n(null,{privateKey:W.privateKeyFromPem(c),publicKey:W.publicKeyFromPem(f)})});if(Ns("generateKey")&&Ns("exportKey"))return Wt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ps(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Wt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var f=W.privateKeyFromAsn1(v.fromDer(q.util.createBuffer(a)));n(null,{privateKey:f,publicKey:W.setRsaPublicKey(f.n,f.e)})}});if(ks("generateKey")&&ks("exportKey")){var i=Wt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ps(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var f=a.target.result,c=Wt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=W.privateKeyFromAsn1(v.fromDer(q.util.createBuffer(h)));n(null,{privateKey:l,publicKey:W.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(Ds("generateKeyPairSync")){var o=Zi.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:W.privateKeyFromPem(o.privateKey),publicKey:W.publicKeyFromPem(o.publicKey)}}}var s=W.rsa.createKeyPairGenerationState(t,e,r);if(!n)return W.rsa.stepKeyPairGenerationState(s,0),s.keys;kl(s,r,n)};W.setRsaPublicKey=W.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,f,c){return Ks(a,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,f){return q.pkcs1.encode_rsa_oaep(f,a,o)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return W.rsa.encrypt(s,r,!0)},r.verify=function(n,i,o,s){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:function(f,c){c=An(c,r,!0);var u=v.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!v.validate(u,Dl,h,l)){var x=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw x.errors=l,x}var d=v.derToOid(h.algorithmIdentifier);if(!(d===q.oids.md2||d===q.oids.md5||d===q.oids.sha1||d===q.oids.sha224||d===q.oids.sha256||d===q.oids.sha384||d===q.oids.sha512||d===q.oids["sha512-224"]||d===q.oids["sha512-256"])){var x=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw x.oid=d,x}if((d===q.oids.md2||d===q.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:function(f,c){return c=An(c,r,!0),f===c}});var a=W.rsa.decrypt(i,r,!0,!1);return o.verify(n,a,r.n.bitLength())},r};W.setRsaPrivateKey=W.rsa.setPrivateKey=function(t,e,r,n,i,o,s,a){var f={n:t,e,d:r,p:n,q:i,dP:o,dQ:s,qInv:a};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=W.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:An};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(x,d){return q.pkcs1.decode_rsa_oaep(d,x,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(x){return x}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Nl},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return W.rsa.encrypt(l,f,h)},f};W.wrapRsaPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(W.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(t).getBytes())])};W.privateKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Il,e,r)&&(t=v.fromDer(q.util.createBuffer(e.privateKey))),e={},r=[],!v.validate(t,_l,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,s,a,f,c,u,h;return i=q.util.createBuffer(e.privateKeyModulus).toHex(),o=q.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=q.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=q.util.createBuffer(e.privateKeyPrime1).toHex(),f=q.util.createBuffer(e.privateKeyPrime2).toHex(),c=q.util.createBuffer(e.privateKeyExponent1).toHex(),u=q.util.createBuffer(e.privateKeyExponent2).toHex(),h=q.util.createBuffer(e.privateKeyCoefficient).toHex(),W.setRsaPrivateKey(new et(i,16),new et(o,16),new et(s,16),new et(a,16),new et(f,16),new et(c,16),new et(u,16),new et(h,16))};W.privateKeyToAsn1=W.privateKeyToRSAPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.qInv))])};W.publicKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Ll,e,r)){var n=v.derToOid(e.publicKeyOid);if(n!==W.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!v.validate(t,Rl,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=q.util.createBuffer(e.publicKeyModulus).toHex(),s=q.util.createBuffer(e.publicKeyExponent).toHex();return W.setRsaPublicKey(new et(o,16),new et(s,16))};W.publicKeyToAsn1=W.publicKeyToSubjectPublicKeyInfo=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(W.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[W.publicKeyToRSAPublicKey(t)])])};W.publicKeyToRSAPublicKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,de(t.e))])};function Ks(t,e,r){var n=q.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var s=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<s;++f)n.putByte(a)}else for(;s>0;){for(var c=0,u=q.random.getBytes(s),f=0;f<s;++f)a=u.charCodeAt(f),a===0?++c:n.putByte(a);s=c}return n.putByte(0),n.putBytes(t),n}function An(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),o=q.util.createBuffer(t),s=o.getByte(),a=o.getByte();if(s!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=i-3-n;for(var c=0;c<f;++c)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(f=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++f}else if(a===2)for(f=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++f}var u=o.getByte();if(u!==0||f!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function kl(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){o(t.pBits,function(a,f){if(a)return r(a);if(t.p=f,t.q!==null)return s(a,t.q);o(t.qBits,s)})}function o(a,f){q.prime.generateProbablePrime(a,n,f)}function s(a,f){if(a)return r(a);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)!==0){t.p=null,i();return}if(t.q.subtract(et.ONE).gcd(t.e).compareTo(et.ONE)!==0){t.q=null,o(t.qBits,s);return}if(t.p1=t.p.subtract(et.ONE),t.q1=t.q.subtract(et.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(et.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,o(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:W.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:W.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function de(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=q.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Pl(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function Ds(t){return q.util.isNodejs&&typeof Zi[t]=="function"}function Ns(t){return typeof Wt.globalScope<"u"&&typeof Wt.globalScope.crypto=="object"&&typeof Wt.globalScope.crypto.subtle=="object"&&typeof Wt.globalScope.crypto.subtle[t]=="function"}function ks(t){return typeof Wt.globalScope<"u"&&typeof Wt.globalScope.msCrypto=="object"&&typeof Wt.globalScope.msCrypto.subtle=="object"&&typeof Wt.globalScope.msCrypto.subtle[t]=="function"}function Ps(t){for(var e=q.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var zs=Q((gy,Hs)=>{var U=ft();sn();qr();$a();Ze();dn();Mi();rs();Vr();ps();Cn();Bt();typeof Ms>"u"&&(Ms=U.jsbn.BigInteger);var Ms,S=U.asn1,Y=U.pki=U.pki||{};Hs.exports=Y.pbe=U.pbe=U.pbe||{};var Xe=Y.oids,Ul={name:"EncryptedPrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Kl={name:"PBES2Algorithms",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Ol={name:"pkcs-12PbeParams",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"iterations"}]};Y.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=U.random.getBytesSync(r.saltSize),i=r.count,o=S.integerToDer(i),s,a,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":s=16,c=16,u=Xe["aes128-CBC"],h=U.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=Xe["aes192-CBC"],h=U.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=Xe["aes256-CBC"],h=U.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=Xe.desCBC,h=U.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var x="hmacWith"+r.prfAlgorithm.toUpperCase(),d=Fs(x),p=U.pkcs5.pbkdf2(e,n,i,s,d),y=U.random.getBytesSync(c),m=h(p);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes();var E=Ml(n,o,s,x);a=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Xe.pkcs5PBES2).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Xe.pkcs5PBKDF2).getBytes()),E]),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(u).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){s=24;var b=new U.util.ByteBuffer(n),p=Y.pbe.generatePkcs12Key(e,b,1,i,s),y=Y.pbe.generatePkcs12Key(e,b,2,i,s),m=U.des.createEncryptionCipher(p);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes(),a=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Xe["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,n),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,o.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var R=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[a,S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,f)]);return R};Y.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!S.validate(t,Ul,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=S.derToOid(n.encryptionOid),a=Y.pbe.getCipher(s,n.encryptionParams,e),f=U.util.createBuffer(n.encryptedData);return a.update(f),a.finish()&&(r=S.fromDer(a.output)),r};Y.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:S.toDer(t).getBytes()};return U.pem.encode(r,{maxline:e})};Y.encryptedPrivateKeyFromPem=function(t){var e=U.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return S.fromDer(e.body)};Y.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=Y.wrapRsaPrivateKey(Y.privateKeyToAsn1(t));return n=Y.encryptPrivateKeyInfo(n,e,r),Y.encryptedPrivateKeyToPem(n)}var i,o,s,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,o=U.random.getBytesSync(16),a=U.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,o=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,o=U.random.getBytesSync(8),a=U.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=U.pbe.opensslDeriveBytes(e,o.substr(0,8),s),u=a(c);u.start(o),u.update(S.toDer(Y.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:U.util.bytesToHex(o).toUpperCase()},body:u.output.getBytes()};return U.pem.encode(h)};Y.decryptRsaPrivateKey=function(t,e){var r=null,n=U.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,s;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,s=U.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,s=U.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,s=U.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,s=U.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,s=U.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,s=function(h){return U.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":o=8,s=function(h){return U.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":o=16,s=function(h){return U.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=U.util.hexToBytes(n.dekInfo.parameters),f=U.pbe.opensslDeriveBytes(e,a.substr(0,8),o),c=s(f);if(c.start(a),c.update(U.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=Y.decryptPrivateKeyInfo(S.fromDer(r),e):r=S.fromDer(r),r!==null&&(r=Y.privateKeyFromAsn1(r)),r};Y.pbe.generatePkcs12Key=function(t,e,r,n,i,o){var s,a;if(typeof o>"u"||o===null){if(!("sha1"in U.md))throw new Error('"sha1" hash algorithm unavailable.');o=U.md.sha1.create()}var f=o.digestLength,c=o.blockLength,u=new U.util.ByteBuffer,h=new U.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),x=e.length(),d=new U.util.ByteBuffer;d.fillWithByte(r,c);var p=c*Math.ceil(x/c),y=new U.util.ByteBuffer;for(a=0;a<p;a++)y.putByte(e.at(a%x));var m=c*Math.ceil(l/c),E=new U.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(h.at(a%l));var b=y;b.putBuffer(E);for(var R=Math.ceil(i/f),w=1;w<=R;w++){var B=new U.util.ByteBuffer;B.putBytes(d.bytes()),B.putBytes(b.bytes());for(var L=0;L<n;L++)o.start(),o.update(B.getBytes()),B=o.digest();var D=new U.util.ByteBuffer;for(a=0;a<c;a++)D.putByte(B.at(a%f));var G=Math.ceil(x/c)+Math.ceil(l/c),z=new U.util.ByteBuffer;for(s=0;s<G;s++){var V=new U.util.ByteBuffer(b.getBytes(c)),J=511;for(a=D.length()-1;a>=0;a--)J=J>>8,J+=D.at(a)+V.at(a),V.setAt(a,J&255);z.putBuffer(V)}b=z,u.putBuffer(B)}return u.truncate(u.length()-i),u};Y.pbe.getCipher=function(t,e,r){switch(t){case Y.oids.pkcs5PBES2:return Y.pbe.getCipherForPBES2(t,e,r);case Y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Y.oids["pbewithSHAAnd40BitRC2-CBC"]:return Y.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};Y.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!S.validate(e,Kl,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(t=S.derToOid(n.kdfOid),t!==Y.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=t,o.supportedOids=["pkcs5PBKDF2"],o}if(t=S.derToOid(n.encOid),t!==Y.oids["aes128-CBC"]&&t!==Y.oids["aes192-CBC"]&&t!==Y.oids["aes256-CBC"]&&t!==Y.oids["des-EDE3-CBC"]&&t!==Y.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=t,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var s=n.kdfSalt,a=U.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var f,c;switch(Y.oids[t]){case"aes128-CBC":f=16,c=U.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=U.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=U.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=U.des.createDecryptionCipher;break;case"desCBC":f=8,c=U.des.createDecryptionCipher;break}var u=Vs(n.prfOid),h=U.pkcs5.pbkdf2(r,s,a,f,u),l=n.encIv,x=c(h);return x.start(l),x};Y.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!S.validate(e,Ol,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=U.util.createBuffer(n.salt),a=U.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var f,c,u;switch(t){case Y.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=U.des.startDecrypting;break;case Y.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(p,y){var m=U.rc2.createDecryptionCipher(p,40);return m.start(y,null),m};break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=t,o}var h=Vs(n.prfOid),l=Y.pbe.generatePkcs12Key(r,s,1,a,f,h);h.start();var x=Y.pbe.generatePkcs12Key(r,s,2,a,c,h);return u(l,x)};Y.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in U.md))throw new Error('"md5" hash algorithm unavailable.');n=U.md.md5.create()}e===null&&(e="");for(var i=[qs(n,t+e)],o=16,s=1;o<r;++s,o+=16)i.push(qs(n,i[s-1]+t+e));return i.join("").substr(0,r)};function qs(t,e){return t.start().update(e).digest().getBytes()}function Vs(t){var e;if(!t)e="hmacWithSHA1";else if(e=Y.oids[S.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Fs(e)}function Fs(t){var e=U.md;switch(t){case"hmacWithSHA224":e=U.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Ml(t,e,r,n){var i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,U.util.hexToBytes(r.toString(16))),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Y.oids[n]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])),i}});var x0=Q((_2,y0)=>{"use strict";y0.exports=Yd;function Yd(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,f){r[n]=function(u){if(o)if(o=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{t.apply(e||null,r)}catch(c){o&&(o=!1,f(c))}})}});var b0=Q(v0=>{"use strict";var Fn=v0;Fn.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Sr=new Array(64),m0=new Array(123);for(ne=0;ne<64;)m0[Sr[ne]=ne<26?ne+65:ne<52?ne+71:ne<62?ne-4:ne-59|43]=ne++;var ne;Fn.encode=function(e,r,n){for(var i=null,o=[],s=0,a=0,f;r<n;){var c=e[r++];switch(a){case 0:o[s++]=Sr[c>>2],f=(c&3)<<4,a=1;break;case 1:o[s++]=Sr[f|c>>4],f=(c&15)<<2,a=2;break;case 2:o[s++]=Sr[f|c>>6],o[s++]=Sr[c&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=Sr[f],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var g0="invalid encoding";Fn.decode=function(e,r,n){for(var i=n,o=0,s,a=0;a<e.length;){var f=e.charCodeAt(a++);if(f===61&&o>1)break;if((f=m0[f])===void 0)throw Error(g0);switch(o){case 0:s=f,o=1;break;case 1:r[n++]=s<<2|(f&48)>>4,s=f,o=2;break;case 2:r[n++]=(s&15)<<4|(f&60)>>2,s=f,o=3;break;case 3:r[n++]=(s&3)<<6|f,o=0;break}}if(o===1)throw Error(g0);return n-i};Fn.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var w0=Q((L2,E0)=>{"use strict";E0.exports=Hn;function Hn(){this._listeners={}}Hn.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};Hn.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Hn.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var _0=Q((D2,I0)=>{"use strict";I0.exports=B0(B0);function B0(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function o(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:o,t.writeFloatBE=n?o:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function a(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?s:a,t.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((a<<31|f+127<<23|c)>>>0,o,s)}}t.writeFloatLE=e.bind(null,S0),t.writeFloatBE=e.bind(null,A0);function r(n,i,o){var s=n(i,o),a=(s>>31)*2+1,f=s>>>23&255,c=s&8388607;return f===255?c?NaN:a*(1/0):f===0?a*1401298464324817e-60*c:a*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,C0),t.readFloatBE=r.bind(null,T0)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function o(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:o,t.writeDoubleBE=n?o:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function a(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?s:a,t.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,f){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,a,f+i),n(1/s>0?0:2147483648,a,f+o);else if(isNaN(s))n(0,a,f+i),n(2146959360,a,f+o);else if(s>17976931348623157e292)n(0,a,f+i),n((c<<31|2146435072)>>>0,a,f+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,a,f+i),n((c<<31|u/4294967296)>>>0,a,f+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,a,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,a,f+o)}}}t.writeDoubleLE=e.bind(null,S0,0,4),t.writeDoubleBE=e.bind(null,A0,4,0);function r(n,i,o,s,a){var f=n(s,a+i),c=n(s,a+o),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,C0,0,4),t.readDoubleBE=r.bind(null,T0,4,0)}(),t}function S0(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function A0(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function C0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function T0(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var R0=Q((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var D0=Q(L0=>{"use strict";var lo=L0;lo.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};lo.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var o=null,s=[],a=0,f;r<n;)f=e[r++],f<128?s[a++]=f:f>191&&f<224?s[a++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[a++]=55296+(f>>10),s[a++]=56320+(f&1023)):s[a++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};lo.write=function(e,r,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=o&63|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=o&63|128);return n-i}});var k0=Q((k2,N0)=>{"use strict";N0.exports=Zd;function Zd(t,e,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(f){if(f<1||f>i)return t(f);s+f>n&&(o=t(n),s=0);var c=e.call(o,s,s+=f);return s&7&&(s=(s|7)+1),c}}});var U0=Q((P2,P0)=>{"use strict";P0.exports=Nt;var Wr=rr();function Nt(t,e){this.lo=t>>>0,this.hi=e>>>0}var er=Nt.zero=new Nt(0,0);er.toNumber=function(){return 0};er.zzEncode=er.zzDecode=function(){return this};er.length=function(){return 1};var $d=Nt.zeroHash="\0\0\0\0\0\0\0\0";Nt.fromNumber=function(e){if(e===0)return er;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Nt(n,i)};Nt.from=function(e){if(typeof e=="number")return Nt.fromNumber(e);if(Wr.isString(e))if(Wr.Long)e=Wr.Long.fromString(e);else return Nt.fromNumber(parseInt(e,10));return e.low||e.high?new Nt(e.low>>>0,e.high>>>0):er};Nt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Nt.prototype.toLong=function(e){return Wr.Long?new Wr.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Ve=String.prototype.charCodeAt;Nt.fromHash=function(e){return e===$d?er:new Nt((Ve.call(e,0)|Ve.call(e,1)<<8|Ve.call(e,2)<<16|Ve.call(e,3)<<24)>>>0,(Ve.call(e,4)|Ve.call(e,5)<<8|Ve.call(e,6)<<16|Ve.call(e,7)<<24)>>>0)};Nt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Nt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Nt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Nt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var rr=Q(po=>{"use strict";var M=po;M.asPromise=x0();M.base64=b0();M.EventEmitter=w0();M.float=_0();M.inquire=R0();M.utf8=D0();M.pool=k0();M.LongBits=U0();M.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);M.global=M.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||po;M.emptyArray=Object.freeze?Object.freeze([]):[];M.emptyObject=Object.freeze?Object.freeze({}):{};M.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};M.isString=function(e){return typeof e=="string"||e instanceof String};M.isObject=function(e){return e&&typeof e=="object"};M.isset=M.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};M.Buffer=function(){try{var t=M.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();M._Buffer_from=null;M._Buffer_allocUnsafe=null;M.newBuffer=function(e){return typeof e=="number"?M.Buffer?M._Buffer_allocUnsafe(e):new M.Array(e):M.Buffer?M._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};M.Array=typeof Uint8Array<"u"?Uint8Array:Array;M.Long=M.global.dcodeIO&&M.global.dcodeIO.Long||M.global.Long||M.inquire("long");M.key2Re=/^true|false|0|1$/;M.key32Re=/^-?(?:0|[1-9][0-9]*)$/;M.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;M.longToHash=function(e){return e?M.LongBits.from(e).toHash():M.LongBits.zeroHash};M.longFromHash=function(e,r){var n=M.LongBits.fromHash(e);return M.Long?M.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function K0(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}M.merge=K0;M.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function O0(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&K0(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}M.newError=O0;M.ProtocolError=O0("ProtocolError");M.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(r[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};M.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};M.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};M._configure=function(){var t=M.Buffer;if(!t){M._Buffer_from=M._Buffer_allocUnsafe=null;return}M._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},M._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var go=Q((K2,H0)=>{"use strict";H0.exports=At;var ge=rr(),xo,V0=ge.LongBits,Qd=ge.utf8;function ie(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function At(t){this.buf=t,this.pos=0,this.len=t.length}var M0=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new At(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new At(e);throw Error("illegal buffer")},F0=function(){return ge.Buffer?function(r){return(At.create=function(i){return ge.Buffer.isBuffer(i)?new xo(i):M0(i)})(r)}:M0};At.create=F0();At.prototype._slice=ge.Array.prototype.subarray||ge.Array.prototype.slice;At.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,ie(this,10);return e}}();At.prototype.int32=function(){return this.uint32()|0};At.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function yo(){var t=new V0(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw ie(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw ie(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}At.prototype.bool=function(){return this.uint32()!==0};function zn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}At.prototype.fixed32=function(){if(this.pos+4>this.len)throw ie(this,4);return zn(this.buf,this.pos+=4)};At.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ie(this,4);return zn(this.buf,this.pos+=4)|0};function q0(){if(this.pos+8>this.len)throw ie(this,8);return new V0(zn(this.buf,this.pos+=4),zn(this.buf,this.pos+=4))}At.prototype.float=function(){if(this.pos+4>this.len)throw ie(this,4);var e=ge.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};At.prototype.double=function(){if(this.pos+8>this.len)throw ie(this,4);var e=ge.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};At.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw ie(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};At.prototype.string=function(){var e=this.bytes();return Qd.read(e,0,e.length)};At.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw ie(this,e);this.pos+=e}else do if(this.pos>=this.len)throw ie(this);while(this.buf[this.pos++]&128);return this};At.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};At._configure=function(t){xo=t,At.create=F0(),xo._configure();var e=ge.Long?"toLong":"toNumber";ge.merge(At.prototype,{int64:function(){return yo.call(this)[e](!1)},uint64:function(){return yo.call(this)[e](!0)},sint64:function(){return yo.call(this).zzDecode()[e](!1)},fixed64:function(){return q0.call(this)[e](!0)},sfixed64:function(){return q0.call(this)[e](!1)}})}});var Y0=Q((O2,W0)=>{"use strict";W0.exports=nr;var G0=go();(nr.prototype=Object.create(G0.prototype)).constructor=nr;var z0=rr();function nr(t){G0.call(this,t)}nr._configure=function(){z0.Buffer&&(nr.prototype._slice=z0.Buffer.prototype.slice)};nr.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};nr._configure()});var So=Q((M2,X0)=>{"use strict";X0.exports=nt;var Zt=rr(),mo,Gn=Zt.LongBits,Z0=Zt.base64,$0=Zt.utf8;function Yr(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function bo(){}function Xd(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function nt(){this.len=0,this.head=new Yr(bo,0,0),this.tail=this.head,this.states=null}var Q0=function(){return Zt.Buffer?function(){return(nt.create=function(){return new mo})()}:function(){return new nt}};nt.create=Q0();nt.alloc=function(e){return new Zt.Array(e)};Zt.Array!==Array&&(nt.alloc=Zt.pool(nt.alloc,Zt.Array.prototype.subarray));nt.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Yr(e,r,n),this.len+=r,this};function Eo(t,e,r){e[r]=t&255}function Jd(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function wo(t,e){this.len=t,this.next=void 0,this.val=e}wo.prototype=Object.create(Yr.prototype);wo.prototype.fn=Jd;nt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new wo((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};nt.prototype.int32=function(e){return e<0?this._push(Bo,10,Gn.fromNumber(e)):this.uint32(e)};nt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Bo(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}nt.prototype.uint64=function(e){var r=Gn.from(e);return this._push(Bo,r.length(),r)};nt.prototype.int64=nt.prototype.uint64;nt.prototype.sint64=function(e){var r=Gn.from(e).zzEncode();return this._push(Bo,r.length(),r)};nt.prototype.bool=function(e){return this._push(Eo,1,e?1:0)};function vo(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}nt.prototype.fixed32=function(e){return this._push(vo,4,e>>>0)};nt.prototype.sfixed32=nt.prototype.fixed32;nt.prototype.fixed64=function(e){var r=Gn.from(e);return this._push(vo,4,r.lo)._push(vo,4,r.hi)};nt.prototype.sfixed64=nt.prototype.fixed64;nt.prototype.float=function(e){return this._push(Zt.float.writeFloatLE,4,e)};nt.prototype.double=function(e){return this._push(Zt.float.writeDoubleLE,8,e)};var jd=Zt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};nt.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Eo,1,0);if(Zt.isString(e)){var n=nt.alloc(r=Z0.length(e));Z0.decode(e,n,0),e=n}return this.uint32(r)._push(jd,r,e)};nt.prototype.string=function(e){var r=$0.length(e);return r?this.uint32(r)._push($0.write,r,e):this._push(Eo,1,0)};nt.prototype.fork=function(){return this.states=new Xd(this),this.head=this.tail=new Yr(bo,0,0),this.len=0,this};nt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Yr(bo,0,0),this.len=0),this};nt.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};nt.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};nt._configure=function(t){mo=t,nt.create=Q0(),mo._configure()}});var tf=Q((q2,j0)=>{"use strict";j0.exports=me;var J0=So();(me.prototype=Object.create(J0.prototype)).constructor=me;var Fe=rr();function me(){J0.call(this)}me._configure=function(){me.alloc=Fe._Buffer_allocUnsafe,me.writeBytesBuffer=Fe.Buffer&&Fe.Buffer.prototype instanceof Uint8Array&&Fe.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};me.prototype.bytes=function(e){Fe.isString(e)&&(e=Fe._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(me.writeBytesBuffer,r,e),this};function tp(t,e,r){t.length<40?Fe.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}me.prototype.string=function(e){var r=Fe.Buffer.byteLength(e);return this.uint32(r),r&&this._push(tp,r,e),this};me._configure()});var vf=Q((Lx,mf)=>{var pt=ft();Ze();Bt();var $r=mf.exports=pt.sha512=pt.sha512||{};pt.md.sha512=pt.md.algorithms.sha512=$r;var xf=pt.sha384=pt.sha512.sha384=pt.sha512.sha384||{};xf.create=function(){return $r.create("SHA-384")};pt.md.sha384=pt.md.algorithms.sha384=xf;pt.sha512.sha256=pt.sha512.sha256||{create:function(){return $r.create("SHA-512/256")}};pt.md["sha512/256"]=pt.md.algorithms["sha512/256"]=pt.sha512.sha256;pt.sha512.sha224=pt.sha512.sha224||{create:function(){return $r.create("SHA-512/224")}};pt.md["sha512/224"]=pt.md.algorithms["sha512/224"]=pt.sha512.sha224;$r.create=function(t){if(gf||up(),typeof t>"u"&&(t="SHA-512"),!(t in or))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=or[t],r=null,n=pt.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var f=a.messageLengthSize/4,c=0;c<f;++c)a.fullMessageLength.push(0);n=pt.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return a},a.start(),a.update=function(f,c){c==="utf8"&&(f=pt.util.encodeUtf8(f));var u=f.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),yf(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var f=pt.util.createBuffer();f.putBytes(n.bytes());var c=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=c&a.blockLength-1;f.putBytes(ko.substr(0,a.blockLength-u));for(var h,l,x=a.fullMessageLength[0]*8,d=0;d<a.fullMessageLength.length-1;++d)h=a.fullMessageLength[d+1]*8,l=h/4294967296>>>0,x+=l,f.putInt32(x>>>0),x=h>>>0;f.putInt32(x);for(var p=new Array(r.length),d=0;d<r.length;++d)p[d]=r[d].slice(0);yf(p,i,f);var y=pt.util.createBuffer(),m;t==="SHA-512"?m=p.length:t==="SHA-384"?m=p.length-2:m=p.length-4;for(var d=0;d<m;++d)y.putInt32(p[d][0]),(d!==m-1||t!=="SHA-512/224")&&y.putInt32(p[d][1]);return y},a};var ko=null,gf=!1,Po=null,or=null;function up(){ko=String.fromCharCode(128),ko+=pt.util.fillString(String.fromCharCode(0),128),Po=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],or={},or["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],or["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],or["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],or["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],gf=!0}function yf(t,e,r){for(var n,i,o,s,a,f,c,u,h,l,x,d,p,y,m,E,b,R,w,B,L,D,G,z,V,J,ct,kt,T,k,_,N,A,K,O,F=r.length();F>=128;){for(T=0;T<16;++T)e[T][0]=r.getInt32()>>>0,e[T][1]=r.getInt32()>>>0;for(;T<80;++T)N=e[T-2],k=N[0],_=N[1],n=((k>>>19|_<<13)^(_>>>29|k<<3)^k>>>6)>>>0,i=((k<<13|_>>>19)^(_<<3|k>>>29)^(k<<26|_>>>6))>>>0,K=e[T-15],k=K[0],_=K[1],o=((k>>>1|_<<31)^(k>>>8|_<<24)^k>>>7)>>>0,s=((k<<31|_>>>1)^(k<<24|_>>>8)^(k<<25|_>>>7))>>>0,A=e[T-7],O=e[T-16],_=i+A[1]+s+O[1],e[T][0]=n+A[0]+o+O[0]+(_/4294967296>>>0)>>>0,e[T][1]=_>>>0;for(p=t[0][0],y=t[0][1],m=t[1][0],E=t[1][1],b=t[2][0],R=t[2][1],w=t[3][0],B=t[3][1],L=t[4][0],D=t[4][1],G=t[5][0],z=t[5][1],V=t[6][0],J=t[6][1],ct=t[7][0],kt=t[7][1],T=0;T<80;++T)c=((L>>>14|D<<18)^(L>>>18|D<<14)^(D>>>9|L<<23))>>>0,u=((L<<18|D>>>14)^(L<<14|D>>>18)^(D<<23|L>>>9))>>>0,h=(V^L&(G^V))>>>0,l=(J^D&(z^J))>>>0,a=((p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25))>>>0,f=((p<<4|y>>>28)^(y<<30|p>>>2)^(y<<25|p>>>7))>>>0,x=(p&m|b&(p^m))>>>0,d=(y&E|R&(y^E))>>>0,_=kt+u+l+Po[T][1]+e[T][1],n=ct+c+h+Po[T][0]+e[T][0]+(_/4294967296>>>0)>>>0,i=_>>>0,_=f+d,o=a+x+(_/4294967296>>>0)>>>0,s=_>>>0,ct=V,kt=J,V=G,J=z,G=L,z=D,_=B+i,L=w+n+(_/4294967296>>>0)>>>0,D=_>>>0,w=b,B=R,b=m,R=E,m=p,E=y,_=i+s,p=n+o+(_/4294967296>>>0)>>>0,y=_>>>0;_=t[0][1]+y,t[0][0]=t[0][0]+p+(_/4294967296>>>0)>>>0,t[0][1]=_>>>0,_=t[1][1]+E,t[1][0]=t[1][0]+m+(_/4294967296>>>0)>>>0,t[1][1]=_>>>0,_=t[2][1]+R,t[2][0]=t[2][0]+b+(_/4294967296>>>0)>>>0,t[2][1]=_>>>0,_=t[3][1]+B,t[3][0]=t[3][0]+w+(_/4294967296>>>0)>>>0,t[3][1]=_>>>0,_=t[4][1]+D,t[4][0]=t[4][0]+L+(_/4294967296>>>0)>>>0,t[4][1]=_>>>0,_=t[5][1]+z,t[5][0]=t[5][0]+G+(_/4294967296>>>0)>>>0,t[5][1]=_>>>0,_=t[6][1]+J,t[6][0]=t[6][0]+V+(_/4294967296>>>0)>>>0,t[6][1]=_>>>0,_=t[7][1]+kt,t[7][0]=t[7][0]+ct+(_/4294967296>>>0)>>>0,t[7][1]=_>>>0,F-=128}}});var Fp={};bt(Fp,{aes:()=>Ui,hmac:()=>ln,keys:()=>Yo,pbkdf2:()=>Zo,randomBytes:()=>Ir});var Ui={};bt(Ui,{create:()=>bu});var H=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var ia={16:"aes-128-ctr",32:"aes-256-ctr"};function oa(t){if(t.length===16||t.length===32)return ia[t.length];let e=Object.entries(ia).map(([r,n])=>`${r} (${n})`).join(" / ");throw new H(`Invalid key length ${t.length} bytes. Must be ${e}`,"ERR_INVALID_KEY_LENGTH")}var G1=Et(sn(),1),Kr=Et(ft(),1);function ur(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var gi={};bt(gi,{identity:()=>vc});function pc(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,f=t.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var p=0,y=0,m=0,E=d.length;m!==E&&d[m]===0;)m++,p++;for(var b=(E-m)*u+1>>>0,R=new Uint8Array(b);m!==E;){for(var w=d[m],B=0,L=b-1;(w!==0||B<y)&&L!==-1;L--,B++)w+=256*R[L]>>>0,R[L]=w%a>>>0,w=w/a>>>0;if(w!==0)throw new Error("Non-zero carry");y=B,m++}for(var D=b-y;D!==b&&R[D]===0;)D++;for(var G=f.repeat(p);D<b;++D)G+=t.charAt(R[D]);return G}function l(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var p=0;if(d[p]!==" "){for(var y=0,m=0;d[p]===f;)y++,p++;for(var E=(d.length-p)*c+1>>>0,b=new Uint8Array(E);d[p];){var R=r[d.charCodeAt(p)];if(R===255)return;for(var w=0,B=E-1;(R!==0||w<m)&&B!==-1;B--,w++)R+=a*b[B]>>>0,b[B]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");m=w,p++}if(d[p]!==" "){for(var L=E-m;L!==E&&b[L]===0;)L++;for(var D=new Uint8Array(y+(E-L)),G=y;L!==E;)D[G++]=b[L++];return D}}}function x(d){var p=l(d);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:x}}var yc=pc,xc=yc,ba=xc;var e1=new Uint8Array(0);var Ea=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Ee=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var wa=t=>new TextEncoder().encode(t),Ba=t=>new TextDecoder().decode(t);var di=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},pi=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Aa(this,e)}},yi=class{constructor(e){this.decoders=e}or(e){return Aa(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Aa=(t,e)=>new yi({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),xi=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new di(e,r,n),this.decoder=new pi(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},hr=({name:t,prefix:e,encode:r,decode:n})=>new xi(t,e,r,n),ke=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=ba(r,e);return hr({prefix:t,name:e,encode:n,decode:o=>Ee(i(o))})},gc=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,f=0,c=0;for(let u=0;u<o;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,a+=r,a>=8&&(a-=8,s[c++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return s},mc=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},wt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>hr({prefix:e,name:t,encode(i){return mc(i,n,r)},decode(i){return gc(i,n,r,t)}});var vc=hr({prefix:"\0",name:"identity",encode:t=>Ba(t),decode:t=>wa(t)});var mi={};bt(mi,{base2:()=>bc});var bc=wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var vi={};bt(vi,{base8:()=>Ec});var Ec=wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var bi={};bt(bi,{base10:()=>wc});var wc=ke({prefix:"9",name:"base10",alphabet:"0123456789"});var Ei={};bt(Ei,{base16:()=>Bc,base16upper:()=>Sc});var Bc=wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Sc=wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var wi={};bt(wi,{base32:()=>lr,base32hex:()=>Ic,base32hexpad:()=>Rc,base32hexpadupper:()=>Lc,base32hexupper:()=>_c,base32pad:()=>Cc,base32padupper:()=>Tc,base32upper:()=>Ac,base32z:()=>Dc});var lr=wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ac=wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Cc=wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Tc=wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ic=wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_c=wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Rc=wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Lc=wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Dc=wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Bi={};bt(Bi,{base36:()=>Nc,base36upper:()=>kc});var Nc=ke({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kc=ke({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Si={};bt(Si,{base58btc:()=>zt,base58flickr:()=>Pc});var zt=ke({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Pc=ke({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ai={};bt(Ai,{base64:()=>Dr,base64pad:()=>Uc,base64url:()=>Kc,base64urlpad:()=>Oc});var Dr=wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Uc=wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Kc=wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Oc=wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ci={};bt(Ci,{base256emoji:()=>Hc});var Ca=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Mc=Ca.reduce((t,e,r)=>(t[r]=e,t),[]),qc=Ca.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Vc(t){return t.reduce((e,r)=>(e+=Mc[r],e),"")}function Fc(t){let e=[];for(let r of t){let n=qc[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Hc=hr({prefix:"\u{1F680}",name:"base256emoji",encode:Vc,decode:Fc});var Ri={};bt(Ri,{sha256:()=>Vt,sha512:()=>fu});var zc=_a,Ta=128,Gc=127,Wc=~Gc,Yc=Math.pow(2,31);function _a(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Yc;)e[r++]=t&255|Ta,t/=128;for(;t&Wc;)e[r++]=t&255|Ta,t>>>=7;return e[r]=t|0,_a.bytes=r-n+1,e}var Zc=Ti,$c=128,Ia=127;function Ti(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw Ti.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&Ia)<<i:(s&Ia)*Math.pow(2,i),i+=7}while(s>=$c);return Ti.bytes=o-n,r}var Qc=Math.pow(2,7),Xc=Math.pow(2,14),Jc=Math.pow(2,21),jc=Math.pow(2,28),tu=Math.pow(2,35),eu=Math.pow(2,42),ru=Math.pow(2,49),nu=Math.pow(2,56),iu=Math.pow(2,63),ou=function(t){return t<Qc?1:t<Xc?2:t<Jc?3:t<jc?4:t<tu?5:t<eu?6:t<ru?7:t<nu?8:t<iu?9:10},au={encode:zc,decode:Zc,encodingLength:ou},su=au,Nr=su;var kr=(t,e=0)=>[Nr.decode(t,e),Nr.decode.bytes],dr=(t,e,r=0)=>(Nr.encode(t,e,r),e),pr=t=>Nr.encodingLength(t);var Ye=(t,e)=>{let r=e.byteLength,n=pr(t),i=n+pr(r),o=new Uint8Array(i+r);return dr(t,o,0),dr(r,o,n),o.set(e,i),new yr(t,r,e,o)},Ra=t=>{let e=Ee(t),[r,n]=kr(e),[i,o]=kr(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new yr(r,i,s,e)},La=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Ea(t.bytes,r.bytes)}},yr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var _i=({name:t,code:e,encode:r})=>new Ii(t,e,r),Ii=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Ye(this.code,r):r.then(n=>Ye(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Na=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Vt=_i({name:"sha2-256",code:18,encode:Na("SHA-256")}),fu=_i({name:"sha2-512",code:19,encode:Na("SHA-512")});var Di={};bt(Di,{identity:()=>Li});var ka=0,cu="identity",Pa=Ee,uu=t=>Ye(ka,Pa(t)),Li={code:ka,name:cu,encode:Pa,digest:uu};var w1=new TextEncoder,B1=new TextDecoder;var Ua=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return pu(r,Ni(t),e||zt.encoder);default:return yu(r,Ni(t),e||lr.encoder)}};var Ka=new WeakMap,Ni=t=>{let e=Ka.get(t);if(e==null){let r=new Map;return Ka.set(t,r),r}return e},cn=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Ur)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==xu)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Ye(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&La(e.multihash,n.multihash)}toString(e){return Ua(this,e)}toJSON(){return{"/":Ua(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s||Oa(n,i,o.bytes))}else if(r[gu]===!0){let{version:n,multihash:i,code:o}=r,s=Ra(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Ur)throw new Error(`Version 0 CID must use dag-pb (code: ${Ur}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=Oa(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Ur,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=Ee(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new yr(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=kr(e.subarray(r));return r+=l,h},i=n(),o=Ur;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:o,multihashCode:a,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=du(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Ni(o).set(n,e),o}},du=(t,e)=>{switch(t[0]){case"Q":{let r=e||zt;return[zt.prefix,r.decode(`${zt.prefix}${t}`)]}case zt.prefix:{let r=e||zt;return[zt.prefix,r.decode(t)]}case lr.prefix:{let r=e||lr;return[lr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},pu=(t,e,r)=>{let{prefix:n}=r;if(n!==zt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},yu=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},Ur=112,xu=18,Oa=(t,e,r)=>{let n=pr(t),i=n+pr(e),o=new Uint8Array(i+r.byteLength);return dr(t,o,0),dr(e,o,n),o.set(r,i),o},gu=Symbol.for("@ipld/js-cid/CID");var ki={...gi,...mi,...vi,...bi,...Ei,...wi,...Bi,...Si,...Ai,...Ci},N1={...Ri,...Di};function un(t=0){return globalThis.Buffer?.allocUnsafe!=null?ur(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function qa(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Ma=qa("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Pi=qa("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=un(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),mu={utf8:Ma,"utf-8":Ma,hex:ki.base16,latin1:Pi,ascii:Pi,binary:Pi,...ki},hn=mu;function Lt(t,e="utf8"){let r=hn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ur(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function mt(t,e="utf8"){let r=hn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Va(t,e,r){let n=Kr.default.cipher.createCipher("AES-CTR",mt(e,"ascii"));return n.start({iv:mt(r,"ascii")}),{update:i=>(n.update(Kr.default.util.createBuffer(mt(i,"ascii"))),Lt(n.output.getBytes(),"ascii"))}}function Fa(t,e,r){let n=Kr.default.cipher.createDecipher("AES-CTR",mt(e,"ascii"));return n.start({iv:mt(r,"ascii")}),{update:i=>(n.update(Kr.default.util.createBuffer(mt(i,"ascii"))),Lt(n.output.getBytes(),"ascii"))}}async function bu(t,e){let r=oa(t),n=Va(r,t,e),i=Fa(r,t,e);return{async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}}}var ln={};bt(ln,{create:()=>Ki});var St={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Ha={SHA1:20,SHA256:32,SHA512:64};var Eu={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},wu=async(t,e)=>{let r=await St.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,0,r.byteLength)};async function Ki(t,e){let r=Eu[t],n=await St.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return wu(n,i)},length:Ha[t]}}var Yo={};bt(Yo,{generateEphemeralKeyPair:()=>hf,generateKeyPair:()=>Up,generateKeyPairFromSeed:()=>Kp,importKey:()=>Vp,keyStretcher:()=>pf,keysPBM:()=>Cr,marshalPrivateKey:()=>qp,marshalPublicKey:()=>Mp,supportedKeys:()=>ve,unmarshalPrivateKey:()=>Hf,unmarshalPublicKey:()=>Op});var Mg=Et(qr(),1),qg=Et(zs(),1);var ti=Et(ft(),1);var Do={};bt(Do,{Ed25519PrivateKey:()=>ir,Ed25519PublicKey:()=>Zr,generateKeyPair:()=>ap,generateKeyPairFromSeed:()=>Lo,unmarshalEd25519PrivateKey:()=>ip,unmarshalEd25519PublicKey:()=>op});function Jt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function $i(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function ql(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Gs(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Vl(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");$i(t.outputLen),$i(t.blockLen)}function Fl(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Hl(t,e){Gs(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var zl={number:$i,bool:ql,bytes:Gs,hash:Vl,exists:Fl,output:Hl},Ae=zl;var Tn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Ws=t=>t instanceof Uint8Array;var In=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),jt=(t,e)=>t<<32-e|t>>>e,Gl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Gl)throw new Error("Non little-endian hardware is not supported");var wy=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Qi(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Hr(t){if(typeof t=="string"&&(t=Qi(t)),!Ws(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function _n(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Ws(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var mr=class{clone(){return this._cloneInto()}};function Ke(t){let e=n=>t().update(Hr(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Je(t=32){if(Tn&&typeof Tn.getRandomValues=="function")return Tn.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Wl(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),f=n?4:0,c=n?0:4;t.setUint32(e+f,s,n),t.setUint32(e+c,a,n)}var vr=class extends mr{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=In(this.buffer)}update(e){Ae.exists(this);let{view:r,buffer:n,blockLen:i}=this;e=Hr(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let f=In(e);for(;i<=o-s;s+=i)this.process(f,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ae.exists(this),Ae.output(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)r[h]=0;Wl(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=In(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)a.setUint32(4*h,u[h],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};var Rn=BigInt(4294967295),Xi=BigInt(32);function Ys(t,e=!1){return e?{h:Number(t&Rn),l:Number(t>>Xi&Rn)}:{h:Number(t>>Xi&Rn)|0,l:Number(t&Rn)|0}}function Yl(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=Ys(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}var Zl=(t,e)=>BigInt(t>>>0)<<Xi|BigInt(e>>>0),$l=(t,e,r)=>t>>>r,Ql=(t,e,r)=>t<<32-r|e>>>r,Xl=(t,e,r)=>t>>>r|e<<32-r,Jl=(t,e,r)=>t<<32-r|e>>>r,jl=(t,e,r)=>t<<64-r|e>>>r-32,td=(t,e,r)=>t>>>r-32|e<<64-r,ed=(t,e)=>e,rd=(t,e)=>t,nd=(t,e,r)=>t<<r|e>>>32-r,id=(t,e,r)=>e<<r|t>>>32-r,od=(t,e,r)=>e<<r-32|t>>>64-r,ad=(t,e,r)=>t<<r-32|e>>>64-r;function sd(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var fd=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),cd=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,ud=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),hd=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,ld=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),dd=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0,pd={fromBig:Ys,split:Yl,toBig:Zl,shrSH:$l,shrSL:Ql,rotrSH:Xl,rotrSL:Jl,rotrBH:jl,rotrBL:td,rotr32H:ed,rotr32L:rd,rotlSH:nd,rotlSL:id,rotlBH:od,rotlBL:ad,add:sd,add3L:fd,add3H:cd,add4L:ud,add4H:hd,add5H:dd,add5L:ld},Z=pd;var[yd,xd]=Z.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Oe=new Uint32Array(80),Me=new Uint32Array(80),br=class extends vr{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:f,Eh:c,El:u,Fh:h,Fl:l,Gh:x,Gl:d,Hh:p,Hl:y}=this;return[e,r,n,i,o,s,a,f,c,u,h,l,x,d,p,y]}set(e,r,n,i,o,s,a,f,c,u,h,l,x,d,p,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=x|0,this.Gl=d|0,this.Hh=p|0,this.Hl=y|0}process(e,r){for(let b=0;b<16;b++,r+=4)Oe[b]=e.getUint32(r),Me[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let R=Oe[b-15]|0,w=Me[b-15]|0,B=Z.rotrSH(R,w,1)^Z.rotrSH(R,w,8)^Z.shrSH(R,w,7),L=Z.rotrSL(R,w,1)^Z.rotrSL(R,w,8)^Z.shrSL(R,w,7),D=Oe[b-2]|0,G=Me[b-2]|0,z=Z.rotrSH(D,G,19)^Z.rotrBH(D,G,61)^Z.shrSH(D,G,6),V=Z.rotrSL(D,G,19)^Z.rotrBL(D,G,61)^Z.shrSL(D,G,6),J=Z.add4L(L,V,Me[b-7],Me[b-16]),ct=Z.add4H(J,B,z,Oe[b-7],Oe[b-16]);Oe[b]=ct|0,Me[b]=J|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:f,Dh:c,Dl:u,Eh:h,El:l,Fh:x,Fl:d,Gh:p,Gl:y,Hh:m,Hl:E}=this;for(let b=0;b<80;b++){let R=Z.rotrSH(h,l,14)^Z.rotrSH(h,l,18)^Z.rotrBH(h,l,41),w=Z.rotrSL(h,l,14)^Z.rotrSL(h,l,18)^Z.rotrBL(h,l,41),B=h&x^~h&p,L=l&d^~l&y,D=Z.add5L(E,w,L,xd[b],Me[b]),G=Z.add5H(D,m,R,B,yd[b],Oe[b]),z=D|0,V=Z.rotrSH(n,i,28)^Z.rotrBH(n,i,34)^Z.rotrBH(n,i,39),J=Z.rotrSL(n,i,28)^Z.rotrBL(n,i,34)^Z.rotrBL(n,i,39),ct=n&o^n&a^o&a,kt=i&s^i&f^s&f;m=p|0,E=y|0,p=x|0,y=d|0,x=h|0,d=l|0,{h,l}=Z.add(c|0,u|0,G|0,z|0),c=a|0,u=f|0,a=o|0,f=s|0,o=n|0,s=i|0;let T=Z.add3L(z,J,kt);n=Z.add3H(T,G,V,ct),i=T|0}({h:n,l:i}=Z.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=Z.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:f}=Z.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:c,l:u}=Z.add(this.Dh|0,this.Dl|0,c|0,u|0),{h,l}=Z.add(this.Eh|0,this.El|0,h|0,l|0),{h:x,l:d}=Z.add(this.Fh|0,this.Fl|0,x|0,d|0),{h:p,l:y}=Z.add(this.Gh|0,this.Gl|0,p|0,y|0),{h:m,l:E}=Z.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,i,o,s,a,f,c,u,h,l,x,d,p,y,m,E)}roundClean(){Oe.fill(0),Me.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Ji=class extends br{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},ji=class extends br{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},to=class extends br{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}},eo=Ke(()=>new br),Ly=Ke(()=>new Ji),Dy=Ke(()=>new ji),Ny=Ke(()=>new to);var Nn={};bt(Nn,{bitGet:()=>Ed,bitLen:()=>bd,bitMask:()=>zr,bitSet:()=>wd,bytesToHex:()=>pe,bytesToNumberBE:()=>te,bytesToNumberLE:()=>ye,concatBytes:()=>ee,createHmacDrbg:()=>io,ensureBytes:()=>ht,equalBytes:()=>Xs,hexToBytes:()=>je,hexToNumber:()=>no,numberToBytesBE:()=>Ce,numberToBytesLE:()=>qe,numberToHexUnpadded:()=>Qs,numberToVarBytesBE:()=>vd,utf8ToBytes:()=>Js,validateObject:()=>Yt});var $s=BigInt(0),Ln=BigInt(1),gd=BigInt(2),Dn=t=>t instanceof Uint8Array,md=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function pe(t){if(!Dn(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=md[t[r]];return e}function Qs(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function no(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function je(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,o=t.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function te(t){return no(pe(t))}function ye(t){if(!Dn(t))throw new Error("Uint8Array expected");return no(pe(Uint8Array.from(t).reverse()))}function Ce(t,e){return je(t.toString(16).padStart(e*2,"0"))}function qe(t,e){return Ce(t,e).reverse()}function vd(t){return je(Qs(t))}function ht(t,e,r){let n;if(typeof e=="string")try{n=je(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(Dn(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function ee(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Dn(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function Xs(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Js(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function bd(t){let e;for(e=0;t>$s;t>>=Ln,e+=1);return e}function Ed(t,e){return t>>BigInt(e)&Ln}var wd=(t,e,r)=>t|(r?Ln:$s)<<BigInt(e),zr=t=>(gd<<BigInt(t-1))-Ln,ro=t=>new Uint8Array(t),Zs=t=>Uint8Array.from(t);function io(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=ro(t),i=ro(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...h)=>r(i,n,...h),f=(h=ro())=>{i=a(Zs([0]),h),n=a(),h.length!==0&&(i=a(Zs([1]),h),n=a())},c=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,l=[];for(;h<e;){n=a();let x=n.slice();l.push(x),h+=n.length}return ee(...l)};return(h,l)=>{s(),f(h);let x;for(;!(x=l(c()));)f();return s(),x}}var Bd={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Yt(t,e,r={}){let n=(i,o,s)=>{let a=Bd[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let f=t[i];if(!(s&&f===void 0)&&!a(f,t))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}var It=BigInt(0),xt=BigInt(1),tr=BigInt(2),Sd=BigInt(3),oo=BigInt(4),js=BigInt(5),t0=BigInt(8),Ad=BigInt(9),Cd=BigInt(16);function at(t,e){let r=t%e;return r>=It?r:e+r}function e0(t,e,r){if(r<=It||e<It)throw new Error("Expected power/modulo > 0");if(r===xt)return It;let n=xt;for(;e>It;)e&xt&&(n=n*t%r),t=t*t%r,e>>=xt;return n}function gt(t,e,r){let n=t;for(;e-- >It;)n*=n,n%=r;return n}function kn(t,e){if(t===It||e<=It)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=at(t,e),n=e,i=It,o=xt,s=xt,a=It;for(;r!==It;){let c=n/r,u=n%r,h=i-s*c,l=o-a*c;n=r,r=u,i=s,o=a,s=h,a=l}if(n!==xt)throw new Error("invert: does not exist");return at(i,e)}function Td(t){let e=(t-xt)/tr,r,n,i;for(r=t-xt,n=0;r%tr===It;r/=tr,n++);for(i=tr;i<t&&e0(i,e,t)!==t-xt;i++);if(n===1){let s=(t+xt)/oo;return function(f,c){let u=f.pow(c,s);if(!f.eql(f.sqr(u),c))throw new Error("Cannot find square root");return u}}let o=(r+xt)/tr;return function(a,f){if(a.pow(f,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let c=n,u=a.pow(a.mul(a.ONE,i),r),h=a.pow(f,o),l=a.pow(f,r);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let x=1;for(let p=a.sqr(l);x<c&&!a.eql(p,a.ONE);x++)p=a.sqr(p);let d=a.pow(u,xt<<BigInt(c-x-1));u=a.sqr(d),h=a.mul(h,d),l=a.mul(l,u),c=x}return h}}function Id(t){if(t%oo===Sd){let e=(t+xt)/oo;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%t0===js){let e=(t-js)/t0;return function(n,i){let o=n.mul(i,tr),s=n.pow(o,e),a=n.mul(i,s),f=n.mul(n.mul(a,tr),s),c=n.mul(a,n.sub(f,n.ONE));if(!n.eql(n.sqr(c),i))throw new Error("Cannot find square root");return c}}return t%Cd,Td(t)}var r0=(t,e)=>(at(t,e)&xt)===xt,_d=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ao(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=_d.reduce((n,i)=>(n[i]="function",n),e);return Yt(t,r)}function Rd(t,e,r){if(r<It)throw new Error("Expected power > 0");if(r===It)return t.ONE;if(r===xt)return e;let n=t.ONE,i=e;for(;r>It;)r&xt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=xt;return n}function Ld(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}function Pn(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Un(t,e,r=!1,n={}){if(t<=It)throw new Error(`Expected Fp ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=Pn(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=Id(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:zr(i),ZERO:It,ONE:xt,create:f=>at(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return It<=f&&f<t},is0:f=>f===It,isOdd:f=>(f&xt)===xt,neg:f=>at(-f,t),eql:(f,c)=>f===c,sqr:f=>at(f*f,t),add:(f,c)=>at(f+c,t),sub:(f,c)=>at(f-c,t),mul:(f,c)=>at(f*c,t),pow:(f,c)=>Rd(a,f,c),div:(f,c)=>at(f*kn(c,t),t),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>kn(f,t),sqrt:n.sqrt||(f=>s(a,f)),invertBatch:f=>Ld(a,f),cmov:(f,c,u)=>u?c:f,toBytes:f=>r?qe(f,o):Ce(f,o),fromBytes:f=>{if(f.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${f.length}`);return r?ye(f):te(f)}});return Object.freeze(a)}function n0(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function i0(t,e,r=!1){t=ht("privateHash",t);let n=t.length,i=Pn(e).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let o=r?ye(t):te(t);return at(o,e-xt)+xt}var Nd=BigInt(0),so=BigInt(1);function Kn(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>Nd;)o&so&&(s=s.add(a)),a=a.double(),o>>=so;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),f=[],c=i,u=c;for(let h=0;h<s;h++){u=c,f.push(u);for(let l=1;l<a;l++)u=u.add(c),f.push(u);c=u.double()}return f},wNAF(i,o,s){let{windows:a,windowSize:f}=n(i),c=t.ZERO,u=t.BASE,h=BigInt(2**i-1),l=2**i,x=BigInt(i);for(let d=0;d<a;d++){let p=d*f,y=Number(s&h);s>>=x,y>f&&(y-=l,s+=so);let m=p,E=p+Math.abs(y)-1,b=d%2!==0,R=y<0;y===0?u=u.add(r(b,o[m])):c=c.add(r(R,o[E]))}return{p:c,f:u}},wNAFCached(i,o,s,a){let f=i._WINDOW_SIZE||1,c=o.get(i);return c||(c=this.precomputeWindow(i,f),f!==1&&o.set(i,a(c))),this.wNAF(f,c,s)}}}function Gr(t){return ao(t.Fp),Yt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Pn(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var re=BigInt(0),Ft=BigInt(1),On=BigInt(2),kd=BigInt(8),Pd={zip215:!0};function Ud(t){let e=Gr(t);return Yt(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Mn(t){let e=Ud(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:f}=e,c=On<<BigInt(a*8)-Ft,u=r.create,h=e.uvRatio||((N,A)=>{try{return{isValid:!0,value:r.sqrt(N*r.inv(A))}}catch{return{isValid:!1,value:re}}}),l=e.adjustScalarBytes||(N=>N),x=e.domain||((N,A,K)=>{if(A.length||K)throw new Error("Contexts/pre-hash are not supported");return N}),d=N=>typeof N=="bigint"&&re<N,p=(N,A)=>d(N)&&d(A)&&N<A,y=N=>N===re||p(N,c);function m(N,A){if(p(N,A))return N;throw new Error(`Expected valid scalar < ${A}, got ${typeof N} ${N}`)}function E(N){return N===re?N:m(N,n)}let b=new Map;function R(N){if(!(N instanceof w))throw new Error("ExtendedPoint expected")}class w{constructor(A,K,O,F){if(this.ex=A,this.ey=K,this.ez=O,this.et=F,!y(A))throw new Error("x required");if(!y(K))throw new Error("y required");if(!y(O))throw new Error("z required");if(!y(F))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof w)throw new Error("extended point not allowed");let{x:K,y:O}=A||{};if(!y(K)||!y(O))throw new Error("invalid affine point");return new w(K,O,Ft,u(K*O))}static normalizeZ(A){let K=r.invertBatch(A.map(O=>O.ez));return A.map((O,F)=>O.toAffine(K[F])).map(w.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:K}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:O,ey:F,ez:$,et:j}=this,st=u(O*O),tt=u(F*F),it=u($*$),Ct=u(it*it),vt=u(st*A),Pt=u(it*u(vt+tt)),Ut=u(Ct+u(K*u(st*tt)));if(Pt!==Ut)throw new Error("bad point: equation left != right (1)");let Tt=u(O*F),Kt=u($*j);if(Tt!==Kt)throw new Error("bad point: equation left != right (2)")}equals(A){R(A);let{ex:K,ey:O,ez:F}=this,{ex:$,ey:j,ez:st}=A,tt=u(K*st),it=u($*F),Ct=u(O*st),vt=u(j*F);return tt===it&&Ct===vt}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:A}=e,{ex:K,ey:O,ez:F}=this,$=u(K*K),j=u(O*O),st=u(On*u(F*F)),tt=u(A*$),it=K+O,Ct=u(u(it*it)-$-j),vt=tt+j,Pt=vt-st,Ut=tt-j,Tt=u(Ct*Pt),Kt=u(vt*Ut),be=u(Ct*Ut),Ge=u(Pt*vt);return new w(Tt,Kt,Ge,be)}add(A){R(A);let{a:K,d:O}=e,{ex:F,ey:$,ez:j,et:st}=this,{ex:tt,ey:it,ez:Ct,et:vt}=A;if(K===BigInt(-1)){let Qo=u(($-F)*(it+tt)),Xo=u(($+F)*(it-tt)),ei=u(Xo-Qo);if(ei===re)return this.double();let Jo=u(j*On*vt),jo=u(st*On*Ct),ta=jo+Jo,ea=Xo+Qo,ra=jo-Jo,Xf=u(ta*ei),Jf=u(ea*ra),jf=u(ta*ra),tc=u(ei*ea);return new w(Xf,Jf,tc,jf)}let Pt=u(F*tt),Ut=u($*it),Tt=u(st*O*vt),Kt=u(j*Ct),be=u((F+$)*(tt+it)-Pt-Ut),Ge=Kt-Tt,Rr=Kt+Tt,$o=u(Ut-K*Pt),Yf=u(be*Ge),Zf=u(Rr*$o),$f=u(be*$o),Qf=u(Ge*Rr);return new w(Yf,Zf,Qf,$f)}subtract(A){return this.add(A.negate())}wNAF(A){return D.wNAFCached(this,b,A,w.normalizeZ)}multiply(A){let{p:K,f:O}=this.wNAF(m(A,n));return w.normalizeZ([K,O])[0]}multiplyUnsafe(A){let K=E(A);return K===re?L:this.equals(L)||K===Ft?this:this.equals(B)?this.wNAF(K).p:D.unsafeLadder(this,K)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return D.unsafeLadder(this,n).is0()}toAffine(A){let{ex:K,ey:O,ez:F}=this,$=this.is0();A==null&&(A=$?kd:r.inv(F));let j=u(K*A),st=u(O*A),tt=u(F*A);if($)return{x:re,y:Ft};if(tt!==Ft)throw new Error("invZ was invalid");return{x:j,y:st}}clearCofactor(){let{h:A}=e;return A===Ft?this:this.multiplyUnsafe(A)}static fromHex(A,K=!1){let{d:O,a:F}=e,$=r.BYTES;A=ht("pointHex",A,$);let j=A.slice(),st=A[$-1];j[$-1]=st&-129;let tt=ye(j);tt===re||(K?m(tt,c):m(tt,r.ORDER));let it=u(tt*tt),Ct=u(it-Ft),vt=u(O*it-F),{isValid:Pt,value:Ut}=h(Ct,vt);if(!Pt)throw new Error("Point.fromHex: invalid y coordinate");let Tt=(Ut&Ft)===Ft,Kt=(st&128)!==0;if(!K&&Ut===re&&Kt)throw new Error("Point.fromHex: x=0 and x_0=1");return Kt!==Tt&&(Ut=u(-Ut)),w.fromAffine({x:Ut,y:tt})}static fromPrivateKey(A){return V(A).point}toRawBytes(){let{x:A,y:K}=this.toAffine(),O=qe(K,r.BYTES);return O[O.length-1]|=A&Ft?128:0,O}toHex(){return pe(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,Ft,u(e.Gx*e.Gy)),w.ZERO=new w(re,Ft,Ft,re);let{BASE:B,ZERO:L}=w,D=Kn(w,a*8);function G(N){return at(N,n)}function z(N){return G(ye(N))}function V(N){let A=a;N=ht("private key",N,A);let K=ht("hashed private key",o(N),2*A),O=l(K.slice(0,A)),F=K.slice(A,2*A),$=z(O),j=B.multiply($),st=j.toRawBytes();return{head:O,prefix:F,scalar:$,point:j,pointBytes:st}}function J(N){return V(N).pointBytes}function ct(N=new Uint8Array,...A){let K=ee(...A);return z(o(x(K,ht("context",N),!!i)))}function kt(N,A,K={}){N=ht("message",N),i&&(N=i(N));let{prefix:O,scalar:F,pointBytes:$}=V(A),j=ct(K.context,O,N),st=B.multiply(j).toRawBytes(),tt=ct(K.context,st,$,N),it=G(j+tt*F);E(it);let Ct=ee(st,qe(it,r.BYTES));return ht("result",Ct,a*2)}let T=Pd;function k(N,A,K,O=T){let{context:F,zip215:$}=O,j=r.BYTES;N=ht("signature",N,2*j),A=ht("message",A),i&&(A=i(A));let st=ye(N.slice(j,2*j)),tt,it,Ct;try{tt=w.fromHex(K,$),it=w.fromHex(N.slice(0,j),$),Ct=B.multiplyUnsafe(st)}catch{return!1}if(!$&&tt.isSmallOrder())return!1;let vt=ct(F,it.toRawBytes(),tt.toRawBytes(),A);return it.add(tt.multiplyUnsafe(vt)).subtract(Ct).clearCofactor().equals(w.ZERO)}return B._setWindowSize(8),{CURVE:e,getPublicKey:J,sign:kt,verify:k,ExtendedPoint:w,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>s(r.BYTES),precompute(N=8,A=w.BASE){return A._setWindowSize(N),A.multiply(BigInt(3)),A}}}}var Gy=BigInt(0),Wy=BigInt(1);var co=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),o0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),a2=BigInt(0),Od=BigInt(1),fo=BigInt(2),Md=BigInt(5),a0=BigInt(10),qd=BigInt(20),Vd=BigInt(40),s0=BigInt(80);function Fd(t){let e=co,n=t*t%e*t%e,i=gt(n,fo,e)*n%e,o=gt(i,Od,e)*t%e,s=gt(o,Md,e)*o%e,a=gt(s,a0,e)*s%e,f=gt(a,qd,e)*a%e,c=gt(f,Vd,e)*f%e,u=gt(c,s0,e)*c%e,h=gt(u,s0,e)*c%e,l=gt(h,a0,e)*s%e;return{pow_p_5_8:gt(l,fo,e)*t%e,b2:n}}function Hd(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function zd(t,e){let r=co,n=at(e*e*e,r),i=at(n*n*e,r),o=Fd(t*i).pow_p_5_8,s=at(t*n*o,r),a=at(e*s*s,r),f=s,c=at(s*o0,r),u=a===t,h=a===at(-t,r),l=a===at(-t*o0,r);return u&&(s=f),(h||l)&&(s=c),r0(s,r)&&(s=at(-s,r)),{isValid:u||h,value:s}}var Te=Un(co,void 0,!0),uo={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Te,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:eo,randomBytes:Je,adjustScalarBytes:Hd,uvRatio:zd},Er=Mn(uo);function f0(t,e,r){if(e.length>255)throw new Error("Context is too big");return _n(Qi("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var s2=Mn({...uo,domain:f0}),f2=Mn({...uo,domain:f0,prehash:eo});var Gd=(Te.ORDER+BigInt(3))/BigInt(8),c2=Te.pow(fo,Gd),u2=Te.sqrt(Te.neg(Te.ONE)),h2=(Te.ORDER-BigInt(5))/BigInt(8),l2=BigInt(486662);var d2=n0(Te,Te.neg(BigInt(486664)));var p2=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),y2=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),x2=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),g2=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var m2=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var wr=32,Ie=64,qn=32;async function c0(){let t=Er.utils.randomPrivateKey(),e=Er.getPublicKey(t);return{privateKey:d0(t,e),publicKey:e}}async function u0(t){if(t.length!==qn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=Er.getPublicKey(e);return{privateKey:d0(e,r),publicKey:r}}async function h0(t,e){let r=t.subarray(0,qn);return Er.sign(e,r)}async function l0(t,e,r){return Er.verify(e,r,t)}function d0(t,e){let r=new Uint8Array(Ie);for(let n=0;n<qn;n++)r[n]=t[n],r[qn+n]=e[n];return r}function xe(t,e){e==null&&(e=t.reduce((i,o)=>i+o.length,0));let r=un(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return ur(r)}var ho={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Vn(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",o=t?.saltLength??16,s=t?.iterations??32767,a=St.get();r*=8;async function f(h,l){let x=a.getRandomValues(new Uint8Array(o)),d=a.getRandomValues(new Uint8Array(n)),p={name:e,iv:d};typeof l=="string"&&(l=Lt(l));let y;if(l.length===0){y=await a.subtle.importKey("jwk",ho,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",ho,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}let m=await a.subtle.encrypt(p,y,h);return xe([x,p.iv,new Uint8Array(m)])}async function c(h,l){let x=h.subarray(0,o),d=h.subarray(o,o+n),p=h.subarray(o+n),y={name:e,iv:d};typeof l=="string"&&(l=Lt(l));let m;if(l.length===0)try{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}catch{m=await a.subtle.importKey("jwk",ho,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}let E=await a.subtle.decrypt(y,m,p);return new Uint8Array(E)}return{encrypt:f,decrypt:c}}async function Br(t,e){let n=await Vn().encrypt(t,e);return Dr.encode(n)}var Cr={};bt(Cr,{KeyType:()=>dt,PrivateKey:()=>ae,PublicKey:()=>oe});var Ao=Et(go(),1),ef=Et(Y0(),1),rf=Et(rr(),1),Co=Et(So(),1),nf=Et(tf(),1);function ep(){rf.default._configure(),Ao.default._configure(ef.default),Co.default._configure(nf.default)}ep();var of=["uint64","int64","sint64","fixed64","sfixed64"];function rp(t){for(let e of of){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function To(t){return rp(new Ao.default(t))}function np(t){for(let e of of){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function Io(){return np(Co.default.create())}function Wn(t,e){let r=To(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Yn(t,e){let r=Io();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Ar;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Ar||(Ar={}));function Zn(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function _o(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return Zn("enum",Ar.VARINT,r,n)}function $n(t,e){return Zn("message",Ar.LENGTH_DELIMITED,t,e)}var dt;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(dt||(dt={}));var Ro;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Ro||(Ro={}));(function(t){t.codec=()=>_o(Ro)})(dt||(dt={}));var oe;(function(t){let e;t.codec=()=>(e==null&&(e=$n((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),dt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=dt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Yn(r,t.codec()),t.decode=r=>Wn(r,t.codec())})(oe||(oe={}));var ae;(function(t){let e;t.codec=()=>(e==null&&(e=$n((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),dt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=dt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Yn(r,t.codec()),t.decode=r=>Wn(r,t.codec())})(ae||(ae={}));var Zr=class{_key;constructor(e){this._key=Tr(e,wr)}async verify(e,r){return l0(this._key,r,e)}marshal(){return this._key}get bytes(){return oe.encode({Type:dt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}},ir=class{_key;_publicKey;constructor(e,r){this._key=Tr(e,Ie),this._publicKey=Tr(r,wr)}async sign(e){return h0(this._key,e)}get public(){return new Zr(this._publicKey)}marshal(){return this._key}get bytes(){return ae.encode({Type:dt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}async id(){let e=Li.digest(this.public.bytes);return zt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Br(this.bytes,e);throw new H(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function ip(t){if(t.length>Ie){t=Tr(t,Ie+wr);let n=t.subarray(0,Ie),i=t.subarray(Ie,t.length);return new ir(n,i)}t=Tr(t,Ie);let e=t.subarray(0,Ie),r=t.subarray(wr);return new ir(e,r)}function op(t){return t=Tr(t,wr),new Zr(t)}async function ap(){let{privateKey:t,publicKey:e}=await c0();return new ir(t,e)}async function Lo(t){let{privateKey:e,publicKey:r}=await u0(t);return new ir(e,r)}function Tr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new H(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var ux=Et(Bt(),1),hx=Et(Bn(),1),af=Et(ft(),1);function se(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=xe([new Uint8Array(e-r.length),r])}return mt(r,"base64url")}function Ht(t){let e=Qn(t);return new af.default.jsbn.BigInteger(mt(e,"base16"),16)}function Qn(t,e){let r=Lt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=xe([new Uint8Array(e-r.length),r])}return r}var sf={"P-256":256,"P-384":384,"P-521":521},sp=Object.keys(sf),No=sp.join(" / ");async function ff(t){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new H(`Unknown curve: ${t}. Must be ${No}`,"ERR_INVALID_CURVE");let e=await St.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(o,s)=>{let a;s!=null?a=await St.get().subtle.importKey("jwk",cp(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):a=e.privateKey;let f=await St.get().subtle.importKey("jwk",uf(t,o),{name:"ECDH",namedCurve:t},!1,[]),c=await St.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:f},a,sf[t]);return new Uint8Array(c,0,c.byteLength)},n=await St.get().subtle.exportKey("jwk",e.publicKey);return{key:fp(n),genSharedKey:r}}var cf={"P-256":32,"P-384":48,"P-521":66};function fp(t){if(t.crv==null||t.x==null||t.y==null)throw new H("JWK was missing components","ERR_INVALID_PARAMETERS");if(t.crv!=="P-256"&&t.crv!=="P-384"&&t.crv!=="P-521")throw new H(`Unknown curve: ${t.crv}. Must be ${No}`,"ERR_INVALID_CURVE");let e=cf[t.crv];return xe([Uint8Array.from([4]),Qn(t.x,e),Qn(t.y,e)],1+e*2)}function uf(t,e){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new H(`Unknown curve: ${t}. Must be ${No}`,"ERR_INVALID_CURVE");let r=cf[t];if(!Jt(e.subarray(0,1),Uint8Array.from([4])))throw new H("Cannot unmarshal public key - invalid key format","ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:mt(e.subarray(1,r+1),"base64url"),y:mt(e.subarray(1+r),"base64url"),ext:!0}}var cp=(t,e)=>({...uf(t,e.public),d:mt(e.private,"base64url")});var hf=ff;async function lf(t,e){let r=Dr.decode(t);return Vn().decrypt(r,e)}var df={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function pf(t,e,r){let n=df[t];if(n==null){let E=Object.keys(df).join(" / ");throw new H(`unknown cipher type '${t}'. Must be ${E}`,"ERR_INVALID_CIPHER_TYPE")}if(e==null)throw new H("missing hash type","ERR_MISSING_HASH_TYPE");let i=n.keySize,o=n.ivSize,s=20,a=Lt("key expansion"),f=2*(o+i+s),c=await Ki(e,r),u=await c.digest(a),h=[],l=0;for(;l<f;){let E=await c.digest(xe([u,a])),b=E.length;l+b>f&&(b=f-l),h.push(E),l+=b,u=await c.digest(u)}let x=f/2,d=xe(h),p=d.subarray(0,x),y=d.subarray(x,f),m=E=>({iv:E.subarray(0,o),cipherKey:E.subarray(o,o+i),macKey:E.subarray(o+i)});return{k1:m(p),k2:m(y)}}var Oo={};bt(Oo,{MAX_KEY_SIZE:()=>Jr,RsaPrivateKey:()=>_r,RsaPublicKey:()=>Xr,fromJwk:()=>vp,generateKeyPair:()=>bp,unmarshalRsaPrivateKey:()=>gp,unmarshalRsaPublicKey:()=>mp});var Qr=Et(ft(),1);var jx=Et(vf(),1);function Ir(t){if(isNaN(t)||t<=0)throw new H("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Je(t)}var Px=Et(Cn(),1),Uo=Et(ft(),1);function bf(t,e){return e.map(r=>Ht(t[r]))}function Ef(t){return Uo.default.pki.setRsaPrivateKey(...bf(t,["n","e","d","p","q","dp","dq","qi"]))}function wf(t){return Uo.default.pki.setRsaPublicKey(...bf(t,["n","e"]))}var ar={};bt(ar,{jwkToPkcs1:()=>lp,jwkToPkix:()=>pp,pkcs1ToJwk:()=>hp,pkixToJwk:()=>dp});var Ox=Et(qr(),1),Mx=Et(Cn(),1);var _e=Et(ft(),1);function hp(t){let e=_e.default.asn1.fromDer(mt(t,"ascii")),r=_e.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:se(r.n),e:se(r.e),d:se(r.d),p:se(r.p),q:se(r.q),dp:se(r.dP),dq:se(r.dQ),qi:se(r.qInv),alg:"RS256"}}function lp(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new H("JWK was missing components","ERR_INVALID_PARAMETERS");let e=_e.default.pki.privateKeyToAsn1({n:Ht(t.n),e:Ht(t.e),d:Ht(t.d),p:Ht(t.p),q:Ht(t.q),dP:Ht(t.dp),dQ:Ht(t.dq),qInv:Ht(t.qi)});return Lt(_e.default.asn1.toDer(e).getBytes(),"ascii")}function dp(t){let e=_e.default.asn1.fromDer(mt(t,"ascii")),r=_e.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:se(r.n),e:se(r.e)}}function pp(t){if(t.n==null||t.e==null)throw new H("JWK was missing components","ERR_INVALID_PARAMETERS");let e=_e.default.pki.publicKeyToAsn1({n:Ht(t.n),e:Ht(t.e)});return Lt(_e.default.asn1.toDer(e).getBytes(),"ascii")}async function Bf(t){let e=await St.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Cf(e);return{privateKey:r[0],publicKey:r[1]}}async function Ko(t){let r=[await St.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await yp(t)],n=await Cf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Sf(t,e){let r=await St.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await St.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function Af(t,e,r){let n=await St.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return St.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function Cf(t){if(t.privateKey==null||t.publicKey==null)throw new H("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([St.get().subtle.exportKey("jwk",t.privateKey),St.get().subtle.exportKey("jwk",t.publicKey)])}async function yp(t){return St.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Tf(t,e,r,n){let i=e?wf(t):Ef(t),o=mt(Uint8Array.from(r),"ascii"),s=n(o,i);return Lt(s,"ascii")}function If(t,e){return Tf(t,!0,e,(r,n)=>n.encrypt(r))}function _f(t,e){return Tf(t,!1,e,(r,n)=>n.decrypt(r))}function Xn(t){if(t.kty!=="RSA")throw new H("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new H("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Lt(t.n,"base64url").length*8}var Jr=8192,Xr=class{_key;constructor(e){this._key=e}async verify(e,r){return Af(this._key,r,e)}marshal(){return ar.jwkToPkix(this._key)}get bytes(){return oe.encode({Type:dt.RSA,Data:this.marshal()}).subarray()}encrypt(e){return If(this._key,e)}equals(e){return Jt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}},_r=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Ir(16)}async sign(e){return Sf(this._key,e)}get public(){if(this._publicKey==null)throw new H("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Xr(this._publicKey)}decrypt(e){return _f(this._key,e)}marshal(){return ar.jwkToPkcs1(this._key)}get bytes(){return ae.encode({Type:dt.RSA,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return mt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Qr.default.util.ByteBuffer(this.marshal()),i=Qr.default.asn1.fromDer(n),o=Qr.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Qr.default.pki.encryptRsaPrivateKey(o,e,s)}else{if(r==="libp2p-key")return Br(this.bytes,e);throw new H(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function gp(t){let e=ar.pkcs1ToJwk(t);if(Xn(e)>Jr)throw new H("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await Ko(e);return new _r(r.privateKey,r.publicKey)}function mp(t){let e=ar.pkixToJwk(t);if(Xn(e)>Jr)throw new H("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Xr(e)}async function vp(t){if(Xn(t)>Jr)throw new H("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Ko(t);return new _r(e.privateKey,e.publicKey)}async function bp(t){if(t>Jr)throw new H("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Bf(t);return new _r(e.privateKey,e.publicKey)}var zo={};bt(zo,{Secp256k1PrivateKey:()=>tn,Secp256k1PublicKey:()=>jr,generateKeyPair:()=>Pp,unmarshalSecp256k1PrivateKey:()=>Np,unmarshalSecp256k1PublicKey:()=>kp});var Ep=(t,e,r)=>t&e^~t&r,wp=(t,e,r)=>t&e^t&r^e&r,Bp=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),He=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ze=new Uint32Array(64),Jn=class extends vr{constructor(){super(64,32,8,!1),this.A=He[0]|0,this.B=He[1]|0,this.C=He[2]|0,this.D=He[3]|0,this.E=He[4]|0,this.F=He[5]|0,this.G=He[6]|0,this.H=He[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:f}=this;return[e,r,n,i,o,s,a,f]}set(e,r,n,i,o,s,a,f){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=f|0}process(e,r){for(let h=0;h<16;h++,r+=4)ze[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let l=ze[h-15],x=ze[h-2],d=jt(l,7)^jt(l,18)^l>>>3,p=jt(x,17)^jt(x,19)^x>>>10;ze[h]=p+ze[h-7]+d+ze[h-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:f,G:c,H:u}=this;for(let h=0;h<64;h++){let l=jt(a,6)^jt(a,11)^jt(a,25),x=u+l+Ep(a,f,c)+Bp[h]+ze[h]|0,p=(jt(n,2)^jt(n,13)^jt(n,22))+wp(n,i,o)|0;u=c,c=f,f=a,a=s+x|0,s=o,o=i,i=n,n=x+p|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,f,c,u)}roundClean(){ze.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Mo=class extends Jn{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},Rf=Ke(()=>new Jn),ig=Ke(()=>new Mo);function Sp(t){let e=Gr(t);Yt(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:Ap,hexToBytes:Cp}=Nn,sr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=sr;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Ap(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=sr,r=typeof t=="string"?Cp(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=sr._parseInt(r.subarray(2)),{d:s,l:a}=sr._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,r=c=>{let u=c.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),f=r(s);return`30${r(s+o+4)}02${f}${i}02${a}${n}`}},Re=BigInt(0),$t=BigInt(1),cg=BigInt(2),Lf=BigInt(3),ug=BigInt(4);function Tp(t){let e=Sp(t),{Fp:r}=e,n=e.toBytes||((d,p,y)=>{let m=p.toAffine();return ee(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),i=e.fromBytes||(d=>{let p=d.subarray(1),y=r.fromBytes(p.subarray(0,r.BYTES)),m=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function o(d){let{a:p,b:y}=e,m=r.sqr(d),E=r.mul(m,d);return r.add(r.add(E,r.mul(d,p)),y)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(d){return typeof d=="bigint"&&Re<d&&d<e.n}function a(d){if(!s(d))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(d){let{allowedPrivateKeyLengths:p,nByteLength:y,wrapPrivateKey:m,n:E}=e;if(p&&typeof d!="bigint"){if(d instanceof Uint8Array&&(d=pe(d)),typeof d!="string"||!p.includes(d.length))throw new Error("Invalid key");d=d.padStart(y*2,"0")}let b;try{b=typeof d=="bigint"?d:te(ht("private key",d,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof d}`)}return m&&(b=at(b,E)),a(b),b}let c=new Map;function u(d){if(!(d instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,y,m){if(this.px=p,this.py=y,this.pz=m,p==null||!r.isValid(p))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(p){let{x:y,y:m}=p||{};if(!p||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");let E=b=>r.eql(b,r.ZERO);return E(y)&&E(m)?h.ZERO:new h(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let y=r.invertBatch(p.map(m=>m.pz));return p.map((m,E)=>m.toAffine(y[E])).map(h.fromAffine)}static fromHex(p){let y=h.fromAffine(i(ht("pointHex",p)));return y.assertValidity(),y}static fromPrivateKey(p){return h.BASE.multiply(f(p))}_setWindowSize(p){this._WINDOW_SIZE=p,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:p,y}=this.toAffine();if(!r.isValid(p)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=o(p);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=p,B=r.eql(r.mul(y,w),r.mul(b,E)),L=r.eql(r.mul(m,w),r.mul(R,E));return B&&L}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:y}=e,m=r.mul(y,Lf),{px:E,py:b,pz:R}=this,w=r.ZERO,B=r.ZERO,L=r.ZERO,D=r.mul(E,E),G=r.mul(b,b),z=r.mul(R,R),V=r.mul(E,b);return V=r.add(V,V),L=r.mul(E,R),L=r.add(L,L),w=r.mul(p,L),B=r.mul(m,z),B=r.add(w,B),w=r.sub(G,B),B=r.add(G,B),B=r.mul(w,B),w=r.mul(V,w),L=r.mul(m,L),z=r.mul(p,z),V=r.sub(D,z),V=r.mul(p,V),V=r.add(V,L),L=r.add(D,D),D=r.add(L,D),D=r.add(D,z),D=r.mul(D,V),B=r.add(B,D),z=r.mul(b,R),z=r.add(z,z),D=r.mul(z,V),w=r.sub(w,D),L=r.mul(z,G),L=r.add(L,L),L=r.add(L,L),new h(w,B,L)}add(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=p,B=r.ZERO,L=r.ZERO,D=r.ZERO,G=e.a,z=r.mul(e.b,Lf),V=r.mul(y,b),J=r.mul(m,R),ct=r.mul(E,w),kt=r.add(y,m),T=r.add(b,R);kt=r.mul(kt,T),T=r.add(V,J),kt=r.sub(kt,T),T=r.add(y,E);let k=r.add(b,w);return T=r.mul(T,k),k=r.add(V,ct),T=r.sub(T,k),k=r.add(m,E),B=r.add(R,w),k=r.mul(k,B),B=r.add(J,ct),k=r.sub(k,B),D=r.mul(G,T),B=r.mul(z,ct),D=r.add(B,D),B=r.sub(J,D),D=r.add(J,D),L=r.mul(B,D),J=r.add(V,V),J=r.add(J,V),ct=r.mul(G,ct),T=r.mul(z,T),J=r.add(J,ct),ct=r.sub(V,ct),ct=r.mul(G,ct),T=r.add(T,ct),V=r.mul(J,T),L=r.add(L,V),V=r.mul(k,T),B=r.mul(kt,B),B=r.sub(B,V),V=r.mul(kt,J),D=r.mul(k,D),D=r.add(D,V),new h(B,L,D)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return x.wNAFCached(this,c,p,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,b)=>E.toAffine(m[b])).map(h.fromAffine)})}multiplyUnsafe(p){let y=h.ZERO;if(p===Re)return y;if(a(p),p===$t)return this;let{endo:m}=e;if(!m)return x.unsafeLadder(this,p);let{k1neg:E,k1:b,k2neg:R,k2:w}=m.splitScalar(p),B=y,L=y,D=this;for(;b>Re||w>Re;)b&$t&&(B=B.add(D)),w&$t&&(L=L.add(D)),D=D.double(),b>>=$t,w>>=$t;return E&&(B=B.negate()),R&&(L=L.negate()),L=new h(r.mul(L.px,m.beta),L.py,L.pz),B.add(L)}multiply(p){a(p);let y=p,m,E,{endo:b}=e;if(b){let{k1neg:R,k1:w,k2neg:B,k2:L}=b.splitScalar(y),{p:D,f:G}=this.wNAF(w),{p:z,f:V}=this.wNAF(L);D=x.constTimeNegate(R,D),z=x.constTimeNegate(B,z),z=new h(r.mul(z.px,b.beta),z.py,z.pz),m=D.add(z),E=G.add(V)}else{let{p:R,f:w}=this.wNAF(y);m=R,E=w}return h.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(p,y,m){let E=h.BASE,b=(w,B)=>B===Re||B===$t||!w.equals(E)?w.multiplyUnsafe(B):w.multiply(B),R=b(this,y).add(b(p,m));return R.is0()?void 0:R}toAffine(p){let{px:y,py:m,pz:E}=this,b=this.is0();p==null&&(p=b?r.ONE:r.inv(E));let R=r.mul(y,p),w=r.mul(m,p),B=r.mul(E,p);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:R,y:w}}isTorsionFree(){let{h:p,isTorsionFree:y}=e;if(p===$t)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:y}=e;return p===$t?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return pe(this.toRawBytes(p))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let l=e.nBitLength,x=Kn(h,e.endo?Math.ceil(l/2):l);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:f,weierstrassEquation:o,isWithinCurveOrder:s}}function Ip(t){let e=Gr(t);return Yt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Df(t){let e=Ip(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(T){return Re<T&&T<r.ORDER}function a(T){return at(T,n)}function f(T){return kn(T,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=Tp({...e,toBytes(T,k,_){let N=k.toAffine(),A=r.toBytes(N.x),K=ee;return _?K(Uint8Array.from([k.hasEvenY()?2:3]),A):K(Uint8Array.from([4]),A,r.toBytes(N.y))},fromBytes(T){let k=T.length,_=T[0],N=T.subarray(1);if(k===i&&(_===2||_===3)){let A=te(N);if(!s(A))throw new Error("Point is not on curve");let K=h(A),O=r.sqrt(K),F=(O&$t)===$t;return(_&1)===1!==F&&(O=r.neg(O)),{x:A,y:O}}else if(k===o&&_===4){let A=r.fromBytes(N.subarray(0,r.BYTES)),K=r.fromBytes(N.subarray(r.BYTES,2*r.BYTES));return{x:A,y:K}}else throw new Error(`Point of length ${k} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),x=T=>pe(Ce(T,e.nByteLength));function d(T){let k=n>>$t;return T>k}function p(T){return d(T)?a(-T):T}let y=(T,k,_)=>te(T.slice(k,_));class m{constructor(k,_,N){this.r=k,this.s=_,this.recovery=N,this.assertValidity()}static fromCompact(k){let _=e.nByteLength;return k=ht("compactSignature",k,_*2),new m(y(k,0,_),y(k,_,2*_))}static fromDER(k){let{r:_,s:N}=sr.toSig(ht("DER",k));return new m(_,N)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(k){return new m(this.r,this.s,k)}recoverPublicKey(k){let{r:_,s:N,recovery:A}=this,K=L(ht("msgHash",k));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let O=A===2||A===3?_+e.n:_;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let F=A&1?"03":"02",$=c.fromHex(F+x(O)),j=f(O),st=a(-K*j),tt=a(N*j),it=c.BASE.multiplyAndAddUnsafe($,st,tt);if(!it)throw new Error("point at infinify");return it.assertValidity(),it}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return je(this.toDERHex())}toDERHex(){return sr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return je(this.toCompactHex())}toCompactHex(){return x(this.r)+x(this.s)}}let E={isValidPrivateKey(T){try{return u(T),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let T=e.randomBytes(r.BYTES+8),k=i0(T,n);return Ce(k,e.nByteLength)},precompute(T=8,k=c.BASE){return k._setWindowSize(T),k.multiply(BigInt(3)),k}};function b(T,k=!0){return c.fromPrivateKey(T).toRawBytes(k)}function R(T){let k=T instanceof Uint8Array,_=typeof T=="string",N=(k||_)&&T.length;return k?N===i||N===o:_?N===2*i||N===2*o:T instanceof c}function w(T,k,_=!0){if(R(T))throw new Error("first arg must be private key");if(!R(k))throw new Error("second arg must be public key");return c.fromHex(k).multiply(u(T)).toRawBytes(_)}let B=e.bits2int||function(T){let k=te(T),_=T.length*8-e.nBitLength;return _>0?k>>BigInt(_):k},L=e.bits2int_modN||function(T){return a(B(T))},D=zr(e.nBitLength);function G(T){if(typeof T!="bigint")throw new Error("bigint expected");if(!(Re<=T&&T<D))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ce(T,e.nByteLength)}function z(T,k,_=V){if(["recovered","canonical"].some(vt=>vt in _))throw new Error("sign() legacy options not supported");let{hash:N,randomBytes:A}=e,{lowS:K,prehash:O,extraEntropy:F}=_;K==null&&(K=!0),T=ht("msgHash",T),O&&(T=ht("prehashed msgHash",N(T)));let $=L(T),j=u(k),st=[G(j),G($)];if(F!=null){let vt=F===!0?A(r.BYTES):F;st.push(ht("extraEntropy",vt,r.BYTES))}let tt=ee(...st),it=$;function Ct(vt){let Pt=B(vt);if(!l(Pt))return;let Ut=f(Pt),Tt=c.BASE.multiply(Pt).toAffine(),Kt=a(Tt.x);if(Kt===Re)return;let be=a(Ut*a(it+Kt*j));if(be===Re)return;let Ge=(Tt.x===Kt?0:2)|Number(Tt.y&$t),Rr=be;return K&&d(be)&&(Rr=p(be),Ge^=1),new m(Kt,Rr,Ge)}return{seed:tt,k2sig:Ct}}let V={lowS:e.lowS,prehash:!1},J={lowS:e.lowS,prehash:!1};function ct(T,k,_=V){let{seed:N,k2sig:A}=z(T,k,_),K=e;return io(K.hash.outputLen,K.nByteLength,K.hmac)(N,A)}c.BASE._setWindowSize(8);function kt(T,k,_,N=J){let A=T;if(k=ht("msgHash",k),_=ht("publicKey",_),"strict"in N)throw new Error("options.strict was renamed to lowS");let{lowS:K,prehash:O}=N,F,$;try{if(typeof A=="string"||A instanceof Uint8Array)try{F=m.fromDER(A)}catch(Tt){if(!(Tt instanceof sr.Err))throw Tt;F=m.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:Tt,s:Kt}=A;F=new m(Tt,Kt)}else throw new Error("PARSE");$=c.fromHex(_)}catch(Tt){if(Tt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(K&&F.hasHighS())return!1;O&&(k=e.hash(k));let{r:j,s:st}=F,tt=L(k),it=f(st),Ct=a(tt*it),vt=a(j*it),Pt=c.BASE.multiplyAndAddUnsafe($,Ct,vt)?.toAffine();return Pt?a(Pt.x)===j:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:w,sign:ct,verify:kt,ProjectivePoint:c,Signature:m,utils:E}}var jn=class extends mr{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Ae.hash(e);let n=Hr(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return Ae.exists(this),this.iHash.update(e),this}digestInto(e){Ae.exists(this),Ae.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},qo=(t,e,r)=>new jn(t,e).update(r).digest();qo.create=(t,e)=>new jn(t,e);function _p(t){return{hash:t,hmac:(e,...r)=>qo(t,e,_n(...r)),randomBytes:Je}}function Nf(t,e){let r=n=>Df({...t,..._p(n)});return Object.freeze({...r(e),create:r})}var Uf=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),kf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Rp=BigInt(1),Vo=BigInt(2),Pf=(t,e)=>(t+e/Vo)/e;function Lp(t){let e=Uf,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),f=BigInt(88),c=t*t*t%e,u=c*c*t%e,h=gt(u,r,e)*u%e,l=gt(h,r,e)*u%e,x=gt(l,Vo,e)*c%e,d=gt(x,i,e)*x%e,p=gt(d,o,e)*d%e,y=gt(p,a,e)*p%e,m=gt(y,f,e)*y%e,E=gt(m,a,e)*p%e,b=gt(E,r,e)*u%e,R=gt(b,s,e)*d%e,w=gt(R,n,e)*c%e,B=gt(w,Vo,e);if(!Fo.eql(Fo.sqr(B),t))throw new Error("Cannot find square root");return B}var Fo=Un(Uf,void 0,void 0,{sqrt:Lp}),Le=Nf({a:BigInt(0),b:BigInt(7),Fp:Fo,n:kf,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=kf,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Rp*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Pf(o*t,e),f=Pf(-n*t,e),c=at(t-a*r-f*i,e),u=at(-a*n-f*o,e),h=c>s,l=u>s;if(h&&(c=e-c),l&&(u=e-u),c>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:l,k2:u}}}},Rf),Ig=BigInt(0);var _g=Le.ProjectivePoint;function Kf(){return Le.utils.randomPrivateKey()}async function Of(t,e){let{digest:r}=await Vt.digest(e);try{return Le.sign(r,t).toDERRawBytes()}catch(n){throw new H(String(n),"ERR_INVALID_INPUT")}}async function Mf(t,e,r){try{let{digest:n}=await Vt.digest(r);return Le.verify(e,n,t)}catch(n){throw new H(String(n),"ERR_INVALID_INPUT")}}function qf(t){return Le.ProjectivePoint.fromHex(t).toRawBytes(!0)}function Vf(t){try{Le.getPublicKey(t,!0)}catch(e){throw new H(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Ho(t){try{Le.ProjectivePoint.fromHex(t)}catch(e){throw new H(String(e),"ERR_INVALID_PUBLIC_KEY")}}function Ff(t){try{return Le.getPublicKey(t,!0)}catch(e){throw new H(String(e),"ERR_INVALID_PRIVATE_KEY")}}var jr=class{_key;constructor(e){Ho(e),this._key=e}async verify(e,r){return Mf(this._key,r,e)}marshal(){return qf(this._key)}get bytes(){return oe.encode({Type:dt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}},tn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??Ff(e),Vf(this._key),Ho(this._publicKey)}async sign(e){return Of(this._key,e)}get public(){return new jr(this._publicKey)}marshal(){return this._key}get bytes(){return ae.encode({Type:dt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Jt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return mt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Br(this.bytes,e);throw new H(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Np(t){return new tn(t)}function kp(t){return new jr(t)}async function Pp(){let t=Kf();return new tn(t)}var ve={rsa:Oo,ed25519:Do,secp256k1:zo};function Go(t){let e=Object.keys(ve).join(" / ");return new H(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Wo(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return ve[t];throw Go(t)}async function Up(t,e){return Wo(t).generateKeyPair(e??2048)}async function Kp(t,e,r){if(t.toLowerCase()!=="ed25519")throw new H("Seed key derivation is unimplemented for RSA or secp256k1","ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return Lo(e)}function Op(t){let e=oe.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case dt.RSA:return ve.rsa.unmarshalRsaPublicKey(r);case dt.Ed25519:return ve.ed25519.unmarshalEd25519PublicKey(r);case dt.Secp256k1:return ve.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Go(e.Type??"RSA")}}function Mp(t,e){return e=(e??"rsa").toLowerCase(),Wo(e),t.bytes}async function Hf(t){let e=ae.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case dt.RSA:return ve.rsa.unmarshalRsaPrivateKey(r);case dt.Ed25519:return ve.ed25519.unmarshalEd25519PrivateKey(r);case dt.Secp256k1:return ve.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Go(e.Type??"RSA")}}function qp(t,e){return e=(e??"rsa").toLowerCase(),Wo(e),t.bytes}async function Vp(t,e){try{let i=await lf(t,e);return await Hf(i)}catch{}let r=ti.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new H("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=ti.default.asn1.toDer(ti.default.pki.privateKeyToAsn1(r));return n=Lt(n.getBytes(),"ascii"),ve.rsa.unmarshalRsaPrivateKey(n)}var Gf=Et(Mi(),1),Wf=Et(Bt(),1),zf={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Zo(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let a=Object.keys(zf).join(" / ");throw new H(`Hash '${i}' is unknown or not supported. Must be ${a}`,"ERR_UNSUPPORTED_HASH_TYPE")}let o=zf[i],s=(0,Gf.default)(t,e,r,n,o);return Wf.default.encode64(s,null)}return ac(Fp);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PCrypto}));
