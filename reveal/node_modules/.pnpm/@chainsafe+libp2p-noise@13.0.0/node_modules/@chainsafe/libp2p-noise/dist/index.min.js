(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PNoise = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PNoise=(()=>{var dp=Object.create;var ki=Object.defineProperty;var yp=Object.getOwnPropertyDescriptor;var gp=Object.getOwnPropertyNames;var xp=Object.getPrototypeOf,mp=Object.prototype.hasOwnProperty;var Q=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),pt=(t,e)=>{for(var r in e)ki(t,r,{get:e[r],enumerable:!0})},G0=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of gp(e))!mp.call(t,i)&&i!==r&&ki(t,i,{get:()=>e[i],enumerable:!(n=yp(e,i))||n.enumerable});return t};var It=(t,e,r)=>(r=t!=null?dp(xp(t)):{},G0(e||!t||!t.__esModule?ki(r,"default",{value:t,enumerable:!0}):r,t)),bp=t=>G0(ki({},"__esModule",{value:!0}),t);var Q0=Q(($b,X0)=>{"use strict";function Y0(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function _p(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Y0(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),Y0(new i,r)}}X0.exports=_p});var yt=Q((f8,Qc)=>{Qc.exports={options:{usePureJavaScript:!1}}});var tf=Q((u8,jc)=>{var _s={};jc.exports=_s;var Jc={};_s.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=sy(t,e);else{var i=0,o=e.length,s=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var c=0,f=t[i];c<a.length;++c)f+=a[c]<<8,a[c]=f%o,f=f/o|0;for(;f>0;)a.push(f%o),f=f/o|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};_s.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Jc[e];if(!r){r=Jc[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),s=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,f=a;c<s.length;++c)f+=s[c]*i,s[c]=f&255,f>>=8;for(;f>0;)s.push(f&255),f>>=8}for(var u=0;t[u]===o&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function sy(t,e){var r=0,n=e.length,i=e.charAt(0),o=[0];for(r=0;r<t.length();++r){for(var s=0,a=t.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=o.length-1;r>=0;--r)c+=e[o[r]];return c}});var kt=Q((h8,of)=>{var ef=yt(),rf=tf(),m=of.exports=ef.util=ef.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){m.nextTick=process.nextTick,typeof setImmediate=="function"?m.setImmediate=setImmediate:m.setImmediate=m.nextTick;return}if(typeof setImmediate=="function"){m.setImmediate=function(){return setImmediate.apply(void 0,arguments)},m.nextTick=function(a){return setImmediate(a)};return}if(m.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var f=e.slice();e.length=0,f.forEach(function(u){u()})}};var s=a,t="forge.setImmediate",e=[];m.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(f){f()})}).observe(i,{attributes:!0});var o=m.setImmediate;m.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),o(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}m.nextTick=m.setImmediate})();m.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;m.globalScope=function(){return m.isNodejs?globalThis:typeof self>"u"?window:self}();m.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};m.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};m.isArrayBufferView=function(t){return t&&m.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function jn(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}m.ByteBuffer=Ls;function Ls(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(m.isArrayBuffer(t)||m.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Ls||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}m.ByteStringBuffer=Ls;var ay=4096;m.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>ay&&(this.data.substr(0,1),this._constructedStringLength=0)};m.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};m.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};m.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};m.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};m.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};m.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(m.encodeUtf8(t))};m.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};m.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};m.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};m.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};m.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};m.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};m.ByteStringBuffer.prototype.putInt=function(t,e){jn(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};m.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};m.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};m.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};m.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};m.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};m.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};m.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};m.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};m.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};m.ByteStringBuffer.prototype.getInt=function(t){jn(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};m.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};m.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};m.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};m.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};m.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};m.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};m.ByteStringBuffer.prototype.copy=function(){var t=m.createBuffer(this.data);return t.read=this.read,t};m.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};m.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};m.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};m.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};m.ByteStringBuffer.prototype.toString=function(){return m.decodeUtf8(this.bytes())};function cy(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=m.isArrayBuffer(t),n=m.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}m.DataBuffer=cy;m.DataBuffer.prototype.length=function(){return this.write-this.read};m.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};m.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};m.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};m.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};m.DataBuffer.prototype.putBytes=function(t,e){if(m.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(m.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof m.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&m.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof m.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var o;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.hex.decode(t,o,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.base64.decode(t,o,this.write),this;if(e==="utf8"&&(t=m.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.raw.decode(o),this;if(e==="utf16")return this.accommodate(t.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=m.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};m.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};m.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};m.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};m.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};m.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};m.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};m.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};m.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};m.DataBuffer.prototype.putInt=function(t,e){jn(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};m.DataBuffer.prototype.putSignedInt=function(t,e){return jn(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};m.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};m.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};m.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};m.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};m.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};m.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};m.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};m.DataBuffer.prototype.getInt=function(t){jn(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};m.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};m.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};m.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};m.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};m.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};m.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};m.DataBuffer.prototype.copy=function(){return new m.DataBuffer(this)};m.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};m.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};m.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};m.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};m.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return m.binary.raw.encode(e);if(t==="hex")return m.binary.hex.encode(e);if(t==="base64")return m.binary.base64.encode(e);if(t==="utf8")return m.text.utf8.decode(e);if(t==="utf16")return m.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};m.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=m.encodeUtf8(t)),new m.ByteBuffer(t)};m.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};m.xorBytes=function(t,e,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o,n};m.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};m.bytesToHex=function(t){return m.createBuffer(t).toHex()};m.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var ur="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",hr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],nf="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";m.encode64=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.length;)i=t.charCodeAt(a++),o=t.charCodeAt(a++),s=t.charCodeAt(a++),r+=ur.charAt(i>>2),r+=ur.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=ur.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":ur.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};m.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,o,s=0;s<t.length;)r=hr[t.charCodeAt(s++)-43],n=hr[t.charCodeAt(s++)-43],i=hr[t.charCodeAt(s++)-43],o=hr[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(e+=String.fromCharCode((i&3)<<6|o)));return e};m.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};m.decodeUtf8=function(t){return decodeURIComponent(escape(t))};m.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:rf.encode,decode:rf.decode}};m.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};m.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};m.binary.hex.encode=m.bytesToHex;m.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,o=r;for(t.length&1&&(i=1,n[o++]=parseInt(t[0],16));i<t.length;i+=2)n[o++]=parseInt(t.substr(i,2),16);return e?o-r:n};m.binary.base64.encode=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.byteLength;)i=t[a++],o=t[a++],s=t[a++],r+=ur.charAt(i>>2),r+=ur.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=ur.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":ur.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};m.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,s,a,c=0,f=r;c<t.length;)i=hr[t.charCodeAt(c++)-43],o=hr[t.charCodeAt(c++)-43],s=hr[t.charCodeAt(c++)-43],a=hr[t.charCodeAt(c++)-43],n[f++]=i<<2|o>>4,s!==64&&(n[f++]=(o&15)<<4|s>>2,a!==64&&(n[f++]=(s&3)<<6|a));return e?f-r:n.subarray(0,f)};m.binary.base58.encode=function(t,e){return m.binary.baseN.encode(t,nf,e)};m.binary.base58.decode=function(t,e){return m.binary.baseN.decode(t,nf,e)};m.text={utf8:{},utf16:{}};m.text.utf8.encode=function(t,e,r){t=m.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};m.text.utf8.decode=function(t){return m.decodeUtf8(String.fromCharCode.apply(null,t))};m.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,s=r,a=0;a<t.length;++a)i[s++]=t.charCodeAt(a),o+=2;return e?o-r:n};m.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};m.deflate=function(t,e,r){if(e=m.decode64(t.deflate(m.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};m.inflate=function(t,e,r){var n=t.inflate(m.encode64(e)).rval;return n===null?null:m.decode64(n)};var Rs=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=m.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Ns=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(m.decode64(r))),r},fy=function(t,e,r,n){var i=Ns(t,e);i===null&&(i={}),i[r]=n,Rs(t,e,i)},uy=function(t,e,r){var n=Ns(t,e);return n!==null&&(n=r in n?n[r]:null),n},hy=function(t,e,r){var n=Ns(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),Rs(t,e,n)}},ly=function(t,e){Rs(t,e,null)},io=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,s=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),o=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),o=!0)}catch(c){s=c}if(o)break}if(!o)throw s;return n};m.setItem=function(t,e,r,n,i){io(fy,arguments,i)};m.getItem=function(t,e,r,n){return io(uy,arguments,n)};m.removeItem=function(t,e,r,n){io(hy,arguments,n)};m.clearItems=function(t,e,r){io(ly,arguments,r)};m.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};m.format=function(t){for(var e=/%./g,r,n,i=0,o=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&o.push(n),s=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(t.substring(s)),o.join("")};m.formatNumber=function(t,e,r,n){var i=t,o=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",u=f.length>3?f.length%3:0;return c+(u?f.substr(0,u)+a:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-f).toFixed(o).slice(2):"")};m.formatSize=function(t){return t>=1073741824?t=m.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=m.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=m.formatNumber(t/1024,0)+" KiB":t=m.formatNumber(t,0)+" bytes",t};m.bytesFromIP=function(t){return t.indexOf(".")!==-1?m.bytesFromIPv4(t):t.indexOf(":")!==-1?m.bytesFromIPv6(t):null};m.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=m.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};m.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=m.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=m.hexToBytes(t[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};m.bytesToIP=function(t){return t.length===4?m.bytesToIPv4(t):t.length===16?m.bytesToIPv6(t):null};m.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};m.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var o=m.bytesToHex(t[i]+t[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var s=r[r.length-1],a=e.length;!s||a!==s.end+1?r.push({start:a,end:a}):(s.end=a,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(o)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};m.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in m&&!t.update)return e(null,m.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return m.cores=navigator.hardwareConcurrency,e(null,m.cores);if(typeof Worker>"u")return m.cores=1,e(null,m.cores);if(typeof Blob>"u")return m.cores=2,e(null,m.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,a,c){if(a===0){var f=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return m.cores=Math.max(1,f),URL.revokeObjectURL(r),e(null,m.cores)}i(c,function(u,h){s.push(o(c,h)),n(s,a-1,c)})}function i(s,a){for(var c=[],f=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===s){for(var d=0;d<s;++d)c[d].terminate();a(null,f)}}),c.push(h)}for(var u=0;u<s;++u)c[u].postMessage(u)}function o(s,a){for(var c=[],f=0;f<s;++f)for(var u=a[f],h=c[f]=[],l=0;l<s;++l)if(f!==l){var d=a[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return c.reduce(function(p,y){return Math.max(p,y.length)},0)}}});var oo=Q((l8,sf)=>{var ti=yt();ti.pki=ti.pki||{};var Ds=sf.exports=ti.pki.oids=ti.oids=ti.oids||{};function _(t,e){Ds[t]=e,Ds[e]=t}function lt(t,e){Ds[t]=e}_("1.2.840.113549.1.1.1","rsaEncryption");_("1.2.840.113549.1.1.4","md5WithRSAEncryption");_("1.2.840.113549.1.1.5","sha1WithRSAEncryption");_("1.2.840.113549.1.1.7","RSAES-OAEP");_("1.2.840.113549.1.1.8","mgf1");_("1.2.840.113549.1.1.9","pSpecified");_("1.2.840.113549.1.1.10","RSASSA-PSS");_("1.2.840.113549.1.1.11","sha256WithRSAEncryption");_("1.2.840.113549.1.1.12","sha384WithRSAEncryption");_("1.2.840.113549.1.1.13","sha512WithRSAEncryption");_("1.3.101.112","EdDSA25519");_("1.2.840.10040.4.3","dsa-with-sha1");_("1.3.14.3.2.7","desCBC");_("1.3.14.3.2.26","sha1");_("1.3.14.3.2.29","sha1WithRSASignature");_("2.16.840.1.101.3.4.2.1","sha256");_("2.16.840.1.101.3.4.2.2","sha384");_("2.16.840.1.101.3.4.2.3","sha512");_("2.16.840.1.101.3.4.2.4","sha224");_("2.16.840.1.101.3.4.2.5","sha512-224");_("2.16.840.1.101.3.4.2.6","sha512-256");_("1.2.840.113549.2.2","md2");_("1.2.840.113549.2.5","md5");_("1.2.840.113549.1.7.1","data");_("1.2.840.113549.1.7.2","signedData");_("1.2.840.113549.1.7.3","envelopedData");_("1.2.840.113549.1.7.4","signedAndEnvelopedData");_("1.2.840.113549.1.7.5","digestedData");_("1.2.840.113549.1.7.6","encryptedData");_("1.2.840.113549.1.9.1","emailAddress");_("1.2.840.113549.1.9.2","unstructuredName");_("1.2.840.113549.1.9.3","contentType");_("1.2.840.113549.1.9.4","messageDigest");_("1.2.840.113549.1.9.5","signingTime");_("1.2.840.113549.1.9.6","counterSignature");_("1.2.840.113549.1.9.7","challengePassword");_("1.2.840.113549.1.9.8","unstructuredAddress");_("1.2.840.113549.1.9.14","extensionRequest");_("1.2.840.113549.1.9.20","friendlyName");_("1.2.840.113549.1.9.21","localKeyId");_("1.2.840.113549.1.9.22.1","x509Certificate");_("1.2.840.113549.1.12.10.1.1","keyBag");_("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");_("1.2.840.113549.1.12.10.1.3","certBag");_("1.2.840.113549.1.12.10.1.4","crlBag");_("1.2.840.113549.1.12.10.1.5","secretBag");_("1.2.840.113549.1.12.10.1.6","safeContentsBag");_("1.2.840.113549.1.5.13","pkcs5PBES2");_("1.2.840.113549.1.5.12","pkcs5PBKDF2");_("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");_("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");_("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");_("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");_("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");_("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");_("1.2.840.113549.2.7","hmacWithSHA1");_("1.2.840.113549.2.8","hmacWithSHA224");_("1.2.840.113549.2.9","hmacWithSHA256");_("1.2.840.113549.2.10","hmacWithSHA384");_("1.2.840.113549.2.11","hmacWithSHA512");_("1.2.840.113549.3.7","des-EDE3-CBC");_("2.16.840.1.101.3.4.1.2","aes128-CBC");_("2.16.840.1.101.3.4.1.22","aes192-CBC");_("2.16.840.1.101.3.4.1.42","aes256-CBC");_("2.5.4.3","commonName");_("2.5.4.4","surname");_("2.5.4.5","serialNumber");_("2.5.4.6","countryName");_("2.5.4.7","localityName");_("2.5.4.8","stateOrProvinceName");_("2.5.4.9","streetAddress");_("2.5.4.10","organizationName");_("2.5.4.11","organizationalUnitName");_("2.5.4.12","title");_("2.5.4.13","description");_("2.5.4.15","businessCategory");_("2.5.4.17","postalCode");_("2.5.4.42","givenName");_("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");_("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");_("2.16.840.1.113730.1.1","nsCertType");_("2.16.840.1.113730.1.13","nsComment");lt("2.5.29.1","authorityKeyIdentifier");lt("2.5.29.2","keyAttributes");lt("2.5.29.3","certificatePolicies");lt("2.5.29.4","keyUsageRestriction");lt("2.5.29.5","policyMapping");lt("2.5.29.6","subtreesConstraint");lt("2.5.29.7","subjectAltName");lt("2.5.29.8","issuerAltName");lt("2.5.29.9","subjectDirectoryAttributes");lt("2.5.29.10","basicConstraints");lt("2.5.29.11","nameConstraints");lt("2.5.29.12","policyConstraints");lt("2.5.29.13","basicConstraints");_("2.5.29.14","subjectKeyIdentifier");_("2.5.29.15","keyUsage");lt("2.5.29.16","privateKeyUsagePeriod");_("2.5.29.17","subjectAltName");_("2.5.29.18","issuerAltName");_("2.5.29.19","basicConstraints");lt("2.5.29.20","cRLNumber");lt("2.5.29.21","cRLReason");lt("2.5.29.22","expirationDate");lt("2.5.29.23","instructionCode");lt("2.5.29.24","invalidityDate");lt("2.5.29.25","cRLDistributionPoints");lt("2.5.29.26","issuingDistributionPoint");lt("2.5.29.27","deltaCRLIndicator");lt("2.5.29.28","issuingDistributionPoint");lt("2.5.29.29","certificateIssuer");lt("2.5.29.30","nameConstraints");_("2.5.29.31","cRLDistributionPoints");_("2.5.29.32","certificatePolicies");lt("2.5.29.33","policyMappings");lt("2.5.29.34","policyConstraints");_("2.5.29.35","authorityKeyIdentifier");lt("2.5.29.36","policyConstraints");_("2.5.29.37","extKeyUsage");lt("2.5.29.46","freshestCRL");lt("2.5.29.54","inhibitAnyPolicy");_("1.3.6.1.4.1.11129.2.4.2","timestampList");_("1.3.6.1.5.5.7.1.1","authorityInfoAccess");_("1.3.6.1.5.5.7.3.1","serverAuth");_("1.3.6.1.5.5.7.3.2","clientAuth");_("1.3.6.1.5.5.7.3.3","codeSigning");_("1.3.6.1.5.5.7.3.4","emailProtection");_("1.3.6.1.5.5.7.3.8","timeStamping")});var ri=Q((p8,cf)=>{var mt=yt();kt();oo();var P=cf.exports=mt.asn1=mt.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(mt.util.isArray(n)){for(var o=[],s=0;s<n.length;++s)n[s]!==void 0&&o.push(n[s]);n=o}var a={tagClass:t,type:e,constructed:r,composed:r||mt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=P.copy(a)),a};P.copy=function(t,e){var r;if(mt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(mt.util.isArray(t)){if(!mt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function ei(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var py=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;ei(t,e,o),n=t.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=mt.util.createBuffer(t));var r=t.length(),n=so(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function so(t,e,r,n){var i;ei(t,e,2);var o=t.getByte();e--;var s=o&192,a=o&31;i=t.length();var c=py(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=t.length(),f.remaining=e,f.requested=c,f}c=e}var u,h,l=(o&32)===32;if(l)if(u=[],c===void 0)for(;;){if(ei(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(so(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),u.push(so(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(u===void 0&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&(h=t.bytes(c)),u===void 0&&n.decodeBitStrings&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&c>1){var d=t.read,p=e,y=0;if(a===P.Type.BITSTRING&&(ei(t,e,1),y=t.getByte(),e--),y===0)try{i=t.length();var g={strict:!0,decodeBitStrings:!0},x=so(t,e,r+1,g),E=i-t.length();e-=E,a==P.Type.BITSTRING&&E++;var b=x.tagClass;E===c&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[x])}catch{}u===void 0&&(t.read=d,e=p)}if(u===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===P.Type.BMPSTRING)for(u="";c>0;c-=2)ei(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(c),e-=c}var A=h===void 0?null:{bitStringContents:h};return P.create(s,a,l,u,A)}P.toDer=function(t){var e=mt.util.createBuffer(),r=t.tagClass|t.type,n=mt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var o=0;o<t.value.length;++o)t.value[o]!==void 0&&n.putBuffer(P.toDer(t.value[o]))}else if(t.type===P.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)n.putInt16(t.value.charCodeAt(o));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),a="";do a+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)e.putByte(a.charCodeAt(o))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=mt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,o,s,a=2;a<e.length;++a){n=!0,i=[],o=parseInt(e[a],10);do s=o&127,o=o>>>7,n||(s|=128),i.push(s),n=!1;while(o>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=mt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),f=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),f+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,0),f&&(c=t.charAt(f),c==="+"||c==="-")){var u=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10),l=u*60+h;l*=6e4,c==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,f=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);f=d*60+p,f*=6e4,l==="+"&&(f*=-1),u=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,c),e.setTime(+e+f)):(e.setFullYear(r,n,i),e.setHours(o,s,a,c)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=mt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=mt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&mt.util.isArray(e.value))for(var o=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[o]&&(i=P.validate(t.value[o],e.value[s],r,n),i?++o:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var af=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",o=0;o<e*r;++o)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,a="",o=0;o<t.value.length;++o)t.value[o]!==void 0&&(s+=1,a+=P.prettyPrint(t.value[o],e+1,r),o+1<t.value.length&&(a+=","));n+=i+"Sub values: "+s+a}else{if(n+=i+"Value: ",t.type===P.Type.OID){var c=P.derToOid(t.value);n+=c,mt.pki&&mt.pki.oids&&c in mt.pki.oids&&(n+=" ("+mt.pki.oids[c]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+mt.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+mt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var f=t.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)af.test(t.value)||(n+="("+t.value+") "),n+="0x"+mt.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=mt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+mt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:af.test(t.value)?n+="0x"+mt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var ks=Q((d8,ff)=>{var Ft=yt();kt();ff.exports=Ft.cipher=Ft.cipher||{};Ft.cipher.algorithms=Ft.cipher.algorithms||{};Ft.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ft.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ft.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Ft.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ft.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ft.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Ft.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Ft.cipher.algorithms[t]=e};Ft.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Ft.cipher.algorithms?Ft.cipher.algorithms[t]:null};var Us=Ft.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Us.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Ft.util.createBuffer(),this.output=t.output||Ft.util.createBuffer(),this.mode.start(e)};Us.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Us.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Ks=Q((y8,uf)=>{var Ht=yt();kt();Ht.cipher=Ht.cipher||{};var rt=uf.exports=Ht.cipher.modes=Ht.cipher.modes||{};rt.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};rt.ecb.prototype.start=function(t){};rt.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};rt.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};rt.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};rt.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};rt.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};rt.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=ao(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};rt.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};rt.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};rt.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};rt.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};rt.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ht.util.createBuffer(),this._partialBytes=0};rt.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=ao(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};rt.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};rt.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};rt.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ht.util.createBuffer(),this._partialBytes=0};rt.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=ao(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};rt.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};rt.ofb.prototype.decrypt=rt.ofb.prototype.encrypt;rt.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ht.util.createBuffer(),this._partialBytes=0};rt.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=ao(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};rt.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}co(this._inBlock)};rt.ctr.prototype.decrypt=rt.ctr.prototype.encrypt;rt.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ht.util.createBuffer(),this._partialBytes=0,this._R=3774873600};rt.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Ht.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Ht.util.createBuffer(t.additionalData):r=Ht.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Ht.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ps(n*8)))}this._inBlock=this._j0.slice(0),co(this._inBlock),this._partialBytes=0,r=Ht.util.createBuffer(r),this._aDataLength=Ps(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};rt.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),co(this._inBlock)};rt.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),co(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};rt.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Ht.util.createBuffer();var n=this._aDataLength.concat(Ps(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};rt.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var o=t[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};rt.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};rt.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,o=this._m[r][i];e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3]}return e};rt.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};rt.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],c=s/n|0,f=(n-1-s%n)*e;a[c]=1<<e-1<<f,o[s]=this.generateSubHashTable(this.multiply(a,t),e)}return o};rt.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],c=i[s];i[o+s]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var f=i[o^n];i[o]=[t[0]^f[0],t[1]^f[1],t[2]^f[2],t[3]^f[3]]}return i};function ao(t,e){if(typeof t=="string"&&(t=Ht.util.createBuffer(t)),Ht.util.isArray(t)&&t.length>4){var r=t;t=Ht.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Ht.util.isArray(t)){for(var i=[],o=e/4,n=0;n<o;++n)i.push(t.getInt32());t=i}return t}function co(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Ps(t){return[t/4294967296|0,t&4294967295]}});var Hs=Q((g8,df)=>{var gt=yt();ks();Ks();kt();df.exports=gt.aes=gt.aes||{};gt.aes.startEncrypting=function(t,e,r,n){var i=fo({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};gt.aes.createEncryptionCipher=function(t,e){return fo({key:t,output:null,decrypt:!1,mode:e})};gt.aes.startDecrypting=function(t,e,r,n){var i=fo({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};gt.aes.createDecryptionCipher=function(t,e){return fo({key:t,output:null,decrypt:!0,mode:e})};gt.aes.Algorithm=function(t,e){Fs||lf();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Ms(r._w,n,i,!1)},decrypt:function(n,i){return Ms(r._w,n,i,!0)}}}),r._init=!1};gt.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=gt.util.createBuffer(e);else if(gt.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=gt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!gt.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!gt.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=pf(e,t.decrypt&&!s),this._init=!0}};gt.aes._expandKey=function(t,e){return Fs||lf(),pf(t,e)};gt.aes._updateBlock=Ms;cn("AES-ECB",gt.cipher.modes.ecb);cn("AES-CBC",gt.cipher.modes.cbc);cn("AES-CFB",gt.cipher.modes.cfb);cn("AES-OFB",gt.cipher.modes.ofb);cn("AES-CTR",gt.cipher.modes.ctr);cn("AES-GCM",gt.cipher.modes.gcm);function cn(t,e){var r=function(){return new gt.aes.Algorithm(t,e)};gt.cipher.registerAlgorithm(t,r)}var Fs=!1,an=4,Qt,Os,hf,Rr,ve;function lf(){Fs=!0,hf=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Qt=new Array(256),Os=new Array(256),Rr=new Array(4),ve=new Array(4);for(var e=0;e<4;++e)Rr[e]=new Array(256),ve[e]=new Array(256);for(var r=0,n=0,i,o,s,a,c,f,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Qt[r]=a,Os[a]=r,c=t[a],i=t[r],o=t[i],s=t[o],f=c<<24^a<<16^a<<8^(a^c),u=(i^o^s)<<24^(r^s)<<16^(r^o^s)<<8^(r^i^s);for(var h=0;h<4;++h)Rr[h][r]=f,ve[h][a]=u,f=f<<24|f>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function pf(t,e){for(var r=t.slice(0),n,i=1,o=r.length,s=o+6+1,a=an*s,c=o;c<a;++c)n=r[c-1],c%o===0?(n=Qt[n>>>16&255]<<24^Qt[n>>>8&255]<<16^Qt[n&255]<<8^Qt[n>>>24]^hf[i]<<24,i++):o>6&&c%o===4&&(n=Qt[n>>>24]<<24^Qt[n>>>16&255]<<16^Qt[n>>>8&255]<<8^Qt[n&255]),r[c]=r[c-o]^n;if(e){var f,u=ve[0],h=ve[1],l=ve[2],d=ve[3],p=r.slice(0);a=r.length;for(var c=0,y=a-an;c<a;c+=an,y-=an)if(c===0||c===a-an)p[c]=r[y],p[c+1]=r[y+3],p[c+2]=r[y+2],p[c+3]=r[y+1];else for(var g=0;g<an;++g)f=r[y+g],p[c+(3&-g)]=u[Qt[f>>>24]]^h[Qt[f>>>16&255]]^l[Qt[f>>>8&255]]^d[Qt[f&255]];r=p}return r}function Ms(t,e,r,n){var i=t.length/4-1,o,s,a,c,f;n?(o=ve[0],s=ve[1],a=ve[2],c=ve[3],f=Os):(o=Rr[0],s=Rr[1],a=Rr[2],c=Rr[3],f=Qt);var u,h,l,d,p,y,g;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var x=3,E=1;E<i;++E)p=o[u>>>24]^s[h>>>16&255]^a[l>>>8&255]^c[d&255]^t[++x],y=o[h>>>24]^s[l>>>16&255]^a[d>>>8&255]^c[u&255]^t[++x],g=o[l>>>24]^s[d>>>16&255]^a[u>>>8&255]^c[h&255]^t[++x],d=o[d>>>24]^s[u>>>16&255]^a[h>>>8&255]^c[l&255]^t[++x],u=p,h=y,l=g;r[0]=f[u>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[d&255]^t[++x],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[d>>>8&255]<<8^f[u&255]^t[++x],r[2]=f[l>>>24]<<24^f[d>>>16&255]<<16^f[u>>>8&255]<<8^f[h&255]^t[++x],r[n?1:3]=f[d>>>24]<<24^f[u>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^t[++x]}function fo(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=gt.cipher.createDecipher(r,t.key):n=gt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof gt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var xf=Q((x8,gf)=>{var Et=yt();ks();Ks();kt();gf.exports=Et.des=Et.des||{};Et.des.startEncrypting=function(t,e,r,n){var i=uo({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Et.des.createEncryptionCipher=function(t,e){return uo({key:t,output:null,decrypt:!1,mode:e})};Et.des.startDecrypting=function(t,e,r,n){var i=uo({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Et.des.createDecryptionCipher=function(t,e){return uo({key:t,output:null,decrypt:!0,mode:e})};Et.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return yf(r._keys,n,i,!1)},decrypt:function(n,i){return yf(r._keys,n,i,!0)}}}),r._init=!1};Et.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=Et.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Ey(e),this._init=!0}};Le("DES-ECB",Et.cipher.modes.ecb);Le("DES-CBC",Et.cipher.modes.cbc);Le("DES-CFB",Et.cipher.modes.cfb);Le("DES-OFB",Et.cipher.modes.ofb);Le("DES-CTR",Et.cipher.modes.ctr);Le("3DES-ECB",Et.cipher.modes.ecb);Le("3DES-CBC",Et.cipher.modes.cbc);Le("3DES-CFB",Et.cipher.modes.cfb);Le("3DES-OFB",Et.cipher.modes.ofb);Le("3DES-CTR",Et.cipher.modes.ctr);function Le(t,e){var r=function(){return new Et.des.Algorithm(t,e)};Et.cipher.registerAlgorithm(t,r)}var dy=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],yy=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],gy=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],xy=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],my=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],by=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],wy=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],vy=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Ey(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=t.length()>8?3:1,g=[],x=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,A=0;A<y;A++){var v=t.getInt32(),B=t.getInt32();b=(v>>>4^B)&252645135,B^=b,v^=b<<4,b=(B>>>-16^v)&65535,v^=b,B^=b<<-16,b=(v>>>2^B)&858993459,B^=b,v^=b<<2,b=(B>>>-16^v)&65535,v^=b,B^=b<<-16,b=(v>>>1^B)&1431655765,B^=b,v^=b<<1,b=(B>>>8^v)&16711935,v^=b,B^=b<<8,b=(v>>>1^B)&1431655765,B^=b,v^=b<<1,b=v<<8|B>>>20&240,v=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=b;for(var D=0;D<x.length;++D){x[D]?(v=v<<2|v>>>26,B=B<<2|B>>>26):(v=v<<1|v>>>27,B=B<<1|B>>>27),v&=-15,B&=-15;var L=e[v>>>28]|r[v>>>24&15]|n[v>>>20&15]|i[v>>>16&15]|o[v>>>12&15]|s[v>>>8&15]|a[v>>>4&15],R=c[B>>>28]|f[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|l[B>>>12&15]|d[B>>>8&15]|p[B>>>4&15];b=(R>>>16^L)&65535,g[E++]=L^b,g[E++]=R^b<<16}}return g}function yf(t,e,r,n){var i=t.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,a=e[0],c=e[1];s=(a>>>4^c)&252645135,c^=s,a^=s<<4,s=(a>>>16^c)&65535,c^=s,a^=s<<16,s=(c>>>2^a)&858993459,a^=s,c^=s<<2,s=(c>>>8^a)&16711935,a^=s,c^=s<<8,s=(a>>>1^c)&1431655765,c^=s,a^=s<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var f=0;f<i;f+=3){for(var u=o[f+1],h=o[f+2],l=o[f];l!=u;l+=h){var d=c^t[l],p=(c>>>4|c<<28)^t[l+1];s=a,a=c,c=s^(yy[d>>>24&63]|xy[d>>>16&63]|by[d>>>8&63]|vy[d&63]|dy[p>>>24&63]|gy[p>>>16&63]|my[p>>>8&63]|wy[p&63])}s=a,a=c,c=s}a=a>>>1|a<<31,c=c>>>1|c<<31,s=(a>>>1^c)&1431655765,c^=s,a^=s<<1,s=(c>>>8^a)&16711935,a^=s,c^=s<<8,s=(c>>>2^a)&858993459,a^=s,c^=s<<2,s=(a>>>16^c)&65535,c^=s,a^=s<<16,s=(a>>>4^c)&252645135,c^=s,a^=s<<4,r[0]=a,r[1]=c}function uo(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=Et.cipher.createDecipher(r,t.key):n=Et.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof Et.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var Nr=Q((m8,mf)=>{var ho=yt();mf.exports=ho.md=ho.md||{};ho.md.algorithms=ho.md.algorithms||{}});var wf=Q((b8,bf)=>{var Ze=yt();Nr();kt();var Sy=bf.exports=Ze.hmac=Ze.hmac||{};Sy.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(o,s){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in Ze.md.algorithms)e=Ze.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else e=o;if(s===null)s=t;else{if(typeof s=="string")s=Ze.util.createBuffer(s);else if(Ze.util.isArray(s)){var a=s;s=Ze.util.createBuffer();for(var c=0;c<a.length;++c)s.putByte(a[c])}var f=s.length();f>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=Ze.util.createBuffer(),n=Ze.util.createBuffer(),f=s.length();for(var c=0;c<f;++c){var a=s.at(c);r.putByte(54^a),n.putByte(92^a)}if(f<e.blockLength)for(var a=e.blockLength-f,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(o){e.update(o)},i.getMac=function(){var o=e.digest().bytes();return e.start(),e.update(n),e.update(o),e.digest()},i.digest=i.getMac,i}});var fn=Q(()=>{});var Ef=Q((E8,vf)=>{var Jt=yt();wf();Nr();kt();var By=Jt.pkcs5=Jt.pkcs5||{},Ye;Jt.util.isNodejs&&!Jt.options.usePureJavaScript&&(Ye=fn());vf.exports=Jt.pbkdf2=By.pbkdf2=function(t,e,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),Jt.util.isNodejs&&!Jt.options.usePureJavaScript&&Ye.pbkdf2&&(i===null||typeof i!="object")&&(Ye.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?Ye.pbkdf2Sync.length===4?Ye.pbkdf2(t,e,r,n,function(b,A){if(b)return o(b);o(null,A.toString("binary"))}):Ye.pbkdf2(t,e,r,n,i,function(b,A){if(b)return o(b);o(null,A.toString("binary"))}):Ye.pbkdf2Sync.length===4?Ye.pbkdf2Sync(t,e,r,n).toString("binary"):Ye.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Jt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Jt.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var a=new Error("Derived key is too long.");if(o)return o(a);throw a}var c=Math.ceil(n/s),f=n-(c-1)*s,u=Jt.hmac.create();u.start(i,t);var h="",l,d,p;if(!o){for(var y=1;y<=c;++y){u.start(null,null),u.update(e),u.update(Jt.util.int32ToBytes(y)),l=p=u.digest().getBytes();for(var g=2;g<=r;++g)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Jt.util.xorBytes(l,d,s),p=d;h+=y<c?l:l.substr(0,f)}return h}var y=1,g;function x(){if(y>c)return o(null,h);u.start(null,null),u.update(e),u.update(Jt.util.int32ToBytes(y)),l=p=u.digest().getBytes(),g=2,E()}function E(){if(g<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Jt.util.xorBytes(l,d,s),p=d,++g,Jt.util.setImmediate(E);h+=y<c?l:l.substr(0,f),++y,x()}x()}});var Af=Q((S8,Bf)=>{var po=yt();kt();var Sf=Bf.exports=po.pem=po.pem||{};Sf.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=lo(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=lo(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=lo(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=lo(t.headers[i]);return t.procType&&(r+=`\r
`),r+=po.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Sf.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(t),!!o;){var s=o[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var a={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:po.util.decode64(o[3])};if(e.push(a),!!o[2]){for(var c=o[2].split(i),f=0;o&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;u+=l,f=h}if(o=u.match(n),o){for(var d={name:o[1],values:[]},p=o[2].split(","),y=0;y<p.length;++y)d.values.push(Ay(p[y]));if(a.procType)if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++f}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function lo(t){for(var e=t.name+": ",r=[],n=function(c,f){return" "+f},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var o=0,s=-1,i=0;i<e.length;++i,++o)if(o>65&&s!==-1){var a=e[s];a===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+a+e.substr(s+1),o=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Ay(t){return t.replace(/^\s+/,"")}});var Rf=Q((B8,Lf)=>{var Re=yt();Nr();kt();var If=Lf.exports=Re.sha256=Re.sha256||{};Re.md.sha256=Re.md.algorithms.sha256=If;If.create=function(){Tf||Cy();var t=null,e=Re.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=Re.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=Re.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Cf(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Re.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Vs.substr(0,n.blockLength-s));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Cf(h,r,i);var l=Re.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Vs=null,Tf=!1,_f=null;function Cy(){Vs=String.fromCharCode(128),Vs+=Re.util.fillString(String.fromCharCode(0),64),_f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Tf=!0}function Cf(t,e,r){for(var n,i,o,s,a,c,f,u,h,l,d,p,y,g,x,E=r.length();E>=64;){for(f=0;f<16;++f)e[f]=r.getInt32();for(;f<64;++f)n=e[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[f]=n+e[f-7]+i+e[f-16]|0;for(u=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,y=t.h5,g=t.h6,x=t.h7,f=0;f<64;++f)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=g^p&(y^g),o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|l&(u^h),n=x+s+a+_f[f]+e[f],i=o+c,x=g,g=y,y=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+y|0,t.h6=t.h6+g|0,t.h7=t.h7+x|0,E-=64}}});var Df=Q((A8,Nf)=>{var Ne=yt();kt();var yo=null;Ne.util.isNodejs&&!Ne.options.usePureJavaScript&&!process.versions["node-webkit"]&&(yo=fn());var Iy=Nf.exports=Ne.prng=Ne.prng||{};Iy.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(f,u){if(!u)return e.generateSync(f);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,y=Ne.util.createBuffer();e.key=null,g();function g(x){if(x)return u(x);if(y.length()>=f)return u(null,y.getBytes(f));if(e.generated>1048575&&(e.key=null),e.key===null)return Ne.util.nextTick(function(){o(g)});var E=h(e.key,e.seed);e.generated+=E.length,y.putBytes(E),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),Ne.util.setImmediate(g)}},e.generateSync=function(f){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=Ne.util.createBuffer();p.length()<f;){e.generated>1048575&&(e.key=null),e.key===null&&s();var y=u(e.key,e.seed);e.generated+=y.length,p.putBytes(y),e.key=l(u(e.key,h(e.seed))),e.seed=d(u(e.key,e.seed))}return p.getBytes(f)};function o(f){if(e.pools[0].messageLength>=32)return a(),f();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return f(h);e.collect(l),a(),f()})}function s(){if(e.pools[0].messageLength>=32)return a();var f=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(f)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var f=e.plugin.md.create();f.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(f.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=f.digest().getBytes(),f.start(),f.update(e.keyBytes);var l=f.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function c(f){var u=null,h=Ne.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(v){return l.getRandomValues(v)});var d=Ne.util.createBuffer();if(u)for(;d.length()<f;){var p=Math.max(1,Math.min(f-d.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{u(y);for(var g=0;g<y.length;++g)d.putInt32(y[g])}catch(v){if(!(typeof QuotaExceededError<"u"&&v instanceof QuotaExceededError))throw v}}if(d.length()<f)for(var x,E,b,A=Math.floor(Math.random()*65536);d.length()<f;){E=16807*(A&65535),x=16807*(A>>16),E+=(x&32767)<<16,E+=x>>15,E=(E&2147483647)+(E>>31),A=E&4294967295;for(var g=0;g<3;++g)b=A>>>(g<<3),b^=Math.floor(Math.random()*256),d.putByte(b&255)}return d.getBytes(f)}return yo?(e.seedFile=function(f,u){yo.randomBytes(f,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(f){return yo.randomBytes(f).toString()}):(e.seedFile=function(f,u){try{u(null,c(f))}catch(h){u(h)}},e.seedFileSync=c),e.collect=function(f){for(var u=f.length,h=0;h<u;++h)e.pools[e.pool].update(f.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(f,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(f>>l&255);e.collect(h)},e.registerWorker=function(f){if(f===self)e.seedFile=function(h,l){function d(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",d),l(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){f.postMessage({forge:{prng:{err:d,bytes:p}}})})};f.addEventListener("message",u)}},e}});var ni=Q((C8,qs)=>{var Vt=yt();Hs();Rf();Df();kt();(function(){if(Vt.random&&Vt.random.getBytes){qs.exports=Vt.random;return}(function(t){var e={},r=new Array(4),n=Vt.util.createBuffer();e.formatKey=function(h){var l=Vt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Vt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Vt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Vt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Vt.md.sha256;function i(){var h=Vt.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var o=i(),s=null,a=Vt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(s=function(h){return c.getRandomValues(h)}),Vt.options.usePureJavaScript||!Vt.util.isNodejs&&!s){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var u in navigator)try{typeof navigator[u]=="string"&&(f+=navigator[u])}catch{}o.collect(f),f=null}t&&(t().mousemove(function(h){o.collectInt(h.clientX,16),o.collectInt(h.clientY,16)}),t().keypress(function(h){o.collectInt(h.charCode,8)}))}if(!Vt.random)Vt.random=o;else for(var u in o)Vt.random[u]=o[u];Vt.random.createInstance=i,qs.exports=Vt.random})(typeof jQuery<"u"?jQuery:null)})()});var Kf=Q((I8,Pf)=>{var re=yt();kt();var zs=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Uf=[1,2,3,5],Ty=function(t,e){return t<<e&65535|(t&65535)>>16-e},_y=function(t,e){return(t&65535)>>e|t<<16-e&65535};Pf.exports=re.rc2=re.rc2||{};re.rc2.expandKey=function(t,e){typeof t=="string"&&(t=re.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,o=Math.ceil(i/8),s=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(zs[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-o,zs[r.at(128-o)&s]),a=127-o;a>=0;a--)r.setAt(a,zs[r.at(a+1)^r.at(a+o)]);return r};var kf=function(t,e,r){var n=!1,i=null,o=null,s=null,a,c,f,u,h=[];for(t=re.rc2.expandKey(t,e),f=0;f<64;f++)h.push(t.getInt16Le());r?(a=function(p){for(f=0;f<4;f++)p[f]+=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),p[f]=Ty(p[f],Uf[f]),u++},c=function(p){for(f=0;f<4;f++)p[f]+=h[p[(f+3)%4]&63]}):(a=function(p){for(f=3;f>=0;f--)p[f]=_y(p[f],Uf[f]),p[f]-=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),u--},c=function(p){for(f=3;f>=0;f--)p[f]-=h[p[(f+3)%4]&63]});var l=function(p){var y=[];for(f=0;f<4;f++){var g=i.getInt16Le();s!==null&&(r?g^=s.getInt16Le():s.putInt16Le(g)),y.push(g&65535)}u=r?0:63;for(var x=0;x<p.length;x++)for(var E=0;E<p[x][0];E++)p[x][1](y);for(f=0;f<4;f++)s!==null&&(r?s.putInt16Le(y[f]):y[f]^=s.getInt16Le()),o.putInt16Le(y[f])},d=null;return d={start:function(p,y){p&&typeof p=="string"&&(p=re.util.createBuffer(p)),n=!1,i=re.util.createBuffer(),o=y||new re.util.createBuffer,s=p,d.output=o},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,i,!r);else{var g=i.length()===8?8:8-i.length();i.fillWithByte(g,g)}if(y&&(n=!0,d.update()),!r&&(y=i.length()===0,y))if(p)y=p(8,o,!r);else{var x=o.length(),E=o.at(x-1);E>x?y=!1:o.truncate(E)}return y}},d};re.rc2.startEncrypting=function(t,e,r){var n=re.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};re.rc2.createEncryptionCipher=function(t,e){return kf(t,e,!0)};re.rc2.startDecrypting=function(t,e,r){var n=re.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};re.rc2.createDecryptionCipher=function(t,e){return kf(t,e,!1)}});var mo=Q((T8,Gf)=>{var Gs=yt();Gf.exports=Gs.jsbn=Gs.jsbn||{};var Xe,Ly=0xdeadbeefcafe,Of=(Ly&16777215)==15715070;function I(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Gs.jsbn.BigInteger=I;function ft(){return new I(null)}function Ry(t,e,r,n,i,o){for(;--o>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Ny(t,e,r,n,i,o){for(var s=e&32767,a=e>>15;--o>=0;){var c=this.data[t]&32767,f=this.data[t++]>>15,u=a*c+f*s;c=s*c+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(u>>>15)+a*f+(i>>>30),r.data[n++]=c&1073741823}return i}function Mf(t,e,r,n,i,o){for(var s=e&16383,a=e>>14;--o>=0;){var c=this.data[t]&16383,f=this.data[t++]>>14,u=a*c+f*s;c=s*c+((u&16383)<<14)+r.data[n]+i,i=(c>>28)+(u>>14)+a*f,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(I.prototype.am=Mf,Xe=28):Of&&navigator.appName=="Microsoft Internet Explorer"?(I.prototype.am=Ny,Xe=30):Of&&navigator.appName!="Netscape"?(I.prototype.am=Ry,Xe=26):(I.prototype.am=Mf,Xe=28);I.prototype.DB=Xe;I.prototype.DM=(1<<Xe)-1;I.prototype.DV=1<<Xe;var $s=52;I.prototype.FV=Math.pow(2,$s);I.prototype.F1=$s-Xe;I.prototype.F2=2*Xe-$s;var Dy="0123456789abcdefghijklmnopqrstuvwxyz",go=new Array,un,pe;un="0".charCodeAt(0);for(pe=0;pe<=9;++pe)go[un++]=pe;un="a".charCodeAt(0);for(pe=10;pe<36;++pe)go[un++]=pe;un="A".charCodeAt(0);for(pe=10;pe<36;++pe)go[un++]=pe;function Ff(t){return Dy.charAt(t)}function Hf(t,e){var r=go[t.charCodeAt(e)];return r??-1}function Uy(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function ky(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function lr(t){var e=ft();return e.fromInt(t),e}function Py(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=r==8?t[n]&255:Hf(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&t[0]&128&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&I.ZERO.subTo(this,this)}function Ky(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Oy(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=Ff(n));s>=0;)a<e?(n=(this.data[s]&(1<<a)-1)<<e-a,n|=this.data[--s]>>(a+=this.DB-e)):(n=this.data[s]>>(a-=e)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=Ff(n));return i?o:"0"}function My(){var t=ft();return I.ZERO.subTo(this,t),t}function Fy(){return this.s<0?this.negate():this}function Hy(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function xo(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Vy(){return this.t<=0?0:this.DB*(this.t-1)+xo(this.data[this.t-1]^this.s&this.DM)}function qy(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function zy(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Gy(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(t/this.DB),s=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+o+1]=this.data[a]>>n|s,s=(this.data[a]&i)<<r;for(a=o-1;a>=0;--a)e.data[a]=0;e.data[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function $y(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&o)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function Wy(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Zy(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&I.ZERO.subTo(e,e)}function Yy(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Xy(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ft());var o=ft(),s=this.s,a=t.s,c=this.DB-xo(n.data[n.t-1]);c>0?(n.lShiftTo(c,o),i.lShiftTo(c,r)):(n.copyTo(o),i.copyTo(r));var f=o.t,u=o.data[f-1];if(u!=0){var h=u*(1<<this.F1)+(f>1?o.data[f-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,y=r.t,g=y-f,x=e??ft();for(o.dlShiftTo(g,x),r.compareTo(x)>=0&&(r.data[r.t++]=1,r.subTo(x,r)),I.ONE.dlShiftTo(f,x),x.subTo(o,o);o.t<f;)o.data[o.t++]=0;for(;--g>=0;){var E=r.data[--y]==u?this.DM:Math.floor(r.data[y]*l+(r.data[y-1]+p)*d);if((r.data[y]+=o.am(0,E,r,g,0,f))<E)for(o.dlShiftTo(g,x),r.subTo(x,r);r.data[y]<--E;)r.subTo(x,r)}e!=null&&(r.drShiftTo(f,e),s!=a&&I.ZERO.subTo(e,e)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),s<0&&I.ZERO.subTo(r,r)}}}function Qy(t){var e=ft();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(I.ZERO)>0&&t.subTo(e,e),e}function Dr(t){this.m=t}function Jy(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function jy(t){return t}function t1(t){t.divRemTo(this.m,null,t)}function e1(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function r1(t,e){t.squareTo(e),this.reduce(e)}Dr.prototype.convert=Jy;Dr.prototype.revert=jy;Dr.prototype.reduce=t1;Dr.prototype.mulTo=e1;Dr.prototype.sqrTo=r1;function n1(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Ur(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function i1(t){var e=ft();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(I.ZERO)>0&&this.m.subTo(e,e),e}function o1(t){var e=ft();return t.copyTo(e),this.reduce(e),e}function s1(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function a1(t,e){t.squareTo(e),this.reduce(e)}function c1(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Ur.prototype.convert=i1;Ur.prototype.revert=o1;Ur.prototype.reduce=s1;Ur.prototype.mulTo=c1;Ur.prototype.sqrTo=a1;function f1(){return(this.t>0?this.data[0]&1:this.s)==0}function u1(t,e){if(t>4294967295||t<1)return I.ONE;var r=ft(),n=ft(),i=e.convert(this),o=xo(t)-1;for(i.copyTo(r);--o>=0;)if(e.sqrTo(r,n),(t&1<<o)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function h1(t,e){var r;return t<256||e.isEven()?r=new Dr(e):r=new Ur(e),this.exp(t,r)}I.prototype.copyTo=Uy;I.prototype.fromInt=ky;I.prototype.fromString=Py;I.prototype.clamp=Ky;I.prototype.dlShiftTo=qy;I.prototype.drShiftTo=zy;I.prototype.lShiftTo=Gy;I.prototype.rShiftTo=$y;I.prototype.subTo=Wy;I.prototype.multiplyTo=Zy;I.prototype.squareTo=Yy;I.prototype.divRemTo=Xy;I.prototype.invDigit=n1;I.prototype.isEven=f1;I.prototype.exp=u1;I.prototype.toString=Oy;I.prototype.negate=My;I.prototype.abs=Fy;I.prototype.compareTo=Hy;I.prototype.bitLength=Vy;I.prototype.mod=Qy;I.prototype.modPowInt=h1;I.ZERO=lr(0);I.ONE=lr(1);function l1(){var t=ft();return this.copyTo(t),t}function p1(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function d1(){return this.t==0?this.s:this.data[0]<<24>>24}function y1(){return this.t==0?this.s:this.data[0]<<16>>16}function g1(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function x1(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function m1(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=lr(r),i=ft(),o=ft(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function b1(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,o=0,s=0,a=0;a<t.length;++a){var c=Hf(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+c,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),i&&I.ZERO.subTo(this,this)}function w1(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(I.ONE.shiftLeft(t-1),Ws,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(I.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function v1(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function E1(t){return this.compareTo(t)==0}function S1(t){return this.compareTo(t)<0?this:t}function B1(t){return this.compareTo(t)>0?this:t}function A1(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function C1(t,e){return t&e}function I1(t){var e=ft();return this.bitwiseTo(t,C1,e),e}function Ws(t,e){return t|e}function T1(t){var e=ft();return this.bitwiseTo(t,Ws,e),e}function Vf(t,e){return t^e}function _1(t){var e=ft();return this.bitwiseTo(t,Vf,e),e}function qf(t,e){return t&~e}function L1(t){var e=ft();return this.bitwiseTo(t,qf,e),e}function R1(){for(var t=ft(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function N1(t){var e=ft();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function D1(t){var e=ft();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function U1(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function k1(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+U1(this.data[t]);return this.s<0?this.t*this.DB:-1}function P1(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function K1(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=P1(this.data[r]^e);return t}function O1(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function M1(t,e){var r=I.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function F1(t){return this.changeBit(t,Ws)}function H1(t){return this.changeBit(t,qf)}function V1(t){return this.changeBit(t,Vf)}function q1(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function z1(t){var e=ft();return this.addTo(t,e),e}function G1(t){var e=ft();return this.subTo(t,e),e}function $1(t){var e=ft();return this.multiplyTo(t,e),e}function W1(t){var e=ft();return this.divRemTo(t,e,null),e}function Z1(t){var e=ft();return this.divRemTo(t,null,e),e}function Y1(t){var e=ft(),r=ft();return this.divRemTo(t,e,r),new Array(e,r)}function X1(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Q1(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function ii(){}function zf(t){return t}function J1(t,e,r){t.multiplyTo(e,r)}function j1(t,e){t.squareTo(e)}ii.prototype.convert=zf;ii.prototype.revert=zf;ii.prototype.mulTo=J1;ii.prototype.sqrTo=j1;function tg(t){return this.exp(t,new ii)}function eg(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function rg(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function hn(t){this.r2=ft(),this.q3=ft(),I.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function ng(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ft();return t.copyTo(e),this.reduce(e),e}function ig(t){return t}function og(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function sg(t,e){t.squareTo(e),this.reduce(e)}function ag(t,e,r){t.multiplyTo(e,r),this.reduce(r)}hn.prototype.convert=ng;hn.prototype.revert=ig;hn.prototype.reduce=og;hn.prototype.mulTo=ag;hn.prototype.sqrTo=sg;function cg(t,e){var r=t.bitLength(),n,i=lr(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new Dr(e):e.isEven()?o=new hn(e):o=new Ur(e);var s=new Array,a=3,c=n-1,f=(1<<n)-1;if(s[1]=o.convert(this),n>1){var u=ft();for(o.sqrTo(s[1],u);a<=f;)s[a]=ft(),o.mulTo(u,s[a-2],s[a]),a+=2}var h=t.t-1,l,d=!0,p=ft(),y;for(r=xo(t.data[h])-1;h>=0;){for(r>=c?l=t.data[h]>>r-c&f:(l=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=t.data[h-1]>>this.DB+r-c)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),d)s[l].copyTo(i),d=!1;else{for(;a>1;)o.sqrTo(i,p),o.sqrTo(p,i),a-=2;a>0?o.sqrTo(i,p):(y=i,i=p,p=y),o.mulTo(p,s[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)o.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--h)}return o.revert(i)}function fg(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function ug(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function hg(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return I.ZERO;for(var r=t.clone(),n=this.clone(),i=lr(1),o=lr(0),s=lr(0),a=lr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),e&&s.subTo(i,s),a.subTo(o,a))}if(n.compareTo(I.ONE)!=0)return I.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var Ee=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lg=(1<<26)/Ee[Ee.length-1];function pg(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Ee[Ee.length-1]){for(e=0;e<Ee.length;++e)if(r.data[0]==Ee[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Ee.length;){for(var n=Ee[e],i=e+1;i<Ee.length&&n<lg;)n*=Ee[i++];for(n=r.modInt(n);e<i;)if(n%Ee[e++]==0)return!1}return r.millerRabin(t)}function dg(t){var e=this.subtract(I.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=yg(),o,s=0;s<t;++s){do o=new I(this.bitLength(),i);while(o.compareTo(I.ONE)<=0||o.compareTo(e)>=0);var a=o.modPow(n,this);if(a.compareTo(I.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(I.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function yg(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}I.prototype.chunkSize=g1;I.prototype.toRadix=m1;I.prototype.fromRadix=b1;I.prototype.fromNumber=w1;I.prototype.bitwiseTo=A1;I.prototype.changeBit=M1;I.prototype.addTo=q1;I.prototype.dMultiply=X1;I.prototype.dAddOffset=Q1;I.prototype.multiplyLowerTo=eg;I.prototype.multiplyUpperTo=rg;I.prototype.modInt=ug;I.prototype.millerRabin=dg;I.prototype.clone=l1;I.prototype.intValue=p1;I.prototype.byteValue=d1;I.prototype.shortValue=y1;I.prototype.signum=x1;I.prototype.toByteArray=v1;I.prototype.equals=E1;I.prototype.min=S1;I.prototype.max=B1;I.prototype.and=I1;I.prototype.or=T1;I.prototype.xor=_1;I.prototype.andNot=L1;I.prototype.not=R1;I.prototype.shiftLeft=N1;I.prototype.shiftRight=D1;I.prototype.getLowestSetBit=k1;I.prototype.bitCount=K1;I.prototype.testBit=O1;I.prototype.setBit=F1;I.prototype.clearBit=H1;I.prototype.flipBit=V1;I.prototype.add=z1;I.prototype.subtract=G1;I.prototype.multiply=$1;I.prototype.divide=W1;I.prototype.remainder=Z1;I.prototype.divideAndRemainder=Y1;I.prototype.modPow=cg;I.prototype.modInverse=hg;I.prototype.pow=tg;I.prototype.gcd=fg;I.prototype.isProbablePrime=pg});var Xf=Q((_8,Yf)=>{var De=yt();Nr();kt();var Wf=Yf.exports=De.sha1=De.sha1||{};De.md.sha1=De.md.algorithms.sha1=Wf;Wf.create=function(){Zf||gg();var t=null,e=De.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=De.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=De.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),$f(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=De.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Zs.substr(0,n.blockLength-s));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};$f(h,r,i);var l=De.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Zs=null,Zf=!1;function gg(){Zs=String.fromCharCode(128),Zs+=De.util.fillString(String.fromCharCode(0),64),Zf=!0}function $f(t,e,r){for(var n,i,o,s,a,c,f,u,h=r.length();h>=64;){for(i=t.h0,o=t.h1,s=t.h2,a=t.h3,c=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,f=a^o&(s^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=a^o&(s^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=o^s^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=o^s^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=o&s|a&(o^s),n=(i<<5|i>>>27)+f+c+2400959708+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=o^s^a,n=(i<<5|i>>>27)+f+c+3395469782+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+s|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,h-=64}}});var jf=Q((L8,Jf)=>{var Ue=yt();kt();ni();Xf();var Qf=Jf.exports=Ue.pkcs1=Ue.pkcs1||{};Qf.encode_rsa_oaep=function(t,e,r){var n,i,o,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),o?o.start():o=Ue.md.sha1.create(),s||(s=o);var a=Math.ceil(t.n.bitLength()/8),c=a-2*o.digestLength-2;if(e.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=e.length,f.maxLength=c,f}n||(n=""),o.update(n,"raw");for(var u=o.digest(),h="",l=c-e.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+e;if(!i)i=Ue.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=o.digestLength,f}var y=bo(i,a-o.digestLength-1,s),g=Ue.util.xorBytes(p,y,p.length),x=bo(g,o.digestLength,s),E=Ue.util.xorBytes(i,x,i.length);return"\0"+E+g};Qf.decode_rsa_oaep=function(t,e,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var g=new Error("RSAES-OAEP encoded message length is invalid.");throw g.length=e.length,g.expectedLength=s,g}if(i===void 0?i=Ue.md.sha1.create():i.start(),o||(o=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=e.charAt(0),f=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=bo(u,i.digestLength,o),l=Ue.util.xorBytes(f,h,f.length),d=bo(l,s-i.digestLength-1,o),p=Ue.util.xorBytes(u,d,u.length),y=p.substring(0,i.digestLength),g=c!=="\0",x=0;x<i.digestLength;++x)g|=a.charAt(x)!==y.charAt(x);for(var E=1,b=i.digestLength,A=i.digestLength;A<p.length;A++){var v=p.charCodeAt(A),B=v&1^1,D=E?65534:0;g|=v&D,E=E&B,b+=E}if(g||p.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(b+1)};function bo(t,e,r){r||(r=Ue.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),o=0;o<i;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var tu=Q((R8,Ys)=>{var pr=yt();kt();mo();ni();(function(){if(pr.prime){Ys.exports=pr.prime;return}var t=Ys.exports=pr.prime=pr.prime||{},e=pr.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=l.prng||pr.random,g={nextBytes:function(x){for(var E=y.getBytesSync(x.length),b=0;b<x.length;++b)x[b]=E.charCodeAt(b)}};if(p.name==="PRIMEINC")return o(h,g,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function o(h,l,d,p){return"workers"in d?c(h,l,d,p):s(h,l,d,p)}function s(h,l,d,p){var y=f(h,l),g=0,x=u(y.bitLength());"millerRabinTests"in d&&(x=d.millerRabinTests);var E=10;"maxBlockTime"in d&&(E=d.maxBlockTime),a(y,h,l,g,x,E,p)}function a(h,l,d,p,y,g,x){var E=+new Date;do{if(h.bitLength()>l&&(h=f(l,d)),h.isProbablePrime(y))return x(null,h);h.dAddOffset(r[p++%8],0)}while(g<0||+new Date-E<g);pr.util.setImmediate(function(){a(h,l,d,p,y,g,x)})}function c(h,l,d,p){if(typeof Worker>"u")return s(h,l,d,p);var y=f(h,l),g=d.workers,x=d.workLoad||100,E=x*30/8,b=d.workerScript||"forge/prime.worker.js";if(g===-1)return pr.util.estimateCores(function(v,B){v&&(B=2),g=B-1,A()});A();function A(){g=Math.max(1,g);for(var v=[],B=0;B<g;++B)v[B]=new Worker(b);for(var D=g,B=0;B<g;++B)v[B].addEventListener("message",R);var L=!1;function R($){if(!L){--D;var V=$.data;if(V.found){for(var H=0;H<v.length;++H)v[H].terminate();return L=!0,p(null,new e(V.prime,16))}y.bitLength()>h&&(y=f(h,l));var z=y.toString(16);$.target.postMessage({hex:z,workLoad:x}),y.dAddOffset(E,0)}}}}function f(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var vo=Q((N8,au)=>{var Z=yt();ri();mo();oo();jf();tu();ni();kt();typeof ot>"u"&&(ot=Z.jsbn.BigInteger);var ot,Xs=Z.util.isNodejs?fn():null,w=Z.asn1,de=Z.util;Z.pki=Z.pki||{};au.exports=Z.pki.rsa=Z.rsa=Z.rsa||{};var X=Z.pki,xg=[6,4,2,4,2,4,6,2],mg={name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},bg={name:"RSAPrivateKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},wg={name:"RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},vg=Z.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Eg={name:"DigestInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:w.Class.UNIVERSAL,type:w.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Sg=function(t){var e;if(t.algorithm in X.oids)e=X.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=w.oidToDer(e).getBytes(),i=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]),o=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);o.value.push(w.create(w.Class.UNIVERSAL,w.Type.OID,!1,n)),o.value.push(w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,""));var s=w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(o),i.value.push(s),w.toDer(i).getBytes()},ou=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(ot.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(ot.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new ot(Z.util.bytesToHex(Z.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(ot.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);var s=i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};X.rsa.encrypt=function(t,e,r){var n=r,i,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=su(t,e,r)):(i=Z.util.createBuffer(),i.putBytes(t));for(var s=new ot(i.toHex(),16),a=ou(s,e,n),c=a.toString(16),f=Z.util.createBuffer(),u=o-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(Z.util.hexToBytes(c)),f.getBytes()};X.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=t.length,o.expected=i,o}var s=new ot(Z.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=ou(s,e,r),c=a.toString(16),f=Z.util.createBuffer(),u=i-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(Z.util.hexToBytes(c)),n!==!1?wo(f.getBytes(),e,r):f.getBytes()};X.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||Z.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),f=0;f<a.length;++f)a[f]=c.charCodeAt(f)}},o=r.algorithm||"PRIMEINC",s;if(o==="PRIMEINC")s={algorithm:o,state:0,bits:t,rng:i,eInt:e||65537,e:new ot(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+o);return s};X.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new ot(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},o=+new Date,s,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,f=c-1;t.pqState===0?(t.num=new ot(c,t.rng),t.num.testBit(f)||t.num.bitwiseTo(ot.ONE.shiftLeft(f),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(Ag(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(xg[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(ot.ONE).gcd(t.e).compareTo(ot.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(ot.ONE),t.q1=t.q.subtract(ot.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(ot.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:X.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:X.rsa.setPublicKey(t.n,t.e)}}s=+new Date,a+=s-o,o=s}return t.keys!==null};X.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!Z.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(eu("generateKeyPair"))return Xs.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,f){if(a)return n(a);n(null,{privateKey:X.privateKeyFromPem(f),publicKey:X.publicKeyFromPem(c)})});if(ru("generateKey")&&ru("exportKey"))return de.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:iu(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return de.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=X.privateKeyFromAsn1(w.fromDer(Z.util.createBuffer(a)));n(null,{privateKey:c,publicKey:X.setRsaPublicKey(c.n,c.e)})}});if(nu("generateKey")&&nu("exportKey")){var i=de.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:iu(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,f=de.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(u){var h=u.target.result,l=X.privateKeyFromAsn1(w.fromDer(Z.util.createBuffer(h)));n(null,{privateKey:l,publicKey:X.setRsaPublicKey(l.n,l.e)})},f.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(eu("generateKeyPairSync")){var o=Xs.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:X.privateKeyFromPem(o.privateKey),publicKey:X.publicKeyFromPem(o.publicKey)}}}var s=X.rsa.createKeyPairGenerationState(t,e,r);if(!n)return X.rsa.stepKeyPairGenerationState(s,0),s.keys;Bg(s,r,n)};X.setRsaPublicKey=X.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,f){return su(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return Z.pkcs1.encode_rsa_oaep(c,a,o)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return X.rsa.encrypt(s,r,!0)},r.verify=function(n,i,o,s){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:function(c,f){f=wo(f,r,!0);var u=w.fromDer(f,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!w.validate(u,Eg,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=w.derToOid(h.algorithmIdentifier);if(!(p===Z.oids.md2||p===Z.oids.md5||p===Z.oids.sha1||p===Z.oids.sha224||p===Z.oids.sha256||p===Z.oids.sha384||p===Z.oids.sha512||p===Z.oids["sha512-224"]||p===Z.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===Z.oids.md2||p===Z.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:function(c,f){return f=wo(f,r,!0),c===f}});var a=X.rsa.decrypt(i,r,!0,!1);return o.verify(n,a,r.n.bitLength())},r};X.setRsaPrivateKey=X.rsa.setPrivateKey=function(t,e,r,n,i,o,s,a){var c={n:t,e,d:r,p:n,q:i,dP:o,dQ:s,qInv:a};return c.decrypt=function(f,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=X.rsa.decrypt(f,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:wo};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return Z.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,c,!1)},c.sign=function(f,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Sg},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return f}},h=1);var l=u.encode(f,c.n.bitLength());return X.rsa.encrypt(l,c,h)},c};X.wrapRsaPrivateKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(X.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,w.toDer(t).getBytes())])};X.privateKeyFromAsn1=function(t){var e={},r=[];if(w.validate(t,mg,e,r)&&(t=w.fromDer(Z.util.createBuffer(e.privateKey))),e={},r=[],!w.validate(t,bg,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,s,a,c,f,u,h;return i=Z.util.createBuffer(e.privateKeyModulus).toHex(),o=Z.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=Z.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=Z.util.createBuffer(e.privateKeyPrime1).toHex(),c=Z.util.createBuffer(e.privateKeyPrime2).toHex(),f=Z.util.createBuffer(e.privateKeyExponent1).toHex(),u=Z.util.createBuffer(e.privateKeyExponent2).toHex(),h=Z.util.createBuffer(e.privateKeyCoefficient).toHex(),X.setRsaPrivateKey(new ot(i,16),new ot(o,16),new ot(s,16),new ot(a,16),new ot(c,16),new ot(f,16),new ot(u,16),new ot(h,16))};X.privateKeyToAsn1=X.privateKeyToRSAPrivateKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.e)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.d)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.p)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.q)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.dP)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.dQ)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.qInv))])};X.publicKeyFromAsn1=function(t){var e={},r=[];if(w.validate(t,vg,e,r)){var n=w.derToOid(e.publicKeyOid);if(n!==X.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!w.validate(t,wg,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=Z.util.createBuffer(e.publicKeyModulus).toHex(),s=Z.util.createBuffer(e.publicKeyExponent).toHex();return X.setRsaPublicKey(new ot(o,16),new ot(s,16))};X.publicKeyToAsn1=X.publicKeyToSubjectPublicKeyInfo=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(X.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,[X.publicKeyToRSAPublicKey(t)])])};X.publicKeyToRSAPublicKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,ke(t.e))])};function su(t,e,r){var n=Z.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var s=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<s;++c)n.putByte(a)}else for(;s>0;){for(var f=0,u=Z.random.getBytes(s),c=0;c<s;++c)a=u.charCodeAt(c),a===0?++f:n.putByte(a);s=f}return n.putByte(0),n.putBytes(t),n}function wo(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),o=Z.util.createBuffer(t),s=o.getByte(),a=o.getByte();if(s!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var f=0;f<c;++f)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++c}else if(a===2)for(c=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++c}var u=o.getByte();if(u!==0||c!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function Bg(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){o(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return s(a,t.q);o(t.qBits,s)})}function o(a,c){Z.prime.generateProbablePrime(a,n,c)}function s(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var f=t.p;t.p=t.q,t.q=f}if(t.p.subtract(ot.ONE).gcd(t.e).compareTo(ot.ONE)!==0){t.p=null,i();return}if(t.q.subtract(ot.ONE).gcd(t.e).compareTo(ot.ONE)!==0){t.q=null,o(t.qBits,s);return}if(t.p1=t.p.subtract(ot.ONE),t.q1=t.q.subtract(ot.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(ot.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,o(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:X.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:X.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function ke(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=Z.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Ag(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function eu(t){return Z.util.isNodejs&&typeof Xs[t]=="function"}function ru(t){return typeof de.globalScope<"u"&&typeof de.globalScope.crypto=="object"&&typeof de.globalScope.crypto.subtle=="object"&&typeof de.globalScope.crypto.subtle[t]=="function"}function nu(t){return typeof de.globalScope<"u"&&typeof de.globalScope.msCrypto=="object"&&typeof de.globalScope.msCrypto.subtle=="object"&&typeof de.globalScope.msCrypto.subtle[t]=="function"}function iu(t){for(var e=Z.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var pu=Q((D8,lu)=>{var K=yt();Hs();ri();xf();Nr();oo();Ef();Af();ni();Kf();vo();kt();typeof cu>"u"&&(cu=K.jsbn.BigInteger);var cu,C=K.asn1,tt=K.pki=K.pki||{};lu.exports=tt.pbe=K.pbe=K.pbe||{};var kr=tt.oids,Cg={name:"EncryptedPrivateKeyInfo",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Ig={name:"PBES2Algorithms",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Tg={name:"pkcs-12PbeParams",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"iterations"}]};tt.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=K.random.getBytesSync(r.saltSize),i=r.count,o=C.integerToDer(i),s,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,u,h;switch(r.algorithm){case"aes128":s=16,f=16,u=kr["aes128-CBC"],h=K.aes.createEncryptionCipher;break;case"aes192":s=24,f=16,u=kr["aes192-CBC"],h=K.aes.createEncryptionCipher;break;case"aes256":s=32,f=16,u=kr["aes256-CBC"],h=K.aes.createEncryptionCipher;break;case"des":s=8,f=8,u=kr.desCBC,h=K.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=hu(d),y=K.pkcs5.pbkdf2(e,n,i,s,p),g=K.random.getBytesSync(f),x=h(y);x.start(g),x.update(C.toDer(t)),x.finish(),c=x.output.getBytes();var E=_g(n,o,s,d);a=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(kr.pkcs5PBES2).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(kr.pkcs5PBKDF2).getBytes()),E]),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(u).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,g)])])])}else if(r.algorithm==="3des"){s=24;var b=new K.util.ByteBuffer(n),y=tt.pbe.generatePkcs12Key(e,b,1,i,s),g=tt.pbe.generatePkcs12Key(e,b,2,i,s),x=K.des.createEncryptionCipher(y);x.start(g),x.update(C.toDer(t)),x.finish(),c=x.output.getBytes(),a=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(kr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,n),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,o.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var A=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[a,C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,c)]);return A};tt.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!C.validate(t,Cg,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=C.derToOid(n.encryptionOid),a=tt.pbe.getCipher(s,n.encryptionParams,e),c=K.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=C.fromDer(a.output)),r};tt.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:C.toDer(t).getBytes()};return K.pem.encode(r,{maxline:e})};tt.encryptedPrivateKeyFromPem=function(t){var e=K.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return C.fromDer(e.body)};tt.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=tt.wrapRsaPrivateKey(tt.privateKeyToAsn1(t));return n=tt.encryptPrivateKeyInfo(n,e,r),tt.encryptedPrivateKeyToPem(n)}var i,o,s,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,o=K.random.getBytesSync(16),a=K.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,o=K.random.getBytesSync(16),a=K.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,o=K.random.getBytesSync(16),a=K.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,o=K.random.getBytesSync(8),a=K.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,o=K.random.getBytesSync(8),a=K.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var f=K.pbe.opensslDeriveBytes(e,o.substr(0,8),s),u=a(f);u.start(o),u.update(C.toDer(tt.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:K.util.bytesToHex(o).toUpperCase()},body:u.output.getBytes()};return K.pem.encode(h)};tt.decryptRsaPrivateKey=function(t,e){var r=null,n=K.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,s;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,s=K.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,s=K.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,s=K.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,s=K.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,s=K.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,s=function(h){return K.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":o=8,s=function(h){return K.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":o=16,s=function(h){return K.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=K.util.hexToBytes(n.dekInfo.parameters),c=K.pbe.opensslDeriveBytes(e,a.substr(0,8),o),f=s(c);if(f.start(a),f.update(K.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=tt.decryptPrivateKeyInfo(C.fromDer(r),e):r=C.fromDer(r),r!==null&&(r=tt.privateKeyFromAsn1(r)),r};tt.pbe.generatePkcs12Key=function(t,e,r,n,i,o){var s,a;if(typeof o>"u"||o===null){if(!("sha1"in K.md))throw new Error('"sha1" hash algorithm unavailable.');o=K.md.sha1.create()}var c=o.digestLength,f=o.blockLength,u=new K.util.ByteBuffer,h=new K.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),d=e.length(),p=new K.util.ByteBuffer;p.fillWithByte(r,f);var y=f*Math.ceil(d/f),g=new K.util.ByteBuffer;for(a=0;a<y;a++)g.putByte(e.at(a%d));var x=f*Math.ceil(l/f),E=new K.util.ByteBuffer;for(a=0;a<x;a++)E.putByte(h.at(a%l));var b=g;b.putBuffer(E);for(var A=Math.ceil(i/c),v=1;v<=A;v++){var B=new K.util.ByteBuffer;B.putBytes(p.bytes()),B.putBytes(b.bytes());for(var D=0;D<n;D++)o.start(),o.update(B.getBytes()),B=o.digest();var L=new K.util.ByteBuffer;for(a=0;a<f;a++)L.putByte(B.at(a%c));var R=Math.ceil(d/f)+Math.ceil(l/f),$=new K.util.ByteBuffer;for(s=0;s<R;s++){var V=new K.util.ByteBuffer(b.getBytes(f)),H=511;for(a=L.length()-1;a>=0;a--)H=H>>8,H+=L.at(a)+V.at(a),V.setAt(a,H&255);$.putBuffer(V)}b=$,u.putBuffer(B)}return u.truncate(u.length()-i),u};tt.pbe.getCipher=function(t,e,r){switch(t){case tt.oids.pkcs5PBES2:return tt.pbe.getCipherForPBES2(t,e,r);case tt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case tt.oids["pbewithSHAAnd40BitRC2-CBC"]:return tt.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};tt.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!C.validate(e,Ig,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(t=C.derToOid(n.kdfOid),t!==tt.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=t,o.supportedOids=["pkcs5PBKDF2"],o}if(t=C.derToOid(n.encOid),t!==tt.oids["aes128-CBC"]&&t!==tt.oids["aes192-CBC"]&&t!==tt.oids["aes256-CBC"]&&t!==tt.oids["des-EDE3-CBC"]&&t!==tt.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=t,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var s=n.kdfSalt,a=K.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,f;switch(tt.oids[t]){case"aes128-CBC":c=16,f=K.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=K.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=K.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=K.des.createDecryptionCipher;break;case"desCBC":c=8,f=K.des.createDecryptionCipher;break}var u=uu(n.prfOid),h=K.pkcs5.pbkdf2(r,s,a,c,u),l=n.encIv,d=f(h);return d.start(l),d};tt.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!C.validate(e,Tg,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=K.util.createBuffer(n.salt),a=K.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,f,u;switch(t){case tt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,u=K.des.startDecrypting;break;case tt.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,u=function(y,g){var x=K.rc2.createDecryptionCipher(y,40);return x.start(g,null),x};break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=t,o}var h=uu(n.prfOid),l=tt.pbe.generatePkcs12Key(r,s,1,a,c,h);h.start();var d=tt.pbe.generatePkcs12Key(r,s,2,a,f,h);return u(l,d)};tt.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in K.md))throw new Error('"md5" hash algorithm unavailable.');n=K.md.md5.create()}e===null&&(e="");for(var i=[fu(n,t+e)],o=16,s=1;o<r;++s,o+=16)i.push(fu(n,i[s-1]+t+e));return i.join("").substr(0,r)};function fu(t,e){return t.start().update(e).digest().getBytes()}function uu(t){var e;if(!t)e="hmacWithSHA1";else if(e=tt.oids[C.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return hu(e)}function hu(t){var e=K.md;switch(t){case"hmacWithSHA224":e=K.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function _g(t,e,r,n){var i=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,t),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,K.util.hexToBytes(r.toString(16))),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(tt.oids[n]).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.NULL,!1,"")])),i}});var hh=Q((F3,uh)=>{"use strict";uh.exports=Nx;function Nx(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(u){if(o)if(o=!1,u)c(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{t.apply(e||null,r)}catch(f){o&&(o=!1,c(f))}})}});var yh=Q(dh=>{"use strict";var Ro=dh;Ro.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var An=new Array(64),ph=new Array(123);for(Se=0;Se<64;)ph[An[Se]=Se<26?Se+65:Se<52?Se+71:Se<62?Se-4:Se-59|43]=Se++;var Se;Ro.encode=function(e,r,n){for(var i=null,o=[],s=0,a=0,c;r<n;){var f=e[r++];switch(a){case 0:o[s++]=An[f>>2],c=(f&3)<<4,a=1;break;case 1:o[s++]=An[c|f>>4],c=(f&15)<<2,a=2;break;case 2:o[s++]=An[c|f>>6],o[s++]=An[f&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=An[c],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var lh="invalid encoding";Ro.decode=function(e,r,n){for(var i=n,o=0,s,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&o>1)break;if((c=ph[c])===void 0)throw Error(lh);switch(o){case 0:s=c,o=1;break;case 1:r[n++]=s<<2|(c&48)>>4,s=c,o=2;break;case 2:r[n++]=(s&15)<<4|(c&60)>>2,s=c,o=3;break;case 3:r[n++]=(s&3)<<6|c,o=0;break}}if(o===1)throw Error(lh);return n-i};Ro.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var xh=Q((V3,gh)=>{"use strict";gh.exports=No;function No(){this._listeners={}}No.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};No.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};No.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Bh=Q((q3,Sh)=>{"use strict";Sh.exports=mh(mh);function mh(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3]}function o(c,f,u){e[0]=c,f[u]=r[3],f[u+1]=r[2],f[u+2]=r[1],f[u+3]=r[0]}t.writeFloatLE=n?i:o,t.writeFloatBE=n?o:i;function s(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],e[0]}function a(c,f){return r[3]=c[f],r[2]=c[f+1],r[1]=c[f+2],r[0]=c[f+3],e[0]}t.readFloatLE=n?s:a,t.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var c=Math.floor(Math.log(i)/Math.LN2),f=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|f)>>>0,o,s)}}t.writeFloatLE=e.bind(null,bh),t.writeFloatBE=e.bind(null,wh);function r(n,i,o){var s=n(i,o),a=(s>>31)*2+1,c=s>>>23&255,f=s&8388607;return c===255?f?NaN:a*(1/0):c===0?a*1401298464324817e-60*f:a*Math.pow(2,c-150)*(f+8388608)}t.readFloatLE=r.bind(null,vh),t.readFloatBE=r.bind(null,Eh)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3],f[u+4]=r[4],f[u+5]=r[5],f[u+6]=r[6],f[u+7]=r[7]}function o(c,f,u){e[0]=c,f[u]=r[7],f[u+1]=r[6],f[u+2]=r[5],f[u+3]=r[4],f[u+4]=r[3],f[u+5]=r[2],f[u+6]=r[1],f[u+7]=r[0]}t.writeDoubleLE=n?i:o,t.writeDoubleBE=n?o:i;function s(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],r[4]=c[f+4],r[5]=c[f+5],r[6]=c[f+6],r[7]=c[f+7],e[0]}function a(c,f){return r[7]=c[f],r[6]=c[f+1],r[5]=c[f+2],r[4]=c[f+3],r[3]=c[f+4],r[2]=c[f+5],r[1]=c[f+6],r[0]=c[f+7],e[0]}t.readDoubleLE=n?s:a,t.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,c){var f=s<0?1:0;if(f&&(s=-s),s===0)n(0,a,c+i),n(1/s>0?0:2147483648,a,c+o);else if(isNaN(s))n(0,a,c+i),n(2146959360,a,c+o);else if(s>17976931348623157e292)n(0,a,c+i),n((f<<31|2146435072)>>>0,a,c+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,a,c+i),n((f<<31|u/4294967296)>>>0,a,c+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,a,c+i),n((f<<31|h+1023<<20|u*1048576&1048575)>>>0,a,c+o)}}}t.writeDoubleLE=e.bind(null,bh,0,4),t.writeDoubleBE=e.bind(null,wh,4,0);function r(n,i,o,s,a){var c=n(s,a+i),f=n(s,a+o),u=(f>>31)*2+1,h=f>>>20&2047,l=4294967296*(f&1048575)+c;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,vh,0,4),t.readDoubleBE=r.bind(null,Eh,4,0)}(),t}function bh(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function wh(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function vh(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Eh(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Ah=Q((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Ih=Q(Ch=>{"use strict";var Fa=Ch;Fa.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Fa.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var o=null,s=[],a=0,c;r<n;)c=e[r++],c<128?s[a++]=c:c>191&&c<224?s[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[a++]=55296+(c>>10),s[a++]=56320+(c&1023)):s[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};Fa.write=function(e,r,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=o&63|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=o&63|128);return n-i}});var _h=Q((G3,Th)=>{"use strict";Th.exports=Dx;function Dx(t,e,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(c){if(c<1||c>i)return t(c);s+c>n&&(o=t(n),s=0);var f=e.call(o,s,s+=c);return s&7&&(s=(s|7)+1),f}}});var Rh=Q(($3,Lh)=>{"use strict";Lh.exports=zt;var xi=Mr();function zt(t,e){this.lo=t>>>0,this.hi=e>>>0}var Or=zt.zero=new zt(0,0);Or.toNumber=function(){return 0};Or.zzEncode=Or.zzDecode=function(){return this};Or.length=function(){return 1};var Ux=zt.zeroHash="\0\0\0\0\0\0\0\0";zt.fromNumber=function(e){if(e===0)return Or;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new zt(n,i)};zt.from=function(e){if(typeof e=="number")return zt.fromNumber(e);if(xi.isString(e))if(xi.Long)e=xi.Long.fromString(e);else return zt.fromNumber(parseInt(e,10));return e.low||e.high?new zt(e.low>>>0,e.high>>>0):Or};zt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};zt.prototype.toLong=function(e){return xi.Long?new xi.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Er=String.prototype.charCodeAt;zt.fromHash=function(e){return e===Ux?Or:new zt((Er.call(e,0)|Er.call(e,1)<<8|Er.call(e,2)<<16|Er.call(e,3)<<24)>>>0,(Er.call(e,4)|Er.call(e,5)<<8|Er.call(e,6)<<16|Er.call(e,7)<<24)>>>0)};zt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};zt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};zt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};zt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Mr=Q(Ha=>{"use strict";var G=Ha;G.asPromise=hh();G.base64=yh();G.EventEmitter=xh();G.float=Bh();G.inquire=Ah();G.utf8=Ih();G.pool=_h();G.LongBits=Rh();G.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);G.global=G.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Ha;G.emptyArray=Object.freeze?Object.freeze([]):[];G.emptyObject=Object.freeze?Object.freeze({}):{};G.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};G.isString=function(e){return typeof e=="string"||e instanceof String};G.isObject=function(e){return e&&typeof e=="object"};G.isset=G.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};G.Buffer=function(){try{var t=G.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();G._Buffer_from=null;G._Buffer_allocUnsafe=null;G.newBuffer=function(e){return typeof e=="number"?G.Buffer?G._Buffer_allocUnsafe(e):new G.Array(e):G.Buffer?G._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};G.Array=typeof Uint8Array<"u"?Uint8Array:Array;G.Long=G.global.dcodeIO&&G.global.dcodeIO.Long||G.global.Long||G.inquire("long");G.key2Re=/^true|false|0|1$/;G.key32Re=/^-?(?:0|[1-9][0-9]*)$/;G.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;G.longToHash=function(e){return e?G.LongBits.from(e).toHash():G.LongBits.zeroHash};G.longFromHash=function(e,r){var n=G.LongBits.fromHash(e);return G.Long?G.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function Nh(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}G.merge=Nh;G.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Dh(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Nh(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}G.newError=Dh;G.ProtocolError=Dh("ProtocolError");G.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(r[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};G.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};G.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};G._configure=function(){var t=G.Buffer;if(!t){G._Buffer_from=G._Buffer_allocUnsafe=null;return}G._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},G._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var za=Q((Z3,Oh)=>{"use strict";Oh.exports=Ut;var Me=Mr(),qa,Ph=Me.LongBits,kx=Me.utf8;function Be(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Ut(t){this.buf=t,this.pos=0,this.len=t.length}var Uh=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Ut(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Ut(e);throw Error("illegal buffer")},Kh=function(){return Me.Buffer?function(r){return(Ut.create=function(i){return Me.Buffer.isBuffer(i)?new qa(i):Uh(i)})(r)}:Uh};Ut.create=Kh();Ut.prototype._slice=Me.Array.prototype.subarray||Me.Array.prototype.slice;Ut.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Be(this,10);return e}}();Ut.prototype.int32=function(){return this.uint32()|0};Ut.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Va(){var t=new Ph(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Be(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Be(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Ut.prototype.bool=function(){return this.uint32()!==0};function Do(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Ut.prototype.fixed32=function(){if(this.pos+4>this.len)throw Be(this,4);return Do(this.buf,this.pos+=4)};Ut.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Be(this,4);return Do(this.buf,this.pos+=4)|0};function kh(){if(this.pos+8>this.len)throw Be(this,8);return new Ph(Do(this.buf,this.pos+=4),Do(this.buf,this.pos+=4))}Ut.prototype.float=function(){if(this.pos+4>this.len)throw Be(this,4);var e=Me.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Ut.prototype.double=function(){if(this.pos+8>this.len)throw Be(this,4);var e=Me.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Ut.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Be(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Ut.prototype.string=function(){var e=this.bytes();return kx.read(e,0,e.length)};Ut.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Be(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Be(this);while(this.buf[this.pos++]&128);return this};Ut.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Ut._configure=function(t){qa=t,Ut.create=Kh(),qa._configure();var e=Me.Long?"toLong":"toNumber";Me.merge(Ut.prototype,{int64:function(){return Va.call(this)[e](!1)},uint64:function(){return Va.call(this)[e](!0)},sint64:function(){return Va.call(this).zzDecode()[e](!1)},fixed64:function(){return kh.call(this)[e](!0)},sfixed64:function(){return kh.call(this)[e](!1)}})}});var Vh=Q((Y3,Hh)=>{"use strict";Hh.exports=Fr;var Fh=za();(Fr.prototype=Object.create(Fh.prototype)).constructor=Fr;var Mh=Mr();function Fr(t){Fh.call(this,t)}Fr._configure=function(){Mh.Buffer&&(Fr.prototype._slice=Mh.Buffer.prototype.slice)};Fr.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Fr._configure()});var Qa=Q((X3,$h)=>{"use strict";$h.exports=ut;var ye=Mr(),Ga,Uo=ye.LongBits,qh=ye.base64,zh=ye.utf8;function mi(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Wa(){}function Px(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function ut(){this.len=0,this.head=new mi(Wa,0,0),this.tail=this.head,this.states=null}var Gh=function(){return ye.Buffer?function(){return(ut.create=function(){return new Ga})()}:function(){return new ut}};ut.create=Gh();ut.alloc=function(e){return new ye.Array(e)};ye.Array!==Array&&(ut.alloc=ye.pool(ut.alloc,ye.Array.prototype.subarray));ut.prototype._push=function(e,r,n){return this.tail=this.tail.next=new mi(e,r,n),this.len+=r,this};function Za(t,e,r){e[r]=t&255}function Kx(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Ya(t,e){this.len=t,this.next=void 0,this.val=e}Ya.prototype=Object.create(mi.prototype);Ya.prototype.fn=Kx;ut.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Ya((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};ut.prototype.int32=function(e){return e<0?this._push(Xa,10,Uo.fromNumber(e)):this.uint32(e)};ut.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Xa(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}ut.prototype.uint64=function(e){var r=Uo.from(e);return this._push(Xa,r.length(),r)};ut.prototype.int64=ut.prototype.uint64;ut.prototype.sint64=function(e){var r=Uo.from(e).zzEncode();return this._push(Xa,r.length(),r)};ut.prototype.bool=function(e){return this._push(Za,1,e?1:0)};function $a(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}ut.prototype.fixed32=function(e){return this._push($a,4,e>>>0)};ut.prototype.sfixed32=ut.prototype.fixed32;ut.prototype.fixed64=function(e){var r=Uo.from(e);return this._push($a,4,r.lo)._push($a,4,r.hi)};ut.prototype.sfixed64=ut.prototype.fixed64;ut.prototype.float=function(e){return this._push(ye.float.writeFloatLE,4,e)};ut.prototype.double=function(e){return this._push(ye.float.writeDoubleLE,8,e)};var Ox=ye.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};ut.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Za,1,0);if(ye.isString(e)){var n=ut.alloc(r=qh.length(e));qh.decode(e,n,0),e=n}return this.uint32(r)._push(Ox,r,e)};ut.prototype.string=function(e){var r=zh.length(e);return r?this.uint32(r)._push(zh.write,r,e):this._push(Za,1,0)};ut.prototype.fork=function(){return this.states=new Px(this),this.head=this.tail=new mi(Wa,0,0),this.len=0,this};ut.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new mi(Wa,0,0),this.len=0),this};ut.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};ut.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};ut._configure=function(t){Ga=t,ut.create=Gh(),Ga._configure()}});var Yh=Q((Q3,Zh)=>{"use strict";Zh.exports=Fe;var Wh=Qa();(Fe.prototype=Object.create(Wh.prototype)).constructor=Fe;var Sr=Mr();function Fe(){Wh.call(this)}Fe._configure=function(){Fe.alloc=Sr._Buffer_allocUnsafe,Fe.writeBytesBuffer=Sr.Buffer&&Sr.Buffer.prototype instanceof Uint8Array&&Sr.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Fe.prototype.bytes=function(e){Sr.isString(e)&&(e=Sr._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Fe.writeBytesBuffer,r,e),this};function Mx(t,e,r){t.length<40?Sr.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Fe.prototype.string=function(e){var r=Sr.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Mx,r,e),this};Fe._configure()});var al=Q((Q4,sl)=>{var wt=yt();Nr();kt();var wi=sl.exports=wt.sha512=wt.sha512||{};wt.md.sha512=wt.md.algorithms.sha512=wi;var il=wt.sha384=wt.sha512.sha384=wt.sha512.sha384||{};il.create=function(){return wi.create("SHA-384")};wt.md.sha384=wt.md.algorithms.sha384=il;wt.sha512.sha256=wt.sha512.sha256||{create:function(){return wi.create("SHA-512/256")}};wt.md["sha512/256"]=wt.md.algorithms["sha512/256"]=wt.sha512.sha256;wt.sha512.sha224=wt.sha512.sha224||{create:function(){return wi.create("SHA-512/224")}};wt.md["sha512/224"]=wt.md.algorithms["sha512/224"]=wt.sha512.sha224;wi.create=function(t){if(ol||Yx(),typeof t>"u"&&(t="SHA-512"),!(t in Gr))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Gr[t],r=null,n=wt.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,f=0;f<c;++f)a.fullMessageLength.push(0);n=wt.util.createBuffer(),r=new Array(e.length);for(var f=0;f<e.length;++f)r[f]=e[f].slice(0);return a},a.start(),a.update=function(c,f){f==="utf8"&&(c=wt.util.encodeUtf8(c));var u=c.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(c),nl(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=wt.util.createBuffer();c.putBytes(n.bytes());var f=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=f&a.blockLength-1;c.putBytes(o0.substr(0,a.blockLength-u));for(var h,l,d=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,c.putInt32(d>>>0),d=h>>>0;c.putInt32(d);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);nl(y,i,c);var g=wt.util.createBuffer(),x;t==="SHA-512"?x=y.length:t==="SHA-384"?x=y.length-2:x=y.length-4;for(var p=0;p<x;++p)g.putInt32(y[p][0]),(p!==x-1||t!=="SHA-512/224")&&g.putInt32(y[p][1]);return g},a};var o0=null,ol=!1,s0=null,Gr=null;function Yx(){o0=String.fromCharCode(128),o0+=wt.util.fillString(String.fromCharCode(0),128),s0=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Gr={},Gr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Gr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Gr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Gr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],ol=!0}function nl(t,e,r){for(var n,i,o,s,a,c,f,u,h,l,d,p,y,g,x,E,b,A,v,B,D,L,R,$,V,H,z,it,W,Y,U,N,S,k,M,q=r.length();q>=128;){for(W=0;W<16;++W)e[W][0]=r.getInt32()>>>0,e[W][1]=r.getInt32()>>>0;for(;W<80;++W)N=e[W-2],Y=N[0],U=N[1],n=((Y>>>19|U<<13)^(U>>>29|Y<<3)^Y>>>6)>>>0,i=((Y<<13|U>>>19)^(U<<3|Y>>>29)^(Y<<26|U>>>6))>>>0,k=e[W-15],Y=k[0],U=k[1],o=((Y>>>1|U<<31)^(Y>>>8|U<<24)^Y>>>7)>>>0,s=((Y<<31|U>>>1)^(Y<<24|U>>>8)^(Y<<25|U>>>7))>>>0,S=e[W-7],M=e[W-16],U=i+S[1]+s+M[1],e[W][0]=n+S[0]+o+M[0]+(U/4294967296>>>0)>>>0,e[W][1]=U>>>0;for(y=t[0][0],g=t[0][1],x=t[1][0],E=t[1][1],b=t[2][0],A=t[2][1],v=t[3][0],B=t[3][1],D=t[4][0],L=t[4][1],R=t[5][0],$=t[5][1],V=t[6][0],H=t[6][1],z=t[7][0],it=t[7][1],W=0;W<80;++W)f=((D>>>14|L<<18)^(D>>>18|L<<14)^(L>>>9|D<<23))>>>0,u=((D<<18|L>>>14)^(D<<14|L>>>18)^(L<<23|D>>>9))>>>0,h=(V^D&(R^V))>>>0,l=(H^L&($^H))>>>0,a=((y>>>28|g<<4)^(g>>>2|y<<30)^(g>>>7|y<<25))>>>0,c=((y<<4|g>>>28)^(g<<30|y>>>2)^(g<<25|y>>>7))>>>0,d=(y&x|b&(y^x))>>>0,p=(g&E|A&(g^E))>>>0,U=it+u+l+s0[W][1]+e[W][1],n=z+f+h+s0[W][0]+e[W][0]+(U/4294967296>>>0)>>>0,i=U>>>0,U=c+p,o=a+d+(U/4294967296>>>0)>>>0,s=U>>>0,z=V,it=H,V=R,H=$,R=D,$=L,U=B+i,D=v+n+(U/4294967296>>>0)>>>0,L=U>>>0,v=b,B=A,b=x,A=E,x=y,E=g,U=i+s,y=n+o+(U/4294967296>>>0)>>>0,g=U>>>0;U=t[0][1]+g,t[0][0]=t[0][0]+y+(U/4294967296>>>0)>>>0,t[0][1]=U>>>0,U=t[1][1]+E,t[1][0]=t[1][0]+x+(U/4294967296>>>0)>>>0,t[1][1]=U>>>0,U=t[2][1]+A,t[2][0]=t[2][0]+b+(U/4294967296>>>0)>>>0,t[2][1]=U>>>0,U=t[3][1]+B,t[3][0]=t[3][0]+v+(U/4294967296>>>0)>>>0,t[3][1]=U>>>0,U=t[4][1]+L,t[4][0]=t[4][0]+D+(U/4294967296>>>0)>>>0,t[4][1]=U>>>0,U=t[5][1]+$,t[5][0]=t[5][0]+R+(U/4294967296>>>0)>>>0,t[5][1]=U>>>0,U=t[6][1]+H,t[6][0]=t[6][0]+V+(U/4294967296>>>0)>>>0,t[6][1]=U>>>0,U=t[7][1]+it,t[7][0]=t[7][0]+z+(U/4294967296>>>0)>>>0,t[7][1]=U>>>0,q-=128}}});var Ql=Q((F5,Xl)=>{var Mn=1e3,Fn=Mn*60,Hn=Fn*60,Xr=Hn*24,sb=Xr*7,ab=Xr*365.25;Xl.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return cb(t);if(r==="number"&&isFinite(t))return e.long?ub(t):fb(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function cb(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*ab;case"weeks":case"week":case"w":return r*sb;case"days":case"day":case"d":return r*Xr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Hn;case"minutes":case"minute":case"mins":case"min":case"m":return r*Fn;case"seconds":case"second":case"secs":case"sec":case"s":return r*Mn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function fb(t){var e=Math.abs(t);return e>=Xr?Math.round(t/Xr)+"d":e>=Hn?Math.round(t/Hn)+"h":e>=Fn?Math.round(t/Fn)+"m":e>=Mn?Math.round(t/Mn)+"s":t+"ms"}function ub(t){var e=Math.abs(t);return e>=Xr?$o(t,e,Xr,"day"):e>=Hn?$o(t,e,Hn,"hour"):e>=Fn?$o(t,e,Fn,"minute"):e>=Mn?$o(t,e,Mn,"second"):t+" ms"}function $o(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var jl=Q((H5,Jl)=>{function hb(t){r.debug=r,r.default=r,r.coerce=c,r.disable=o,r.enable=i,r.enabled=s,r.humanize=Ql(),r.destroy=f,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,l=null,d,p;function y(...g){if(!y.enabled)return;let x=y,E=Number(new Date),b=E-(h||E);x.diff=b,x.prev=h,x.curr=E,h=E,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let A=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(B,D)=>{if(B==="%%")return"%";A++;let L=r.formatters[D];if(typeof L=="function"){let R=g[A];B=L.call(x,R),g.splice(A,1),A--}return B}),r.formatArgs.call(x,g),(x.log||r.log).apply(x,g)}return y.namespace=u,y.useColors=r.useColors(),y.color=r.selectColor(u),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(u)),p),set:g=>{l=g}}),typeof r.init=="function"&&r.init(y),y}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)l[h]&&(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function o(){let u=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Jl.exports=hb});var tp=Q((ce,Wo)=>{ce.formatArgs=pb;ce.save=db;ce.load=yb;ce.useColors=lb;ce.storage=gb();ce.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ce.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function lb(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function pb(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Wo.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}ce.log=console.debug||console.log||(()=>{});function db(t){try{t?ce.storage.setItem("debug",t):ce.storage.removeItem("debug")}catch{}}function yb(){let t;try{t=ce.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function gb(){try{return localStorage}catch{}}Wo.exports=jl()(ce);var{formatters:xb}=Wo.exports;xb.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var vb={};pt(vb,{noise:()=>wb,pureJsCrypto:()=>no});function rr(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function ze(t=0){return globalThis.Buffer?.alloc!=null?rr(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function ue(t=0){return globalThis.Buffer?.allocUnsafe!=null?rr(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Pt(t,e){e==null&&(e=t.reduce((i,o)=>i+o.length,0));let r=ue(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return rr(r)}function Mt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var W0=Symbol.for("@achingbrain/uint8arraylist");function $0(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let i=r+n.byteLength;if(e<i)return{buf:n,index:e-r};r=i}throw new RangeError("index is out of bounds")}function Pi(t){return!!t?.[W0]}var me=class t{constructor(...e){Object.defineProperty(this,W0,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(Pi(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(Pi(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=$0(this.bufs,e);return r.buf[r.index]}set(e,r){let n=$0(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(Pi(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return Pt(n,i)}subarray(e,r){let{bufs:n,length:i}=this._subList(e,r);return n.length===1?n[0]:Pt(n,i)}sublist(e,r){let{bufs:n,length:i}=this._subList(e,r),o=new t;return o.length=i,o.bufs=n,o}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],a=i,c=a+s.byteLength;if(i=c,e>=c)continue;let f=e>=a&&e<c,u=r>a&&r<=c;if(f&&u){if(e===a&&r===c){n.push(s);break}let h=e-a;n.push(s.subarray(h,h+(r-e)));break}if(f){if(e===0){n.push(s);continue}n.push(s.subarray(e-a));continue}if(u){if(r===c){n.push(s);break}n.push(s.subarray(0,r-a));break}n.push(s)}return{bufs:n,length:r-e}}indexOf(e,r=0){if(!Pi(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),e.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let h=0;h<o;h++)s[h]=-1;for(let h=0;h<i;h++)s[n[h]]=h;let a=s,c=this.byteLength-n.byteLength,f=n.byteLength-1,u;for(let h=r;h<=c;h+=u){u=0;for(let l=f;l>=0;l--){let d=this.get(h+l);if(n[l]!==d){u=Math.max(1,l-a[d]);break}}if(u===0)return h}return-1}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=ue(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=ze(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=ze(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=ze(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=ue(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=ze(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=ze(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=ze(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=ze(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=ze(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof t)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Mt(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new t;return n.bufs=e,r==null&&(r=e.reduce((i,o)=>i+o.byteLength,0)),n.length=r,n}};function Ki(t){return t instanceof Uint8Array?{get(e){return t[e]},set(e,r){t[e]=r}}:{get(e){return t.get(e)},set(e,r){t.set(e,r)}}}var Z0=4294967296,Vn=class t{constructor(e=0,r=0){this.hi=e,this.lo=r}toBigInt(e){if(e===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){let e=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new t(n,r)}zzEncode(){let e=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new t(r,n)}toBytes(e,r=0){let n=Ki(e);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(e){if(e===0n)return new t;let r=e<0;r&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>Z0&&(i=0,++n>Z0&&(n=0))),new t(n,i)}static fromNumber(e){if(e===0)return new t;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new t(i,n)}static fromBytes(e,r=0){let n=Ki(e),i=new t,o=0;if(e.length-r>4){for(;o<4;++o)if(i.lo=(i.lo|(n.get(r)&127)<<o*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;o=0}else for(;o<4;++o){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<o*7)>>>0,n.get(r++)<128)return i}if(e.length-r>4){for(;o<5;++o)if(i.hi=(i.hi|(n.get(r)&127)<<o*7+3)>>>0,n.get(r++)<128)return i}else if(r<e.byteLength)for(;o<5;++o){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<o*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var wp=Math.pow(2,7),vp=Math.pow(2,14),Ep=Math.pow(2,21),Sp=Math.pow(2,28),Bp=Math.pow(2,35),Ap=Math.pow(2,42),Cp=Math.pow(2,49),Ip=Math.pow(2,56),Tp=Math.pow(2,63),Ge={encodingLength(t){return t<wp?1:t<vp?2:t<Ep?3:t<Sp?4:t<Bp?5:t<Ap?6:t<Cp?7:t<Ip?8:t<Tp?9:10},encode(t,e,r=0){if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return e==null&&(e=ue(Ge.encodingLength(t))),Vn.fromNumber(t).toBytes(e,r),e},decode(t,e=0){return Vn.fromBytes(t,e).toNumber(!0)}};function Oi(t){return t[Symbol.asyncIterator]!=null}var Mi=t=>{let e=Ge.encodingLength(t),r=ue(e);return Ge.encode(t,r),Mi.bytes=e,r};Mi.bytes=0;function Fi(t,e){e=e??{};let r=e.lengthEncoder??Mi;function*n(i){let o=r(i.byteLength);o instanceof Uint8Array?yield o:yield*o,i instanceof Uint8Array?yield i:yield*i}return Oi(t)?async function*(){for await(let i of t)yield*n(i)}():function*(){for(let i of t)yield*n(i)}()}Fi.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??Mi;return new me(r(t.byteLength),t)};var Qr=It(Q0(),1);var Lp=8,Rp=1024*1024*4,Tr;(function(t){t[t.LENGTH=0]="LENGTH",t[t.DATA=1]="DATA"})(Tr||(Tr={}));var ts=t=>{let e=Ge.decode(t);return ts.bytes=Ge.encodingLength(e),e};ts.bytes=0;function qn(t,e){let r=new me,n=Tr.LENGTH,i=-1,o=e?.lengthDecoder??ts,s=e?.maxLengthLength??Lp,a=e?.maxDataLength??Rp;function*c(){for(;r.byteLength>0;){if(n===Tr.LENGTH)try{if(i=o(r),i<0)throw(0,Qr.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,Qr.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let f=o.bytes;r.consume(f),e?.onLength!=null&&e.onLength(i),n=Tr.DATA}catch(f){if(f instanceof RangeError){if(r.byteLength>s)throw(0,Qr.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw f}if(n===Tr.DATA){if(r.byteLength<i)break;let f=r.sublist(0,i);r.consume(i),e?.onData!=null&&e.onData(f),yield f,n=Tr.LENGTH}}}return Oi(t)?async function*(){for await(let f of t)r.append(f),yield*c();if(r.byteLength>0)throw(0,Qr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let f of t)r.append(f),yield*c();if(r.byteLength>0)throw(0,Qr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}qn.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:o,value:s}=await t.next(r);if(o===!0)return;s!=null&&(yield s)}catch(o){if(o.code==="ERR_UNDER_READ")return{done:!0,value:null};throw o}finally{r=1}}();return qn(n,{...e??{},onLength:o=>{r=o}})};function Jr(){let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}var Hi=class{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},jr=class{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Hi(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let r=this.head;this.head=r.next=new Hi(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};var es=class extends Error{type;code;constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function tn(t={}){return Dp(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function Dp(t,e){e=e??{};let r=e.onEnd,n=new jr,i,o,s,a=Jr(),c=async()=>{try{return n.isEmpty()?s?{done:!0}:await new Promise((g,x)=>{o=E=>{o=null,n.push(E);try{g(t(n))}catch(b){x(b)}return i}}):t(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=Jr()})}},f=g=>o!=null?o(g):(n.push(g),i),u=g=>(n=new jr,o!=null?o({error:g}):(n.push({error:g}),i)),h=g=>{if(s)return i;if(e?.objectMode!==!0&&g?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return f({done:!1,value:g})},l=g=>s?i:(s=!0,g!=null?u(g):f({done:!0})),d=()=>(n=new jr,l(),{done:!0}),p=g=>(l(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:c,return:d,throw:p,push:h,end:l,get readableLength(){return n.size},onEmpty:async g=>{let x=g?.signal;if(x?.throwIfAborted(),n.isEmpty())return;let E,b;x!=null&&(E=new Promise((A,v)=>{b=()=>{v(new es)},x.addEventListener("abort",b)}));try{await Promise.race([a.promise,E])}finally{b!=null&&x!=null&&x?.removeEventListener("abort",b)}}},r==null)return i;let y=i;return i={[Symbol.asyncIterator](){return this},next(){return y.next()},throw(g){return y.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return y.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(g){return y.end(g),r!=null&&(r(g),r=void 0),i},get readableLength(){return y.readableLength}},i}var Vi=class extends Error{code;constructor(e,r){super(e),this.code=r}},rs=class extends Vi{type;constructor(e){super(e,"ABORT_ERR"),this.type="aborted"}};function J0(t){let e=tn();t.sink(e).catch(o=>{e.end(o)}),t.sink=async o=>{for await(let s of o)e.push(s);e.end()};let r=t.source;t.source[Symbol.iterator]!=null?r=t.source[Symbol.iterator]():t.source[Symbol.asyncIterator]!=null&&(r=t.source[Symbol.asyncIterator]());let n=new me;return{read:async(o,s)=>{s?.signal?.throwIfAborted();let a,c=new Promise((f,u)=>{a=()=>{u(new rs("Read aborted"))},s?.signal?.addEventListener("abort",a)});try{if(o==null){let{done:u,value:h}=await Promise.race([r.next(),c]);return u===!0?new me:h}for(;n.byteLength<o;){let{value:u,done:h}=await Promise.race([r.next(),c]);if(h===!0)throw new Vi("unexpected end of input","ERR_UNEXPECTED_EOF");n.append(u)}let f=n.sublist(0,o);return n.consume(o),f}finally{a!=null&&s?.signal?.removeEventListener("abort",a)}},write:async(o,s)=>{s?.signal?.throwIfAborted(),o instanceof Uint8Array?e.push(o):e.push(o.subarray()),await e.onEmpty(s)},unwrap:()=>{let o=t.source;return t.source=async function*(){yield*n,yield*o}(),t}}}var qi=class extends Error{code;constructor(e,r){super(e),this.code=r}},j0=t=>Ge.decode(t);j0.bytes=0;function ns(t,e){let r=J0(t);return{read:async i=>{let o=-1,s=new me,a=e?.lengthDecoder??j0;for(;;){s.append(await r.read(1,i));try{o=a(s)}catch(c){if(c instanceof RangeError)continue;throw c}if(o>-1)break;if(e?.maxLengthLength!=null&&s.byteLength>e.maxLengthLength)throw new qi("message length length too long","ERR_MSG_LENGTH_TOO_LONG")}if(e?.maxDataLength!=null&&o>e.maxDataLength)throw new qi("message length too long","ERR_MSG_DATA_TOO_LONG");return r.read(o,i)},write:async(i,o)=>{await r.write(Fi.single(i,e),o)},unwrap:()=>r.unwrap()}}function is(){let t=Jr(),e=!1;return{sink:async r=>{if(e)throw new Error("already piped");e=!0,t.resolve(r)},source:async function*(){yield*await t.promise}()}}function tc(){let t=is(),e=is();return[{source:t.source,sink:e.sink},{source:e.source,sink:t.sink}]}function Up(t){return t[Symbol.asyncIterator]!=null}function kp(...t){let e=[];for(let r of t)Up(r)||e.push(r);return e.length===t.length?function*(){for(let r of e)yield*r}():async function*(){let r=tn({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async n=>{for await(let i of n)r.push(i)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var ec=kp;function rc(t,...e){if(t==null)throw new Error("Empty pipeline");if(os(t)){let n=t;t=()=>n.source}else if(ic(t)||nc(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&os(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)os(r[n])&&(r[n]=Kp(r[n]));return Pp(...r)}var Pp=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},nc=t=>t?.[Symbol.asyncIterator]!=null,ic=t=>t?.[Symbol.iterator]!=null,os=t=>t==null?!1:t.sink!=null&&t.source!=null,Kp=t=>e=>{let r=t.sink(e);if(r?.then!=null){let n=tn({objectMode:!0});r.then(()=>{n.end()},s=>{n.end(s)});let i,o=t.source;if(nc(o))i=async function*(){yield*o,n.end()};else if(ic(o))i=function*(){yield*o,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return ec(n,i())}return t.source};var oc=!!globalThis.process?.env?.DUMP_SESSION_KEYS;var Op=t=>t instanceof Uint8Array;var he=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),sc=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Mp=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Mp)throw new Error("Non little-endian hardware is not supported");function zi(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Gi(t){if(typeof t=="string"&&(t=zi(t)),!Op(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}var Fp=t=>Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object;function ac(t,e){if(e!==void 0&&(typeof e!="object"||!Fp(e)))throw new Error("Options should be object or undefined");return Object.assign(t,e)}function zn(t,e){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");if(typeof e=="number"&&t.length!==e)throw new Error(`Uint8Array length ${e} expected`)}function cc(t,e){if(t.length!==e.length)throw new Error("equalBytes: Different size of Uint8Arrays");let r=!0;for(let n=0;n<t.length;n++)r&&(r=t[n]===e[n]);return r}function ss(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,f=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+f,a,n)}function as(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Hp(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function fc(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Vp(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");as(t.outputLen),as(t.blockLen)}function qp(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function zp(t,e){fc(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Gp={number:as,bool:Hp,bytes:fc,hash:Vp,exists:qp,output:zp},Xt=Gp;var $t=(t,e)=>t[e++]&255|(t[e++]&255)<<8,cs=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Gi(e),zn(e,32);let r=$t(e,0),n=$t(e,2),i=$t(e,4),o=$t(e,6),s=$t(e,8),a=$t(e,10),c=$t(e,12),f=$t(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|o<<9)&8191,this.r[4]=(o>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let u=0;u<8;u++)this.pad[u]=$t(e,16+2*u)}process(e,r,n=!1){let i=n?0:2048,{h:o,r:s}=this,a=s[0],c=s[1],f=s[2],u=s[3],h=s[4],l=s[5],d=s[6],p=s[7],y=s[8],g=s[9],x=$t(e,r+0),E=$t(e,r+2),b=$t(e,r+4),A=$t(e,r+6),v=$t(e,r+8),B=$t(e,r+10),D=$t(e,r+12),L=$t(e,r+14),R=o[0]+(x&8191),$=o[1]+((x>>>13|E<<3)&8191),V=o[2]+((E>>>10|b<<6)&8191),H=o[3]+((b>>>7|A<<9)&8191),z=o[4]+((A>>>4|v<<12)&8191),it=o[5]+(v>>>1&8191),W=o[6]+((v>>>14|B<<2)&8191),Y=o[7]+((B>>>11|D<<5)&8191),U=o[8]+((D>>>8|L<<8)&8191),N=o[9]+(L>>>5|i),S=0,k=S+R*a+$*(5*g)+V*(5*y)+H*(5*p)+z*(5*d);S=k>>>13,k&=8191,k+=it*(5*l)+W*(5*h)+Y*(5*u)+U*(5*f)+N*(5*c),S+=k>>>13,k&=8191;let M=S+R*c+$*a+V*(5*g)+H*(5*y)+z*(5*p);S=M>>>13,M&=8191,M+=it*(5*d)+W*(5*l)+Y*(5*h)+U*(5*u)+N*(5*f),S+=M>>>13,M&=8191;let q=S+R*f+$*c+V*a+H*(5*g)+z*(5*y);S=q>>>13,q&=8191,q+=it*(5*p)+W*(5*d)+Y*(5*l)+U*(5*h)+N*(5*u),S+=q>>>13,q&=8191;let J=S+R*u+$*f+V*c+H*a+z*(5*g);S=J>>>13,J&=8191,J+=it*(5*y)+W*(5*p)+Y*(5*d)+U*(5*l)+N*(5*h),S+=J>>>13,J&=8191;let nt=S+R*h+$*u+V*f+H*c+z*a;S=nt>>>13,nt&=8191,nt+=it*(5*g)+W*(5*y)+Y*(5*p)+U*(5*d)+N*(5*l),S+=nt>>>13,nt&=8191;let ht=S+R*l+$*h+V*u+H*f+z*c;S=ht>>>13,ht&=8191,ht+=it*a+W*(5*g)+Y*(5*y)+U*(5*p)+N*(5*d),S+=ht>>>13,ht&=8191;let et=S+R*d+$*l+V*h+H*u+z*f;S=et>>>13,et&=8191,et+=it*c+W*a+Y*(5*g)+U*(5*y)+N*(5*p),S+=et>>>13,et&=8191;let ct=S+R*p+$*d+V*l+H*h+z*u;S=ct>>>13,ct&=8191,ct+=it*f+W*c+Y*a+U*(5*g)+N*(5*y),S+=ct>>>13,ct&=8191;let Bt=S+R*y+$*p+V*d+H*l+z*h;S=Bt>>>13,Bt&=8191,Bt+=it*u+W*f+Y*c+U*a+N*(5*g),S+=Bt>>>13,Bt&=8191;let Nt=S+R*g+$*y+V*p+H*d+z*l;S=Nt>>>13,Nt&=8191,Nt+=it*h+W*u+Y*f+U*c+N*a,S+=Nt>>>13,Nt&=8191,S=(S<<2)+S|0,S=S+k|0,k=S&8191,S=S>>>13,M+=S,o[0]=k,o[1]=M,o[2]=q,o[3]=J,o[4]=nt,o[5]=ht,o[6]=et,o[7]=ct,o[8]=Bt,o[9]=Nt}finalize(){let{h:e,pad:r}=this,n=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let o=(i^1)-1;for(let a=0;a<10;a++)n[a]&=o;o=~o;for(let a=0;a<10;a++)e[a]=e[a]&o|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let s=e[0]+r[0];e[0]=s&65535;for(let a=1;a<8;a++)s=(e[a]+r[a]|0)+(s>>>16)|0,e[a]=s&65535}update(e){Xt.exists(this);let{buffer:r,blockLen:n}=this;e=Gi(e);let i=e.length;for(let o=0;o<i;){let s=Math.min(n-this.pos,i-o);if(s===n){for(;n<=i-o;o+=n)this.process(e,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){Xt.exists(this),Xt.output(e,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let o=0;for(let s=0;s<8;s++)e[o++]=n[s]>>>0,e[o++]=n[s]>>>8;return e}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}};function $p(t){let e=(n,i)=>t(i).update(Gi(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}var uc=$p(t=>new cs(t));var Wp=zi("expand 16-byte k"),Zp=zi("expand 32-byte k"),Yp=he(Wp),Xp=he(Zp),hc=t=>!(t.byteOffset%4),en=t=>{let{core:e,rounds:r,counterRight:n,counterLen:i,allow128bitKeys:o,extendNonceFn:s,blockLen:a}=ac({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},t);Xt.number(i),Xt.number(r),Xt.number(a),Xt.bool(n),Xt.bool(o);let c=a/4;if(a%4!==0)throw new Error("Salsa/ChaCha: blockLen should be aligned to 4 bytes");return(f,u,h,l,d=0)=>{if(Xt.bytes(f),Xt.bytes(u),Xt.bytes(h),l||(l=new Uint8Array(h.length)),Xt.bytes(l),Xt.number(d),d<0||d>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(l.length<h.length)throw new Error(`Salsa/ChaCha: output (${l.length}) is shorter than data (${h.length})`);let p=[],y,g;if(f.length===32)y=f,g=Xp;else if(f.length===16&&o)y=new Uint8Array(32),y.set(f),y.set(f,16),g=Yp,p.push(y);else throw new Error(`Salsa/ChaCha: wrong key length=${f.length}, expected`);if(s){if(u.length<=16)throw new Error("Salsa/ChaCha: extended nonce should be bigger than 16 bytes");y=s(g,y,u.subarray(0,16),new Uint8Array(32)),p.push(y),u=u.subarray(16)}let x=16-i;if(u.length!==x)throw new Error(`Salsa/ChaCha: nonce should be ${x} or 16 bytes`);if(x!==12){let R=new Uint8Array(12);R.set(u,n?0:12-u.length),p.push(u=R)}let E=new Uint8Array(a),b=he(E),A=he(y),v=he(u),B=hc(h)&&he(h),D=hc(l)&&he(l);p.push(b);let L=h.length;for(let R=0,$=d;R<L;$++){if(e(g,A,v,b,$,r),$>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");let V=Math.min(a,L-R);if(V===a&&D&&B){let H=R/4;if(R%4!==0)throw new Error("Salsa/ChaCha: wrong block position");for(let z=0;z<c;z++)D[H+z]=B[H+z]^b[z];R+=a;continue}for(let H=0;H<V;H++)l[R+H]=h[R+H]^E[H];R+=V}for(let R=0;R<p.length;R++)p[R].fill(0);return l}};var F=(t,e)=>t<<e|t>>>32-e;function Gn(t,e,r,n,i,o=20){let s=t[0],a=t[1],c=t[2],f=t[3],u=e[0],h=e[1],l=e[2],d=e[3],p=e[4],y=e[5],g=e[6],x=e[7],E=i,b=r[0],A=r[1],v=r[2],B=s,D=a,L=c,R=f,$=u,V=h,H=l,z=d,it=p,W=y,Y=g,U=x,N=E,S=b,k=A,M=v;for(let J=0;J<o;J+=2)B=B+$|0,N=F(N^B,16),it=it+N|0,$=F($^it,12),B=B+$|0,N=F(N^B,8),it=it+N|0,$=F($^it,7),D=D+V|0,S=F(S^D,16),W=W+S|0,V=F(V^W,12),D=D+V|0,S=F(S^D,8),W=W+S|0,V=F(V^W,7),L=L+H|0,k=F(k^L,16),Y=Y+k|0,H=F(H^Y,12),L=L+H|0,k=F(k^L,8),Y=Y+k|0,H=F(H^Y,7),R=R+z|0,M=F(M^R,16),U=U+M|0,z=F(z^U,12),R=R+z|0,M=F(M^R,8),U=U+M|0,z=F(z^U,7),B=B+V|0,M=F(M^B,16),Y=Y+M|0,V=F(V^Y,12),B=B+V|0,M=F(M^B,8),Y=Y+M|0,V=F(V^Y,7),D=D+H|0,N=F(N^D,16),U=U+N|0,H=F(H^U,12),D=D+H|0,N=F(N^D,8),U=U+N|0,H=F(H^U,7),L=L+z|0,S=F(S^L,16),it=it+S|0,z=F(z^it,12),L=L+z|0,S=F(S^L,8),it=it+S|0,z=F(z^it,7),R=R+$|0,k=F(k^R,16),W=W+k|0,$=F($^W,12),R=R+$|0,k=F(k^R,8),W=W+k|0,$=F($^W,7);let q=0;n[q++]=s+B|0,n[q++]=a+D|0,n[q++]=c+L|0,n[q++]=f+R|0,n[q++]=u+$|0,n[q++]=h+V|0,n[q++]=l+H|0,n[q++]=d+z|0,n[q++]=p+it|0,n[q++]=y+W|0,n[q++]=g+Y|0,n[q++]=x+U|0,n[q++]=E+N|0,n[q++]=b+S|0,n[q++]=A+k|0,n[q++]=v+M|0}function Qp(t,e,r,n){let i=he(e),o=he(r),s=he(n),a=t[0],c=t[1],f=t[2],u=t[3],h=i[0],l=i[1],d=i[2],p=i[3],y=i[4],g=i[5],x=i[6],E=i[7],b=o[0],A=o[1],v=o[2],B=o[3];for(let D=0;D<20;D+=2)a=a+h|0,b=F(b^a,16),y=y+b|0,h=F(h^y,12),a=a+h|0,b=F(b^a,8),y=y+b|0,h=F(h^y,7),c=c+l|0,A=F(A^c,16),g=g+A|0,l=F(l^g,12),c=c+l|0,A=F(A^c,8),g=g+A|0,l=F(l^g,7),f=f+d|0,v=F(v^f,16),x=x+v|0,d=F(d^x,12),f=f+d|0,v=F(v^f,8),x=x+v|0,d=F(d^x,7),u=u+p|0,B=F(B^u,16),E=E+B|0,p=F(p^E,12),u=u+p|0,B=F(B^u,8),E=E+B|0,p=F(p^E,7),a=a+l|0,B=F(B^a,16),x=x+B|0,l=F(l^x,12),a=a+l|0,B=F(B^a,8),x=x+B|0,l=F(l^x,7),c=c+d|0,b=F(b^c,16),E=E+b|0,d=F(d^E,12),c=c+d|0,b=F(b^c,8),E=E+b|0,d=F(d^E,7),f=f+p|0,A=F(A^f,16),y=y+A|0,p=F(p^y,12),f=f+p|0,A=F(A^f,8),y=y+A|0,p=F(p^y,7),u=u+h|0,v=F(v^u,16),g=g+v|0,h=F(h^g,12),u=u+h|0,v=F(v^u,8),g=g+v|0,h=F(h^g,7);return s[0]=a,s[1]=c,s[2]=f,s[3]=u,s[4]=b,s[5]=A,s[6]=v,s[7]=B,n}var Nw=en({core:Gn,counterRight:!1,counterLen:8}),Jp=en({core:Gn,counterRight:!1,counterLen:4,allow128bitKeys:!1}),jp=en({core:Gn,counterRight:!1,counterLen:8,extendNonceFn:Qp,allow128bitKeys:!1}),Dw=en({core:Gn,counterRight:!1,counterLen:4,rounds:8}),Uw=en({core:Gn,counterRight:!1,counterLen:4,rounds:12}),td=new Uint8Array(16),lc=(t,e)=>{t.update(e);let r=e.length%16;r&&t.update(td.subarray(r))},pc=(t,e,r,n,i)=>{let o=t(e,r,new Uint8Array(32)),s=uc.create(o);i&&lc(s,i),lc(s,n);let a=new Uint8Array(16),c=sc(a);ss(c,0,BigInt(i?i.length:0),!0),ss(c,8,BigInt(n.length),!0),s.update(a);let f=s.digest();return o.fill(0),f},dc=t=>(e,r,n)=>(zn(e,32),zn(r),{tagLength:16,encrypt:o=>{let s=new Uint8Array(o.length+16);t(e,r,o,s,1);let a=pc(t,e,r,s.subarray(0,-16),n);return s.set(a,o.length),s},decrypt:o=>{if(o.length<16)throw new Error("Encrypted data should be at least 16");let s=o.subarray(-16),a=o.subarray(0,-16),c=pc(t,e,r,a,n);if(!cc(s,c))throw new Error("Wrong tag");return t(e,r,a,void 0,1)}}),fs=dc(Jp),kw=dc(jp);function us(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function ed(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function yc(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function rd(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");us(t.outputLen),us(t.blockLen)}function nd(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function id(t,e){yc(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var od={number:us,bool:ed,bytes:yc,hash:rd,exists:nd,output:id},ie=od;var $i=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var gc=t=>t instanceof Uint8Array;var Wi=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),be=(t,e)=>t<<32-e|t>>>e,sd=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!sd)throw new Error("Non little-endian hardware is not supported");var Fw=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function hs(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function nr(t){if(typeof t=="string"&&(t=hs(t)),!gc(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function xc(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!gc(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var rn=class{clone(){return this._cloneInto()}};function ir(t){let e=n=>t().update(nr(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ls(t=32){if($i&&typeof $i.getRandomValues=="function")return $i.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function ad(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,f=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+f,a,n)}var nn=class extends rn{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Wi(this.buffer)}update(e){ie.exists(this);let{view:r,buffer:n,blockLen:i}=this;e=nr(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let c=Wi(e);for(;i<=o-s;s+=i)this.process(c,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ie.exists(this),ie.output(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)r[h]=0;ad(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=Wi(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<f;h++)a.setUint32(4*h,u[h],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};var Zi=BigInt(4294967295),ps=BigInt(32);function mc(t,e=!1){return e?{h:Number(t&Zi),l:Number(t>>ps&Zi)}:{h:Number(t>>ps&Zi)|0,l:Number(t&Zi)|0}}function cd(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=mc(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}var fd=(t,e)=>BigInt(t>>>0)<<ps|BigInt(e>>>0),ud=(t,e,r)=>t>>>r,hd=(t,e,r)=>t<<32-r|e>>>r,ld=(t,e,r)=>t>>>r|e<<32-r,pd=(t,e,r)=>t<<32-r|e>>>r,dd=(t,e,r)=>t<<64-r|e>>>r-32,yd=(t,e,r)=>t>>>r-32|e<<64-r,gd=(t,e)=>e,xd=(t,e)=>t,md=(t,e,r)=>t<<r|e>>>32-r,bd=(t,e,r)=>e<<r|t>>>32-r,wd=(t,e,r)=>e<<r-32|t>>>64-r,vd=(t,e,r)=>t<<r-32|e>>>64-r;function Ed(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var Sd=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Bd=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Ad=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Cd=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,Id=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),Td=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0,_d={fromBig:mc,split:cd,toBig:fd,shrSH:ud,shrSL:hd,rotrSH:ld,rotrSL:pd,rotrBH:dd,rotrBL:yd,rotr32H:gd,rotr32L:xd,rotlSH:md,rotlSL:bd,rotlBH:wd,rotlBL:vd,add:Ed,add3L:Sd,add3H:Bd,add4L:Ad,add4H:Cd,add5H:Td,add5L:Id},j=_d;var[Ld,Rd]=j.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),or=new Uint32Array(80),sr=new Uint32Array(80),on=class extends nn{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:c,Eh:f,El:u,Fh:h,Fl:l,Gh:d,Gl:p,Hh:y,Hl:g}=this;return[e,r,n,i,o,s,a,c,f,u,h,l,d,p,y,g]}set(e,r,n,i,o,s,a,c,f,u,h,l,d,p,y,g){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=d|0,this.Gl=p|0,this.Hh=y|0,this.Hl=g|0}process(e,r){for(let b=0;b<16;b++,r+=4)or[b]=e.getUint32(r),sr[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let A=or[b-15]|0,v=sr[b-15]|0,B=j.rotrSH(A,v,1)^j.rotrSH(A,v,8)^j.shrSH(A,v,7),D=j.rotrSL(A,v,1)^j.rotrSL(A,v,8)^j.shrSL(A,v,7),L=or[b-2]|0,R=sr[b-2]|0,$=j.rotrSH(L,R,19)^j.rotrBH(L,R,61)^j.shrSH(L,R,6),V=j.rotrSL(L,R,19)^j.rotrBL(L,R,61)^j.shrSL(L,R,6),H=j.add4L(D,V,sr[b-7],sr[b-16]),z=j.add4H(H,B,$,or[b-7],or[b-16]);or[b]=z|0,sr[b]=H|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:c,Dh:f,Dl:u,Eh:h,El:l,Fh:d,Fl:p,Gh:y,Gl:g,Hh:x,Hl:E}=this;for(let b=0;b<80;b++){let A=j.rotrSH(h,l,14)^j.rotrSH(h,l,18)^j.rotrBH(h,l,41),v=j.rotrSL(h,l,14)^j.rotrSL(h,l,18)^j.rotrBL(h,l,41),B=h&d^~h&y,D=l&p^~l&g,L=j.add5L(E,v,D,Rd[b],sr[b]),R=j.add5H(L,x,A,B,Ld[b],or[b]),$=L|0,V=j.rotrSH(n,i,28)^j.rotrBH(n,i,34)^j.rotrBH(n,i,39),H=j.rotrSL(n,i,28)^j.rotrBL(n,i,34)^j.rotrBL(n,i,39),z=n&o^n&a^o&a,it=i&s^i&c^s&c;x=y|0,E=g|0,y=d|0,g=p|0,d=h|0,p=l|0,{h,l}=j.add(f|0,u|0,R|0,$|0),f=a|0,u=c|0,a=o|0,c=s|0,o=n|0,s=i|0;let W=j.add3L($,H,it);n=j.add3H(W,R,V,z),i=W|0}({h:n,l:i}=j.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=j.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:c}=j.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=j.add(this.Dh|0,this.Dl|0,f|0,u|0),{h,l}=j.add(this.Eh|0,this.El|0,h|0,l|0),{h:d,l:p}=j.add(this.Fh|0,this.Fl|0,d|0,p|0),{h:y,l:g}=j.add(this.Gh|0,this.Gl|0,y|0,g|0),{h:x,l:E}=j.add(this.Hh|0,this.Hl|0,x|0,E|0),this.set(n,i,o,s,a,c,f,u,h,l,d,p,y,g,x,E)}roundClean(){or.fill(0),sr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},ds=class extends on{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},ys=class extends on{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},gs=class extends on{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}},xs=ir(()=>new on),Yw=ir(()=>new ds),Xw=ir(()=>new ys),Qw=ir(()=>new gs);var jw=BigInt(0),Nd=BigInt(1),Dd=BigInt(2),Yi=t=>t instanceof Uint8Array,Ud=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function $n(t){if(!Yi(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Ud[t[r]];return e}function bc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function wc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,o=t.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function ms(t){return bc($n(t))}function _e(t){if(!Yi(t))throw new Error("Uint8Array expected");return bc($n(Uint8Array.from(t).reverse()))}function bs(t,e){return wc(t.toString(16).padStart(e*2,"0"))}function ar(t,e){return bs(t,e).reverse()}function ee(t,e,r){let n;if(typeof e=="string")try{n=wc(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(Yi(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Xi(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Yi(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var vc=t=>(Dd<<BigInt(t-1))-Nd;var kd={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function $e(t,e,r={}){let n=(i,o,s)=>{let a=kd[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let c=t[i];if(!(s&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}var Kt=BigInt(0),Tt=BigInt(1),_r=BigInt(2),Kd=BigInt(3),ws=BigInt(4),Ec=BigInt(5),Sc=BigInt(8),Od=BigInt(9),Md=BigInt(16);function xt(t,e){let r=t%e;return r>=Kt?r:e+r}function vs(t,e,r){if(r<=Kt||e<Kt)throw new Error("Expected power/modulo > 0");if(r===Tt)return Kt;let n=Tt;for(;e>Kt;)e&Tt&&(n=n*t%r),t=t*t%r,e>>=Tt;return n}function le(t,e,r){let n=t;for(;e-- >Kt;)n*=n,n%=r;return n}function Bc(t,e){if(t===Kt||e<=Kt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=xt(t,e),n=e,i=Kt,o=Tt,s=Tt,a=Kt;for(;r!==Kt;){let f=n/r,u=n%r,h=i-s*f,l=o-a*f;n=r,r=u,i=s,o=a,s=h,a=l}if(n!==Tt)throw new Error("invert: does not exist");return xt(i,e)}function Fd(t){let e=(t-Tt)/_r,r,n,i;for(r=t-Tt,n=0;r%_r===Kt;r/=_r,n++);for(i=_r;i<t&&vs(i,e,t)!==t-Tt;i++);if(n===1){let s=(t+Tt)/ws;return function(c,f){let u=c.pow(f,s);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}let o=(r+Tt)/_r;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,u=a.pow(a.mul(a.ONE,i),r),h=a.pow(c,o),l=a.pow(c,r);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let d=1;for(let y=a.sqr(l);d<f&&!a.eql(y,a.ONE);d++)y=a.sqr(y);let p=a.pow(u,Tt<<BigInt(f-d-1));u=a.sqr(p),h=a.mul(h,p),l=a.mul(l,u),f=d}return h}}function Hd(t){if(t%ws===Kd){let e=(t+Tt)/ws;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%Sc===Ec){let e=(t-Ec)/Sc;return function(n,i){let o=n.mul(i,_r),s=n.pow(o,e),a=n.mul(i,s),c=n.mul(n.mul(a,_r),s),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),i))throw new Error("Cannot find square root");return f}}return t%Md,Fd(t)}var Ac=(t,e)=>(xt(t,e)&Tt)===Tt,Vd=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Cc(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Vd.reduce((n,i)=>(n[i]="function",n),e);return $e(t,r)}function qd(t,e,r){if(r<Kt)throw new Error("Expected power > 0");if(r===Kt)return t.ONE;if(r===Tt)return e;let n=t.ONE,i=e;for(;r>Kt;)r&Tt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Tt;return n}function zd(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}function Es(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Ic(t,e,r=!1,n={}){if(t<=Kt)throw new Error(`Expected Fp ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=Es(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=Hd(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:vc(i),ZERO:Kt,ONE:Tt,create:c=>xt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Kt<=c&&c<t},is0:c=>c===Kt,isOdd:c=>(c&Tt)===Tt,neg:c=>xt(-c,t),eql:(c,f)=>c===f,sqr:c=>xt(c*c,t),add:(c,f)=>xt(c+f,t),sub:(c,f)=>xt(c-f,t),mul:(c,f)=>xt(c*f,t),pow:(c,f)=>qd(a,c,f),div:(c,f)=>xt(c*Bc(f,t),t),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>Bc(c,t),sqrt:n.sqrt||(c=>s(a,c)),invertBatch:c=>zd(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>r?ar(c,o):bs(c,o),fromBytes:c=>{if(c.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${c.length}`);return r?_e(c):ms(c)}});return Object.freeze(a)}function Tc(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}var Gd=BigInt(0),Ss=BigInt(1);function _c(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>Gd;)o&Ss&&(s=s.add(a)),a=a.double(),o>>=Ss;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),c=[],f=i,u=f;for(let h=0;h<s;h++){u=f,c.push(u);for(let l=1;l<a;l++)u=u.add(f),c.push(u);f=u.double()}return c},wNAF(i,o,s){let{windows:a,windowSize:c}=n(i),f=t.ZERO,u=t.BASE,h=BigInt(2**i-1),l=2**i,d=BigInt(i);for(let p=0;p<a;p++){let y=p*c,g=Number(s&h);s>>=d,g>c&&(g-=l,s+=Ss);let x=y,E=y+Math.abs(g)-1,b=p%2!==0,A=g<0;g===0?u=u.add(r(b,o[x])):f=f.add(r(A,o[E]))}return{p:f,f:u}},wNAFCached(i,o,s,a){let c=i._WINDOW_SIZE||1,f=o.get(i);return f||(f=this.precomputeWindow(i,c),c!==1&&o.set(i,a(f))),this.wNAF(c,f,s)}}}function Lc(t){return Cc(t.Fp),$e(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Es(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var we=BigInt(0),oe=BigInt(1),Qi=BigInt(2),$d=BigInt(8),Wd={zip215:!0};function Zd(t){let e=Lc(t);return $e(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Ji(t){let e=Zd(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=e,f=Qi<<BigInt(a*8)-oe,u=r.create,h=e.uvRatio||((N,S)=>{try{return{isValid:!0,value:r.sqrt(N*r.inv(S))}}catch{return{isValid:!1,value:we}}}),l=e.adjustScalarBytes||(N=>N),d=e.domain||((N,S,k)=>{if(S.length||k)throw new Error("Contexts/pre-hash are not supported");return N}),p=N=>typeof N=="bigint"&&we<N,y=(N,S)=>p(N)&&p(S)&&N<S,g=N=>N===we||y(N,f);function x(N,S){if(y(N,S))return N;throw new Error(`Expected valid scalar < ${S}, got ${typeof N} ${N}`)}function E(N){return N===we?N:x(N,n)}let b=new Map;function A(N){if(!(N instanceof v))throw new Error("ExtendedPoint expected")}class v{constructor(S,k,M,q){if(this.ex=S,this.ey=k,this.ez=M,this.et=q,!g(S))throw new Error("x required");if(!g(k))throw new Error("y required");if(!g(M))throw new Error("z required");if(!g(q))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(S){if(S instanceof v)throw new Error("extended point not allowed");let{x:k,y:M}=S||{};if(!g(k)||!g(M))throw new Error("invalid affine point");return new v(k,M,oe,u(k*M))}static normalizeZ(S){let k=r.invertBatch(S.map(M=>M.ez));return S.map((M,q)=>M.toAffine(k[q])).map(v.fromAffine)}_setWindowSize(S){this._WINDOW_SIZE=S,b.delete(this)}assertValidity(){let{a:S,d:k}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:M,ey:q,ez:J,et:nt}=this,ht=u(M*M),et=u(q*q),ct=u(J*J),Bt=u(ct*ct),Nt=u(ht*S),Te=u(ct*u(Nt+et)),te=u(Bt+u(k*u(ht*et)));if(Te!==te)throw new Error("bad point: equation left != right (1)");let er=u(M*q),qe=u(J*nt);if(er!==qe)throw new Error("bad point: equation left != right (2)")}equals(S){A(S);let{ex:k,ey:M,ez:q}=this,{ex:J,ey:nt,ez:ht}=S,et=u(k*ht),ct=u(J*q),Bt=u(M*ht),Nt=u(nt*q);return et===ct&&Bt===Nt}is0(){return this.equals(v.ZERO)}negate(){return new v(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:S}=e,{ex:k,ey:M,ez:q}=this,J=u(k*k),nt=u(M*M),ht=u(Qi*u(q*q)),et=u(S*J),ct=k+M,Bt=u(u(ct*ct)-J-nt),Nt=et+nt,Te=Nt-ht,te=et-nt,er=u(Bt*Te),qe=u(Nt*te),Di=u(Bt*te),Ui=u(Te*Nt);return new v(er,qe,Ui,Di)}add(S){A(S);let{a:k,d:M}=e,{ex:q,ey:J,ez:nt,et:ht}=this,{ex:et,ey:ct,ez:Bt,et:Nt}=S;if(k===BigInt(-1)){let O0=u((J-q)*(ct+et)),M0=u((J+q)*(ct-et)),jo=u(M0-O0);if(jo===we)return this.double();let F0=u(nt*Qi*Nt),H0=u(ht*Qi*Bt),V0=H0+F0,q0=M0+O0,z0=H0-F0,up=u(V0*jo),hp=u(q0*z0),lp=u(V0*z0),pp=u(jo*q0);return new v(up,hp,pp,lp)}let Te=u(q*et),te=u(J*ct),er=u(ht*M*Nt),qe=u(nt*Bt),Di=u((q+J)*(et+ct)-Te-te),Ui=qe-er,P0=qe+er,K0=u(te-k*Te),sp=u(Di*Ui),ap=u(P0*K0),cp=u(Di*K0),fp=u(Ui*P0);return new v(sp,ap,fp,cp)}subtract(S){return this.add(S.negate())}wNAF(S){return L.wNAFCached(this,b,S,v.normalizeZ)}multiply(S){let{p:k,f:M}=this.wNAF(x(S,n));return v.normalizeZ([k,M])[0]}multiplyUnsafe(S){let k=E(S);return k===we?D:this.equals(D)||k===oe?this:this.equals(B)?this.wNAF(k).p:L.unsafeLadder(this,k)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return L.unsafeLadder(this,n).is0()}toAffine(S){let{ex:k,ey:M,ez:q}=this,J=this.is0();S==null&&(S=J?$d:r.inv(q));let nt=u(k*S),ht=u(M*S),et=u(q*S);if(J)return{x:we,y:oe};if(et!==oe)throw new Error("invZ was invalid");return{x:nt,y:ht}}clearCofactor(){let{h:S}=e;return S===oe?this:this.multiplyUnsafe(S)}static fromHex(S,k=!1){let{d:M,a:q}=e,J=r.BYTES;S=ee("pointHex",S,J);let nt=S.slice(),ht=S[J-1];nt[J-1]=ht&-129;let et=_e(nt);et===we||(k?x(et,f):x(et,r.ORDER));let ct=u(et*et),Bt=u(ct-oe),Nt=u(M*ct-q),{isValid:Te,value:te}=h(Bt,Nt);if(!Te)throw new Error("Point.fromHex: invalid y coordinate");let er=(te&oe)===oe,qe=(ht&128)!==0;if(!k&&te===we&&qe)throw new Error("Point.fromHex: x=0 and x_0=1");return qe!==er&&(te=u(-te)),v.fromAffine({x:te,y:et})}static fromPrivateKey(S){return V(S).point}toRawBytes(){let{x:S,y:k}=this.toAffine(),M=ar(k,r.BYTES);return M[M.length-1]|=S&oe?128:0,M}toHex(){return $n(this.toRawBytes())}}v.BASE=new v(e.Gx,e.Gy,oe,u(e.Gx*e.Gy)),v.ZERO=new v(we,oe,oe,we);let{BASE:B,ZERO:D}=v,L=_c(v,a*8);function R(N){return xt(N,n)}function $(N){return R(_e(N))}function V(N){let S=a;N=ee("private key",N,S);let k=ee("hashed private key",o(N),2*S),M=l(k.slice(0,S)),q=k.slice(S,2*S),J=$(M),nt=B.multiply(J),ht=nt.toRawBytes();return{head:M,prefix:q,scalar:J,point:nt,pointBytes:ht}}function H(N){return V(N).pointBytes}function z(N=new Uint8Array,...S){let k=Xi(...S);return $(o(d(k,ee("context",N),!!i)))}function it(N,S,k={}){N=ee("message",N),i&&(N=i(N));let{prefix:M,scalar:q,pointBytes:J}=V(S),nt=z(k.context,M,N),ht=B.multiply(nt).toRawBytes(),et=z(k.context,ht,J,N),ct=R(nt+et*q);E(ct);let Bt=Xi(ht,ar(ct,r.BYTES));return ee("result",Bt,a*2)}let W=Wd;function Y(N,S,k,M=W){let{context:q,zip215:J}=M,nt=r.BYTES;N=ee("signature",N,2*nt),S=ee("message",S),i&&(S=i(S));let ht=_e(N.slice(nt,2*nt)),et,ct,Bt;try{et=v.fromHex(k,J),ct=v.fromHex(N.slice(0,nt),J),Bt=B.multiplyUnsafe(ht)}catch{return!1}if(!J&&et.isSmallOrder())return!1;let Nt=z(q,ct.toRawBytes(),et.toRawBytes(),S);return ct.add(et.multiplyUnsafe(Nt)).subtract(Bt).clearCofactor().equals(v.ZERO)}return B._setWindowSize(8),{CURVE:e,getPublicKey:H,sign:it,verify:Y,ExtendedPoint:v,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>s(r.BYTES),precompute(N=8,S=v.BASE){return S._setWindowSize(N),S.multiply(BigInt(3)),S}}}}var Wn=BigInt(0),Bs=BigInt(1);function Yd(t){return $e(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function Rc(t){let e=Yd(t),{P:r}=e,n=b=>xt(b,r),i=e.montgomeryBits,o=Math.ceil(i/8),s=e.nByteLength,a=e.adjustScalarBytes||(b=>b),c=e.powPminus2||(b=>vs(b,r-BigInt(2),r));function f(b,A,v){let B=n(b*(A-v));return A=n(A-B),v=n(v+B),[A,v]}function u(b){if(typeof b=="bigint"&&Wn<=b&&b<r)return b;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(e.a-BigInt(2))/BigInt(4);function l(b,A){let v=u(b),B=u(A),D=v,L=Bs,R=Wn,$=v,V=Bs,H=Wn,z;for(let W=BigInt(i-1);W>=Wn;W--){let Y=B>>W&Bs;H^=Y,z=f(H,L,$),L=z[0],$=z[1],z=f(H,R,V),R=z[0],V=z[1],H=Y;let U=L+R,N=n(U*U),S=L-R,k=n(S*S),M=N-k,q=$+V,J=$-V,nt=n(J*U),ht=n(q*S),et=nt+ht,ct=nt-ht;$=n(et*et),V=n(D*n(ct*ct)),L=n(N*k),R=n(M*(N+n(h*M)))}z=f(H,L,$),L=z[0],$=z[1],z=f(H,R,V),R=z[0],V=z[1];let it=c(R);return n(L*it)}function d(b){return ar(n(b),o)}function p(b){let A=ee("u coordinate",b,o);return s===o&&(A[s-1]&=127),_e(A)}function y(b){let A=ee("scalar",b);if(A.length!==o&&A.length!==s)throw new Error(`Expected ${o} or ${s} bytes, got ${A.length}`);return _e(a(A))}function g(b,A){let v=p(A),B=y(b),D=l(v,B);if(D===Wn)throw new Error("Invalid private or public key received");return d(D)}let x=d(e.Gu);function E(b){return g(b,x)}return{scalarMult:g,scalarMultBase:E,getSharedSecret:(b,A)=>g(b,A),getPublicKey:b=>E(b),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:x}}var Zn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Nc=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Cv=BigInt(0),Xd=BigInt(1),As=BigInt(2),Qd=BigInt(5),Dc=BigInt(10),Jd=BigInt(20),jd=BigInt(40),Uc=BigInt(80);function kc(t){let e=Zn,n=t*t%e*t%e,i=le(n,As,e)*n%e,o=le(i,Xd,e)*t%e,s=le(o,Qd,e)*o%e,a=le(s,Dc,e)*s%e,c=le(a,Jd,e)*a%e,f=le(c,jd,e)*c%e,u=le(f,Uc,e)*f%e,h=le(u,Uc,e)*f%e,l=le(h,Dc,e)*s%e;return{pow_p_5_8:le(l,As,e)*t%e,b2:n}}function Pc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function ty(t,e){let r=Zn,n=xt(e*e*e,r),i=xt(n*n*e,r),o=kc(t*i).pow_p_5_8,s=xt(t*n*o,r),a=xt(e*s*s,r),c=s,f=xt(s*Nc,r),u=a===t,h=a===xt(-t,r),l=a===xt(-t*Nc,r);return u&&(s=c),(h||l)&&(s=f),Ac(s,r)&&(s=xt(-s,r)),{isValid:u||h,value:s}}var We=Ic(Zn,void 0,!0),Cs={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:We,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:xs,randomBytes:ls,adjustScalarBytes:Pc,uvRatio:ty},Iv=Ji(Cs);function Kc(t,e,r){if(e.length>255)throw new Error("Context is too big");return xc(hs("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var Tv=Ji({...Cs,domain:Kc}),_v=Ji({...Cs,domain:Kc,prehash:xs}),Yn=(()=>Rc({P:Zn,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let e=Zn,{pow_p_5_8:r,b2:n}=kc(t);return xt(le(r,BigInt(3),e)*n,e)},adjustScalarBytes:Pc,randomBytes:ls}))();var ey=(We.ORDER+BigInt(3))/BigInt(8),Lv=We.pow(As,ey),Rv=We.sqrt(We.neg(We.ONE)),Nv=(We.ORDER-BigInt(5))/BigInt(8),Dv=BigInt(486662);var Uv=Tc(We,We.neg(BigInt(486664)));var kv=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Pv=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Kv=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Ov=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var Mv=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var ji=class extends rn{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,ie.hash(e);let n=nr(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return ie.exists(this),this.iHash.update(e),this}digestInto(e){ie.exists(this),ie.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},to=(t,e,r)=>new ji(t,e).update(r).digest();to.create=(t,e)=>new ji(t,e);function Mc(t,e,r){return ie.hash(t),r===void 0&&(r=new Uint8Array(t.outputLen)),to(t,nr(r),nr(e))}var Is=new Uint8Array([0]),Oc=new Uint8Array;function Fc(t,e,r,n=32){if(ie.hash(t),ie.number(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(n/t.outputLen);r===void 0&&(r=Oc);let o=new Uint8Array(i*t.outputLen),s=to.create(t,e),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let f=0;f<i;f++)Is[0]=f+1,a.update(f===0?Oc:c).update(r).update(Is).digestInto(c),o.set(c,t.outputLen*f),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),Is.fill(0),o.slice(0,n)}var ry=(t,e,r)=>t&e^~t&r,ny=(t,e,r)=>t&e^t&r^e&r,iy=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),cr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),fr=new Uint32Array(64),eo=class extends nn{constructor(){super(64,32,8,!1),this.A=cr[0]|0,this.B=cr[1]|0,this.C=cr[2]|0,this.D=cr[3]|0,this.E=cr[4]|0,this.F=cr[5]|0,this.G=cr[6]|0,this.H=cr[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:c}=this;return[e,r,n,i,o,s,a,c]}set(e,r,n,i,o,s,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)fr[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let l=fr[h-15],d=fr[h-2],p=be(l,7)^be(l,18)^l>>>3,y=be(d,17)^be(d,19)^d>>>10;fr[h]=y+fr[h-7]+p+fr[h-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:c,G:f,H:u}=this;for(let h=0;h<64;h++){let l=be(a,6)^be(a,11)^be(a,25),d=u+l+ry(a,c,f)+iy[h]+fr[h]|0,y=(be(n,2)^be(n,13)^be(n,22))+ny(n,i,o)|0;u=f,f=c,c=a,a=s+d|0,s=o,o=i,i=n,n=d+y|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,c,f,u)}roundClean(){fr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Ts=class extends eo{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},ro=ir(()=>new eo),Xv=ir(()=>new Ts);var no={hashSHA256(t){return ro(t)},getHKDF(t,e){let r=Mc(ro,e,t),i=Fc(ro,r,void 0,96),o=i.subarray(0,32),s=i.subarray(32,64),a=i.subarray(64,96);return[o,s,a]},generateX25519KeyPair(){let t=Yn.utils.randomPrivateKey();return{publicKey:Yn.getPublicKey(t),privateKey:t}},generateX25519KeyPairFromSeed(t){return{publicKey:Yn.getPublicKey(t),privateKey:t}},generateX25519SharedKey(t,e){return Yn.getSharedSecret(t,e)},chaCha20Poly1305Encrypt(t,e,r,n){return fs(n,e,r).encrypt(t)},chaCha20Poly1305Decrypt(t,e,r,n,i){let o=fs(n,e,r).decrypt(t);return i&&i.set(o),o}};var oy=t=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t),sn=t=>{let e=oy(2);return new DataView(e.buffer,e.byteOffset,e.byteLength).setUint16(0,t,!1),e};sn.bytes=2;var Xn=t=>{if(t.length<2)throw RangeError("Could not decode int16BE");return t instanceof Uint8Array?new DataView(t.buffer,t.byteOffset,t.byteLength).getUint16(0,!1):t.getUint16(0)};Xn.bytes=2;function Hc(t){return Pt([t.ne,t.ciphertext],t.ne.length+t.ciphertext.length)}function Vc(t){return Pt([t.ne,t.ns,t.ciphertext],t.ne.length+t.ns.length+t.ciphertext.length)}function qc(t){return Pt([t.ns,t.ciphertext],t.ns.length+t.ciphertext.length)}function zc(t){if(t.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:t.subarray(0,32),ciphertext:t.subarray(32,t.length),ns:new Uint8Array(0)}}function Gc(t){if(t.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:t.subarray(0,32),ns:t.subarray(32,80),ciphertext:t.subarray(80,t.length)}}function $c(t){if(t.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:t.subarray(0,48),ciphertext:t.subarray(48,t.length)}}var Zc=16;function Yc(t,e){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65519){let o=i+65519;o>n.length&&(o=n.length);let s=t.encrypt(n.subarray(i,o),t.session);e?.encryptedPackets.increment(),yield sn(s.byteLength),yield s}}}function Xc(t,e){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65535){let o=i+65535;if(o>n.length&&(o=n.length),o-Zc<i)throw new Error("Invalid chunk");let s=n.subarray(i,o),a=n.subarray(i,o-Zc),{plaintext:c,valid:f}=t.decrypt(s,t.session,a);if(!f)throw e?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");e?.decryptedPackets.increment(),yield c}}}var dt=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}},Jn=class t extends Error{code;constructor(e="Unexpected Peer"){super(e),this.code=t.code}static code="ERR_UNEXPECTED_PEER"},Lr=class t extends Error{code;constructor(e="Invalid crypto exchange"){super(e),this.code=t.code}static code="ERR_INVALID_CRYPTO_EXCHANGE"};var NE=It(ri(),1),DE=It(pu(),1);var Am=It(yt(),1);var ea={};pt(ea,{identity:()=>kg});function Lg(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,g=0,x=0,E=p.length;x!==E&&p[x]===0;)x++,y++;for(var b=(E-x)*u+1>>>0,A=new Uint8Array(b);x!==E;){for(var v=p[x],B=0,D=b-1;(v!==0||B<g)&&D!==-1;D--,B++)v+=256*A[D]>>>0,A[D]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");g=B,x++}for(var L=b-g;L!==b&&A[L]===0;)L++;for(var R=c.repeat(y);L<b;++L)R+=t.charAt(A[L]);return R}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var g=0,x=0;p[y]===c;)g++,y++;for(var E=(p.length-y)*f+1>>>0,b=new Uint8Array(E);p[y];){var A=r[p.charCodeAt(y)];if(A===255)return;for(var v=0,B=E-1;(A!==0||v<x)&&B!==-1;B--,v++)A+=a*b[B]>>>0,b[B]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");x=v,y++}if(p[y]!==" "){for(var D=E-x;D!==E&&b[D]===0;)D++;for(var L=new Uint8Array(g+(E-D)),R=g;D!==E;)L[R++]=b[D++];return L}}}function d(p){var y=l(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Rg=Lg,Ng=Rg,du=Ng;var k8=new Uint8Array(0);var yu=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Qe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var gu=t=>new TextEncoder().encode(t),xu=t=>new TextDecoder().decode(t);var Qs=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Js=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return bu(this,e)}},js=class{constructor(e){this.decoders=e}or(e){return bu(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},bu=(t,e)=>new js({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),ta=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Qs(e,r,n),this.decoder=new Js(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},ln=({name:t,prefix:e,encode:r,decode:n})=>new ta(t,e,r,n),dr=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=du(r,e);return ln({prefix:t,name:e,encode:n,decode:o=>Qe(i(o))})},Dg=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,c=0,f=0;for(let u=0;u<o;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,s[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},Ug=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},_t=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ln({prefix:e,name:t,encode(i){return Ug(i,n,r)},decode(i){return Dg(i,n,r,t)}});var kg=ln({prefix:"\0",name:"identity",encode:t=>xu(t),decode:t=>gu(t)});var ra={};pt(ra,{base2:()=>Pg});var Pg=_t({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var na={};pt(na,{base8:()=>Kg});var Kg=_t({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ia={};pt(ia,{base10:()=>Og});var Og=dr({prefix:"9",name:"base10",alphabet:"0123456789"});var oa={};pt(oa,{base16:()=>Mg,base16upper:()=>Fg});var Mg=_t({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Fg=_t({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var sa={};pt(sa,{base32:()=>pn,base32hex:()=>zg,base32hexpad:()=>$g,base32hexpadupper:()=>Wg,base32hexupper:()=>Gg,base32pad:()=>Vg,base32padupper:()=>qg,base32upper:()=>Hg,base32z:()=>Zg});var pn=_t({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hg=_t({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Vg=_t({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qg=_t({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zg=_t({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Gg=_t({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$g=_t({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Wg=_t({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Zg=_t({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var aa={};pt(aa,{base36:()=>Yg,base36upper:()=>Xg});var Yg=dr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xg=dr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ca={};pt(ca,{base58btc:()=>Pe,base58flickr:()=>Qg});var Pe=dr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Qg=dr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var fa={};pt(fa,{base64:()=>Jg,base64pad:()=>jg,base64url:()=>t2,base64urlpad:()=>e2});var Jg=_t({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),jg=_t({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),t2=_t({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),e2=_t({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ua={};pt(ua,{base256emoji:()=>s2});var wu=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),r2=wu.reduce((t,e,r)=>(t[r]=e,t),[]),n2=wu.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function i2(t){return t.reduce((e,r)=>(e+=r2[r],e),"")}function o2(t){let e=[];for(let r of t){let n=n2[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var s2=ln({prefix:"\u{1F680}",name:"base256emoji",encode:i2,decode:o2});var da={};pt(da,{sha256:()=>A2,sha512:()=>C2});var a2=Su,vu=128,c2=127,f2=~c2,u2=Math.pow(2,31);function Su(t,e,r){e=e||[],r=r||0;for(var n=r;t>=u2;)e[r++]=t&255|vu,t/=128;for(;t&f2;)e[r++]=t&255|vu,t>>>=7;return e[r]=t|0,Su.bytes=r-n+1,e}var h2=ha,l2=128,Eu=127;function ha(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw ha.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&Eu)<<i:(s&Eu)*Math.pow(2,i),i+=7}while(s>=l2);return ha.bytes=o-n,r}var p2=Math.pow(2,7),d2=Math.pow(2,14),y2=Math.pow(2,21),g2=Math.pow(2,28),x2=Math.pow(2,35),m2=Math.pow(2,42),b2=Math.pow(2,49),w2=Math.pow(2,56),v2=Math.pow(2,63),E2=function(t){return t<p2?1:t<d2?2:t<y2?3:t<g2?4:t<x2?5:t<m2?6:t<b2?7:t<w2?8:t<v2?9:10},S2={encode:a2,decode:h2,encodingLength:E2},B2=S2,oi=B2;var si=(t,e=0)=>[oi.decode(t,e),oi.decode.bytes],dn=(t,e,r=0)=>(oi.encode(t,e,r),e),yn=t=>oi.encodingLength(t);var Pr=(t,e)=>{let r=e.byteLength,n=yn(t),i=n+yn(r),o=new Uint8Array(i+r);return dn(t,o,0),dn(r,o,n),o.set(e,i),new gn(t,r,e,o)},Bu=t=>{let e=Qe(t),[r,n]=si(e),[i,o]=si(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new gn(r,i,s,e)},Au=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&yu(t.bytes,r.bytes)}},gn=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var pa=({name:t,code:e,encode:r})=>new la(t,e,r),la=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Pr(this.code,r):r.then(n=>Pr(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Iu=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),A2=pa({name:"sha2-256",code:18,encode:Iu("SHA-256")}),C2=pa({name:"sha2-512",code:19,encode:Iu("SHA-512")});var ya={};pt(ya,{identity:()=>_2});var Tu=0,I2="identity",_u=Qe,T2=t=>Pr(Tu,_u(t)),_2={code:Tu,name:I2,encode:_u,digest:T2};var r3=new TextEncoder,n3=new TextDecoder;var Lu=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return D2(r,ga(t),e||Pe.encoder);default:return U2(r,ga(t),e||pn.encoder)}};var Ru=new WeakMap,ga=t=>{let e=Ru.get(t);if(e==null){let r=new Map;return Ru.set(t,r),r}return e},So=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==ci)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==k2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Pr(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Au(e.multihash,n.multihash)}toString(e){return Lu(this,e)}toJSON(){return{"/":Lu(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s||Nu(n,i,o.bytes))}else if(r[P2]===!0){let{version:n,multihash:i,code:o}=r,s=Bu(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==ci)throw new Error(`Version 0 CID must use dag-pb (code: ${ci}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=Nu(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,ci,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=Qe(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new gn(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=si(e.subarray(r));return r+=l,h},i=n(),o=ci;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),c=n(),f=r+c,u=f-s;return{version:i,codec:o,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,i]=N2(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return ga(o).set(n,e),o}},N2=(t,e)=>{switch(t[0]){case"Q":{let r=e||Pe;return[Pe.prefix,r.decode(`${Pe.prefix}${t}`)]}case Pe.prefix:{let r=e||Pe;return[Pe.prefix,r.decode(t)]}case pn.prefix:{let r=e||pn;return[pn.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},D2=(t,e,r)=>{let{prefix:n}=r;if(n!==Pe.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},U2=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},ci=112,k2=18,Nu=(t,e,r)=>{let n=yn(t),i=n+yn(e),o=new Uint8Array(i+r.byteLength);return dn(t,o,0),dn(e,o,n),o.set(r,i),o},P2=Symbol.for("@ipld/js-cid/CID");var xa={...ea,...ra,...na,...ia,...oa,...sa,...aa,...ca,...fa,...ua},p3={...da,...ya};function Uu(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Du=Uu("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),ma=Uu("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=ue(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),K2={utf8:Du,"utf-8":Du,hex:xa.base16,latin1:ma,ascii:ma,binary:ma,...xa},Bo=K2;function Wt(t,e="utf8"){let r=Bo[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?rr(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var i0={};pt(i0,{Ed25519PrivateKey:()=>zr,Ed25519PublicKey:()=>bi,generateKeyPair:()=>Gx,generateKeyPairFromSeed:()=>tl,unmarshalEd25519PrivateKey:()=>qx,unmarshalEd25519PublicKey:()=>zx});var Sa={};pt(Sa,{base58btc:()=>Zt,base58flickr:()=>q2});function O2(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,g=0,x=0,E=p.length;x!==E&&p[x]===0;)x++,y++;for(var b=(E-x)*u+1>>>0,A=new Uint8Array(b);x!==E;){for(var v=p[x],B=0,D=b-1;(v!==0||B<g)&&D!==-1;D--,B++)v+=256*A[D]>>>0,A[D]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");g=B,x++}for(var L=b-g;L!==b&&A[L]===0;)L++;for(var R=c.repeat(y);L<b;++L)R+=t.charAt(A[L]);return R}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var g=0,x=0;p[y]===c;)g++,y++;for(var E=(p.length-y)*f+1>>>0,b=new Uint8Array(E);p[y];){var A=r[p.charCodeAt(y)];if(A===255)return;for(var v=0,B=E-1;(A!==0||v<x)&&B!==-1;B--,v++)A+=a*b[B]>>>0,b[B]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");x=v,y++}if(p[y]!==" "){for(var D=E-x;D!==E&&b[D]===0;)D++;for(var L=new Uint8Array(g+(E-D)),R=g;D!==E;)L[R++]=b[D++];return L}}}function d(p){var y=l(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var M2=O2,F2=M2,ku=F2;var E3=new Uint8Array(0);var Pu=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Je=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Ku=t=>new TextEncoder().encode(t),Ou=t=>new TextDecoder().decode(t);var ba=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},wa=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Fu(this,e)}},va=class{constructor(e){this.decoders=e}or(e){return Fu(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Fu=(t,e)=>new va({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Ea=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new ba(e,r,n),this.decoder=new wa(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},xn=({name:t,prefix:e,encode:r,decode:n})=>new Ea(t,e,r,n),yr=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=ku(r,e);return xn({prefix:t,name:e,encode:n,decode:o=>Je(i(o))})},H2=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,c=0,f=0;for(let u=0;u<o;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,s[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},V2=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},Lt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>xn({prefix:e,name:t,encode(i){return V2(i,n,r)},decode(i){return H2(i,n,r,t)}});var Zt=yr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),q2=yr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Aa={};pt(Aa,{identity:()=>gr});var z2=qu,Hu=128,G2=127,$2=~G2,W2=Math.pow(2,31);function qu(t,e,r){e=e||[],r=r||0;for(var n=r;t>=W2;)e[r++]=t&255|Hu,t/=128;for(;t&$2;)e[r++]=t&255|Hu,t>>>=7;return e[r]=t|0,qu.bytes=r-n+1,e}var Z2=Ba,Y2=128,Vu=127;function Ba(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw Ba.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&Vu)<<i:(s&Vu)*Math.pow(2,i),i+=7}while(s>=Y2);return Ba.bytes=o-n,r}var X2=Math.pow(2,7),Q2=Math.pow(2,14),J2=Math.pow(2,21),j2=Math.pow(2,28),tx=Math.pow(2,35),ex=Math.pow(2,42),rx=Math.pow(2,49),nx=Math.pow(2,56),ix=Math.pow(2,63),ox=function(t){return t<X2?1:t<Q2?2:t<J2?3:t<j2?4:t<tx?5:t<ex?6:t<rx?7:t<nx?8:t<ix?9:10},sx={encode:z2,decode:Z2,encodingLength:ox},ax=sx,fi=ax;var ui=(t,e=0)=>[fi.decode(t,e),fi.decode.bytes],mn=(t,e,r=0)=>(fi.encode(t,e,r),e),bn=t=>fi.encodingLength(t);var Ke=(t,e)=>{let r=e.byteLength,n=bn(t),i=n+bn(r),o=new Uint8Array(i+r);return mn(t,o,0),mn(r,o,n),o.set(e,i),new wn(t,r,e,o)},hi=t=>{let e=Je(t),[r,n]=ui(e),[i,o]=ui(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new wn(r,i,s,e)},zu=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Pu(t.bytes,r.bytes)}},wn=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var Gu=0,cx="identity",$u=Je,fx=t=>Ke(Gu,$u(t)),gr={code:Gu,name:cx,encode:$u,digest:fx};var Ta={};pt(Ta,{sha256:()=>Yt,sha512:()=>ux});var Ia=({name:t,code:e,encode:r})=>new Ca(t,e,r),Ca=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Ke(this.code,r):r.then(n=>Ke(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Zu=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Yt=Ia({name:"sha2-256",code:18,encode:Zu("SHA-256")}),ux=Ia({name:"sha2-512",code:19,encode:Zu("SHA-512")});var hx=It(fn(),1);var qt=BigInt(0),st=BigInt(1),br=BigInt(2),lx=BigInt(8),Yu=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),bt=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Yu,n:Yu,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var th=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),li=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),N3=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),px=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),dx=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),yx=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),gx=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Ot=class t{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof Dt))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Dt.ZERO)?t.ZERO:new t(e.x,e.y,st,T(e.x*e.y))}static toAffineBatch(e){let r=bx(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){Qu(e);let{x:r,y:n,z:i}=this,{x:o,y:s,z:a}=e,c=T(r*a),f=T(o*i),u=T(n*a),h=T(s*i);return c===f&&u===h}negate(){return new t(T(-this.x),this.y,this.z,T(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=bt,o=T(e*e),s=T(r*r),a=T(br*T(n*n)),c=T(i*o),f=e+r,u=T(T(f*f)-o-s),h=c+s,l=h-a,d=c-s,p=T(u*l),y=T(h*d),g=T(u*d),x=T(l*h);return new t(p,y,x,g)}add(e){Qu(e);let{x:r,y:n,z:i,t:o}=this,{x:s,y:a,z:c,t:f}=e,u=T((n-r)*(a+s)),h=T((n+r)*(a-s)),l=T(h-u);if(l===qt)return this.double();let d=T(i*br*f),p=T(o*br*c),y=p+d,g=h+u,x=p-d,E=T(y*l),b=T(g*x),A=T(y*x),v=T(l*g);return new t(E,b,v,A)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,o=i;for(let s=0;s<r;s++){o=i,n.push(o);for(let a=1;a<2**(e-1);a++)o=o.add(i),n.push(o);i=o.double()}return n}wNAF(e,r){!r&&this.equals(t.BASE)&&(r=Dt.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Da.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=t.normalizeZ(i),Da.set(r,i)));let o=t.ZERO,s=t.BASE,a=1+256/n,c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*c,p=Number(e&f);e>>=h,p>c&&(p-=u,e+=st);let y=d,g=d+Math.abs(p)-1,x=l%2!==0,E=p<0;p===0?s=s.add(Xu(x,i[y])):o=o.add(Xu(E,i[g]))}return t.normalizeZ([o,s])[0]}multiply(e,r){return this.wNAF(Io(e,bt.l),r)}multiplyUnsafe(e){let r=Io(e,bt.l,!1),n=t.BASE,i=t.ZERO;if(r===qt)return i;if(this.equals(i)||r===st)return this;if(this.equals(n))return this.wNAF(r);let o=i,s=this;for(;r>qt;)r&st&&(o=o.add(s)),s=s.double(),r>>=st;return o}isSmallOrder(){return this.multiplyUnsafe(bt.h).equals(t.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(bt.l/br).double();return bt.l%br&&(e=e.add(this)),e.equals(t.ZERO)}toAffine(e){let{x:r,y:n,z:i}=this,o=this.equals(t.ZERO);e==null&&(e=o?lx:To(i));let s=T(r*e),a=T(n*e),c=T(i*e);if(o)return Dt.ZERO;if(c!==st)throw new Error("invZ was invalid");return new Dt(s,a)}fromRistrettoBytes(){La()}toRistrettoBytes(){La()}fromRistrettoHash(){La()}};Ot.BASE=new Ot(bt.Gx,bt.Gy,st,T(bt.Gx*bt.Gy));Ot.ZERO=new Ot(qt,st,st,qt);function Xu(t,e){let r=e.negate();return t?r:e}function Qu(t){if(!(t instanceof Ot))throw new TypeError("ExtendedPoint expected")}function _a(t){if(!(t instanceof Kr))throw new TypeError("RistrettoPoint expected")}function La(){throw new Error("Legacy method: switch to RistrettoPoint")}var Kr=class t{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=bt,n=T(li*e*e),i=T((n+st)*yx),o=BigInt(-1),s=T((o-r*n)*T(n+r)),{isValid:a,value:c}=ka(i,s),f=T(c*e);mr(f)||(f=T(-f)),a||(c=f),a||(o=n);let u=T(o*(n-st)*gx-s),h=c*c,l=T((c+c)*s),d=T(u*px),p=T(st-h),y=T(st+h);return new Ot(T(l*y),T(p*d),T(d*y),T(l*p))}static hashToCurve(e){e=wr(e,64);let r=Ra(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=Ra(e.slice(32,64)),o=this.calcElligatorRistrettoMap(i);return new t(n.add(o))}static fromHex(e){e=wr(e,32);let{a:r,d:n}=bt,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",o=Ra(e);if(!vx(di(o),e)||mr(o))throw new Error(i);let s=T(o*o),a=T(st+r*s),c=T(st-r*s),f=T(a*a),u=T(c*c),h=T(r*n*f-u),{isValid:l,value:d}=ju(T(h*u)),p=T(d*c),y=T(d*p*h),g=T((o+o)*p);mr(g)&&(g=T(-g));let x=T(a*y),E=T(g*x);if(!l||mr(E)||x===qt)throw new Error(i);return new t(new Ot(g,x,st,E))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,o=T(T(n+r)*T(n-r)),s=T(e*r),a=T(s*s),{value:c}=ju(T(o*a)),f=T(c*o),u=T(c*s),h=T(f*u*i),l;if(mr(i*h)){let p=T(r*li),y=T(e*li);e=p,r=y,l=T(f*dx)}else l=u;mr(e*h)&&(r=T(-r));let d=T((n-r)*l);return mr(d)&&(d=T(-d)),di(d)}toHex(){return yi(this.toRawBytes())}toString(){return this.toHex()}equals(e){_a(e);let r=this.ep,n=e.ep,i=T(r.x*n.y)===T(r.y*n.x),o=T(r.y*n.y)===T(r.x*n.x);return i||o}add(e){return _a(e),new t(this.ep.add(e.ep))}subtract(e){return _a(e),new t(this.ep.subtract(e.ep))}multiply(e){return new t(this.ep.multiply(e))}multiplyUnsafe(e){return new t(this.ep.multiplyUnsafe(e))}};Kr.BASE=new Kr(Ot.BASE);Kr.ZERO=new Kr(Ot.ZERO);var Da=new WeakMap,Dt=class t{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Da.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=bt;e=wr(e,32);let o=e.slice();o[31]=e[31]&-129;let s=gi(o);if(r&&s>=i)throw new Error("Expected 0 < hex < P");if(!r&&s>=th)throw new Error("Expected 0 < hex < 2**256");let a=T(s*s),c=T(a-st),f=T(n*a+st),{isValid:u,value:h}=ka(c,f);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&st)===st;return(e[31]&128)!==0!==l&&(h=T(-h)),new t(h,s)}static async fromPrivateKey(e){return(await _o(e)).point}toRawBytes(){let e=di(this.y);return e[31]|=this.x&st?128:0,e}toHex(){return yi(this.toRawBytes())}toX25519(){let{y:e}=this,r=T((st+e)*To(st-e));return di(r)}isTorsionFree(){return Ot.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new t(T(-this.x),this.y)}add(e){return Ot.fromAffine(this).add(Ot.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Ot.fromAffine(this).multiply(e,this).toAffine()}};Dt.BASE=new Dt(bt.Gx,bt.Gy);Dt.ZERO=new Dt(qt,st);var pi=class t{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=wr(e,64),n=Dt.fromHex(r.slice(0,32),!1),i=gi(r.slice(32,64));return new t(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof Dt))throw new Error("Expected Point instance");return Io(r,bt.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(di(this.s),32),e}toHex(){return yi(this.toRawBytes())}};function Ju(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}var xx=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function yi(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=xx[t[r]];return e}function Ua(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[r]=o}return e}function eh(t){let r=t.toString(16).padStart(64,"0");return Ua(r)}function di(t){return eh(t).reverse()}function mr(t){return(T(t)&st)===st}function gi(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+yi(Uint8Array.from(t).reverse()))}var mx=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Ra(t){return T(gi(t)&mx)}function T(t,e=bt.P){let r=t%e;return r>=qt?r:e+r}function To(t,e=bt.P){if(t===qt||e<=qt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=T(t,e),n=e,i=qt,o=st,s=st,a=qt;for(;r!==qt;){let f=n/r,u=n%r,h=i-s*f,l=o-a*f;n=r,r=u,i=s,o=a,s=h,a=l}if(n!==st)throw new Error("invert: does not exist");return T(i,e)}function bx(t,e=bt.P){let r=new Array(t.length),n=t.reduce((o,s,a)=>s===qt?o:(r[a]=o,T(o*s,e)),st),i=To(n,e);return t.reduceRight((o,s,a)=>s===qt?o:(r[a]=T(o*r[a],e),T(o*s,e)),i),r}function Oe(t,e){let{P:r}=bt,n=t;for(;e-- >qt;)n*=n,n%=r;return n}function wx(t){let{P:e}=bt,r=BigInt(5),n=BigInt(10),i=BigInt(20),o=BigInt(40),s=BigInt(80),c=t*t%e*t%e,f=Oe(c,br)*c%e,u=Oe(f,st)*t%e,h=Oe(u,r)*u%e,l=Oe(h,n)*h%e,d=Oe(l,i)*l%e,p=Oe(d,o)*d%e,y=Oe(p,s)*p%e,g=Oe(y,s)*p%e,x=Oe(g,n)*h%e;return{pow_p_5_8:Oe(x,br)*t%e,b2:c}}function ka(t,e){let r=T(e*e*e),n=T(r*r*e),i=wx(t*n).pow_p_5_8,o=T(t*r*i),s=T(e*o*o),a=o,c=T(o*li),f=s===t,u=s===T(-t),h=s===T(-t*li);return f&&(o=a),(u||h)&&(o=c),mr(o)&&(o=T(-o)),{isValid:f||u,value:o}}function ju(t){return ka(st,t)}function Co(t){return T(gi(t),bt.l)}function vx(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function wr(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):Ua(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Io(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(qt<t)return t}else if(qt<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Ex(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Sx(t){if(t=typeof t=="bigint"||typeof t=="number"?eh(Io(t,th)):wr(t),t.length!==32)throw new Error("Expected 32 bytes");return t}function Bx(t){let e=Ex(t.slice(0,32)),r=t.slice(32,64),n=Co(e),i=Dt.BASE.multiply(n),o=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:o}}var Na;async function _o(t){return Bx(await vr.sha512(Sx(t)))}async function Pa(t){return(await _o(t)).pointBytes}async function rh(t,e){t=wr(t);let{prefix:r,scalar:n,pointBytes:i}=await _o(e),o=Co(await vr.sha512(r,t)),s=Dt.BASE.multiply(o),a=Co(await vr.sha512(s.toRawBytes(),i,t)),c=T(o+a*n,bt.l);return new pi(s,c).toRawBytes()}function Ax(t,e,r){e=wr(e),r instanceof Dt||(r=Dt.fromHex(r,!1));let{r:n,s:i}=t instanceof pi?t.assertValidity():pi.fromHex(t),o=Ot.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:o,pub:r,msg:e}}function Cx(t,e,r,n){let i=Co(n),o=Ot.fromAffine(t).multiplyUnsafe(i);return Ot.fromAffine(e).add(o).subtract(r).multiplyUnsafe(bt.h).equals(Ot.ZERO)}async function nh(t,e,r){let{r:n,SB:i,msg:o,pub:s}=Ax(t,e,r),a=await vr.sha512(n.toRawBytes(),s.toRawBytes(),o);return Cx(s,n,i,a)}Dt.BASE._setWindowSize(8);var xr={node:hx,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},vr={bytesToHex:yi,hexToBytes:Ua,concatBytes:Ju,getExtendedPublicKey:_o,mod:T,invert:To,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if(t=wr(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return T(gi(t),bt.l-st)+st},randomBytes:(t=32)=>{if(xr.web)return xr.web.getRandomValues(new Uint8Array(t));if(xr.node){let{randomBytes:e}=xr.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>vr.randomBytes(32),sha512:async(...t)=>{let e=Ju(...t);if(xr.web){let r=await xr.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(r)}else{if(xr.node)return Uint8Array.from(xr.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=Dt.BASE){let r=e.equals(Dt.BASE)?e:new Dt(e.x,e.y);return r._setWindowSize(t),r.multiply(br),r},sha512Sync:void 0};Object.defineProperties(vr,{sha512Sync:{configurable:!1,get(){return Na},set(t){Na||(Na=t)}}});var En=32,je=64,Lo=32;async function ih(){let t=vr.randomPrivateKey(),e=await Pa(t);return{privateKey:ch(t,e),publicKey:e}}async function oh(t){if(t.length!==Lo)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Pa(e);return{privateKey:ch(e,r),publicKey:r}}async function sh(t,e){let r=t.subarray(0,Lo);return rh(e,r)}async function ah(t,e,r){return nh(e,r,t)}function ch(t,e){let r=new Uint8Array(je);for(let n=0;n<Lo;n++)r[n]=t[n],r[Lo+n]=e[n];return r}var Ka={};pt(Ka,{base64:()=>Sn,base64pad:()=>_x,base64url:()=>Lx,base64urlpad:()=>Rx});var Sn=Lt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_x=Lt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Lx=Lt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Rx=Lt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ne={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Oa={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Ma(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",o=t?.saltLength??16,s=t?.iterations??32767,a=ne.get();r*=8;async function c(h,l){let d=a.getRandomValues(new Uint8Array(o)),p=a.getRandomValues(new Uint8Array(n)),y={name:e,iv:p};typeof l=="string"&&(l=Wt(l));let g;if(l.length===0){g=await a.subtle.importKey("jwk",Oa,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}catch{g=await a.subtle.importKey("jwk",Oa,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}let x=await a.subtle.encrypt(y,g,h);return Pt([d,y.iv,new Uint8Array(x)])}async function f(h,l){let d=h.subarray(0,o),p=h.subarray(o,o+n),y=h.subarray(o+n),g={name:e,iv:p};typeof l=="string"&&(l=Wt(l));let x;if(l.length===0)try{let b={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},A=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(b,A,{name:e,length:r},!0,["decrypt"])}catch{x=await a.subtle.importKey("jwk",Oa,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},A=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(b,A,{name:e,length:r},!0,["decrypt"])}let E=await a.subtle.decrypt(g,x,y);return new Uint8Array(E)}return{encrypt:c,decrypt:f}}async function Bn(t,e){let n=await Ma().encrypt(t,e);return Sn.encode(n)}var Ja=It(za(),1),Xh=It(Vh(),1),Qh=It(Mr(),1),ja=It(Qa(),1),Jh=It(Yh(),1);function Fx(){Qh.default._configure(),Ja.default._configure(Xh.default),ja.default._configure(Jh.default)}Fx();var jh=["uint64","int64","sint64","fixed64","sfixed64"];function Hx(t){for(let e of jh){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function t0(t){return Hx(new Ja.default(t))}function Vx(t){for(let e of jh){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function e0(){return Vx(ja.default.create())}function Hr(t,e){let r=t0(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Vr(t,e){let r=e0();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Cn;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Cn||(Cn={}));function ko(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function r0(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return ko("enum",Cn.VARINT,r,n)}function qr(t,e){return ko("message",Cn.LENGTH_DELIMITED,t,e)}var St;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(St||(St={}));var n0;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(n0||(n0={}));(function(t){t.codec=()=>r0(n0)})(St||(St={}));var He;(function(t){let e;t.codec=()=>(e==null&&(e=qr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),St.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=St.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Vr(r,t.codec()),t.decode=r=>Hr(r,t.codec())})(He||(He={}));var Ve;(function(t){let e;t.codec=()=>(e==null&&(e=qr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),St.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=St.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Vr(r,t.codec()),t.decode=r=>Hr(r,t.codec())})(Ve||(Ve={}));var bi=class{_key;constructor(e){this._key=In(e,En)}async verify(e,r){return ah(this._key,r,e)}marshal(){return this._key}get bytes(){return He.encode({Type:St.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Mt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Yt.digest(this.bytes);return e}},zr=class{_key;_publicKey;constructor(e,r){this._key=In(e,je),this._publicKey=In(r,En)}async sign(e){return sh(this._key,e)}get public(){return new bi(this._publicKey)}marshal(){return this._key}get bytes(){return Ve.encode({Type:St.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Mt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Yt.digest(this.bytes);return e}async id(){let e=gr.digest(this.public.bytes);return Zt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Bn(this.bytes,e);throw new dt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function qx(t){if(t.length>je){t=In(t,je+En);let n=t.subarray(0,je),i=t.subarray(je,t.length);return new zr(n,i)}t=In(t,je);let e=t.subarray(0,je),r=t.subarray(En);return new zr(e,r)}function zx(t){return t=In(t,En),new bi(t)}async function Gx(){let{privateKey:t,publicKey:e}=await ih();return new zr(t,e)}async function tl(t){let{privateKey:e,publicKey:r}=await oh(t);return new zr(e,r)}function In(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new dt(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}function At(t,e="utf8"){let r=Bo[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var S4=It(kt(),1),B4=It(mo(),1),el=It(yt(),1);function Ae(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Pt([new Uint8Array(e-r.length),r])}return At(r,"base64url")}function se(t){let e=rl(t);return new el.default.jsbn.BigInteger(At(e,"base16"),16)}function rl(t,e){let r=Wt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Pt([new Uint8Array(e-r.length),r])}return r}var $x={"P-256":256,"P-384":384,"P-521":521},Wx=Object.keys($x),k4=Wx.join(" / ");var y0={};pt(y0,{RsaPrivateKey:()=>kn,RsaPublicKey:()=>Ci,fromJwk:()=>bm,generateKeyPair:()=>wm,unmarshalRsaPrivateKey:()=>xm,unmarshalRsaPublicKey:()=>mm});var Ai=It(yt(),1);var bE=It(al(),1);var Xx=It(fn(),1);var at=BigInt(0),vt=BigInt(1),Ar=BigInt(2),Ei=BigInt(3),cl=BigInt(8),Rt=Object.freeze({a:at,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:vt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),fl=(t,e)=>(t+e/Ar)/e,Ko={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){let{n:e}=Rt,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-vt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=fl(o*t,e),c=fl(-n*t,e),f=O(t-a*r-c*i,e),u=O(-a*n-c*o,e),h=f>s,l=u>s;if(h&&(f=e-f),l&&(u=e-u),f>s||u>s)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:f,k2neg:l,k2:u}}},Ce=32,Rn=32,Qx=32,ul=Ce+1,hl=2*Ce+1;function ll(t){let{a:e,b:r}=Rt,n=O(t*t),i=O(n*t);return O(i+e*t+r)}var Oo=Rt.a===at,Ho=class extends Error{constructor(e){super(e)}};function pl(t){if(!(t instanceof jt))throw new TypeError("JacobianPoint expected")}var jt=class t{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof Ct))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(Ct.ZERO)?t.ZERO:new t(e.x,e.y,vt)}static toAffineBatch(e){let r=rm(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return t.toAffineBatch(e).map(t.fromAffine)}equals(e){pl(e);let{x:r,y:n,z:i}=this,{x:o,y:s,z:a}=e,c=O(i*i),f=O(a*a),u=O(r*f),h=O(o*c),l=O(O(n*a)*f),d=O(O(s*i)*c);return u===h&&l===d}negate(){return new t(this.x,O(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=O(e*e),o=O(r*r),s=O(o*o),a=e+o,c=O(Ar*(O(a*a)-i-s)),f=O(Ei*i),u=O(f*f),h=O(u-Ar*c),l=O(f*(c-h)-cl*s),d=O(Ar*r*n);return new t(h,l,d)}add(e){pl(e);let{x:r,y:n,z:i}=this,{x:o,y:s,z:a}=e;if(o===at||s===at)return this;if(r===at||n===at)return e;let c=O(i*i),f=O(a*a),u=O(r*f),h=O(o*c),l=O(O(n*a)*f),d=O(O(s*i)*c),p=O(h-u),y=O(d-l);if(p===at)return y===at?this.double():t.ZERO;let g=O(p*p),x=O(p*g),E=O(u*g),b=O(y*y-x-Ar*E),A=O(y*(E-b)-l*x),v=O(i*a*p);return new t(b,A,v)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=t.ZERO;if(typeof e=="bigint"&&e===at)return r;let n=gl(e);if(n===vt)return this;if(!Oo){let h=r,l=this;for(;n>at;)n&vt&&(h=h.add(l)),l=l.double(),n>>=vt;return h}let{k1neg:i,k1:o,k2neg:s,k2:a}=Ko.splitScalar(n),c=r,f=r,u=this;for(;o>at||a>at;)o&vt&&(c=c.add(u)),a&vt&&(f=f.add(u)),u=u.double(),o>>=vt,a>>=vt;return i&&(c=c.negate()),s&&(f=f.negate()),f=new t(O(f.x*Ko.beta),f.y,f.z),c.add(f)}precomputeWindow(e){let r=Oo?128/e+1:256/e+1,n=[],i=this,o=i;for(let s=0;s<r;s++){o=i,n.push(o);for(let a=1;a<2**(e-1);a++)o=o.add(i),n.push(o);i=o.double()}return n}wNAF(e,r){!r&&this.equals(t.BASE)&&(r=Ct.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&c0.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=t.normalizeZ(i),c0.set(r,i)));let o=t.ZERO,s=t.BASE,a=1+(Oo?128/n:256/n),c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*c,p=Number(e&f);e>>=h,p>c&&(p-=u,e+=vt);let y=d,g=d+Math.abs(p)-1,x=l%2!==0,E=p<0;p===0?s=s.add(Mo(x,i[y])):o=o.add(Mo(E,i[g]))}return{p:o,f:s}}multiply(e,r){let n=gl(e),i,o;if(Oo){let{k1neg:s,k1:a,k2neg:c,k2:f}=Ko.splitScalar(n),{p:u,f:h}=this.wNAF(a,r),{p:l,f:d}=this.wNAF(f,r);u=Mo(s,u),l=Mo(c,l),l=new t(O(l.x*Ko.beta),l.y,l.z),i=u.add(l),o=h.add(d)}else{let{p:s,f:a}=this.wNAF(n,r);i=s,o=a}return t.normalizeZ([i,o])[0]}toAffine(e){let{x:r,y:n,z:i}=this,o=this.equals(t.ZERO);e==null&&(e=o?cl:Un(i));let s=e,a=O(s*s),c=O(a*s),f=O(r*a),u=O(n*c),h=O(i*s);if(o)return Ct.ZERO;if(h!==vt)throw new Error("invZ was invalid");return new Ct(f,u)}};jt.BASE=new jt(Rt.Gx,Rt.Gy,vt);jt.ZERO=new jt(at,vt,at);function Mo(t,e){let r=e.negate();return t?r:e}var c0=new WeakMap,Ct=class t{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,c0.delete(this)}hasEvenY(){return this.y%Ar===at}static fromCompressedHex(e){let r=e.length===32,n=Cr(r?e:e.subarray(1));if(!a0(n))throw new Error("Point is not on curve");let i=ll(n),o=em(i),s=(o&vt)===vt;r?s&&(o=O(-o)):(e[0]&1)===1!==s&&(o=O(-o));let a=new t(n,o);return a.assertValidity(),a}static fromUncompressedHex(e){let r=Cr(e.subarray(1,Ce+1)),n=Cr(e.subarray(Ce+1,Ce*2+1)),i=new t(r,n);return i.assertValidity(),i}static fromHex(e){let r=Dn(e),n=r.length,i=r[0];if(n===Ce)return this.fromCompressedHex(r);if(n===ul&&(i===2||i===3))return this.fromCompressedHex(r);if(n===hl&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${ul} compressed bytes or ${hl} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return t.BASE.multiply(qo(e))}static fromSignature(e,r,n){let{r:i,s:o}=xl(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let s=h0(Dn(e)),{n:a}=Rt,c=n===2||n===3?i+a:i,f=Un(c,a),u=O(-s*f,a),h=O(o*f,a),l=n&1?"03":"02",d=t.fromHex(l+_n(c)),p=t.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return $r(this.toHex(e))}toHex(e=!1){let r=_n(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${_n(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!a0(r)||!a0(n))throw new Error(e);let i=O(n*n),o=ll(r);if(O(i-o)!==at)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new t(this.x,O(-this.y))}double(){return jt.fromAffine(this).double().toAffine()}add(e){return jt.fromAffine(this).add(jt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return jt.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=jt.fromAffine(this),o=r===at||r===vt||this!==t.BASE?i.multiplyUnsafe(r):i.multiply(r),s=jt.fromAffine(e).multiplyUnsafe(n),a=o.add(s);return a.equals(jt.ZERO)?void 0:a.toAffine()}};Ct.BASE=new Ct(Rt.Gx,Rt.Gy);Ct.ZERO=new Ct(at,at);function dl(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function yl(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${Nn(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Cr(r),left:t.subarray(e+2)}}function Jx(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${Nn(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=yl(t.subarray(2)),{data:n,left:i}=yl(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Nn(i)}`);return{r:e,s:n}}var Tn=class t{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?Nn(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new t(Vo(i.slice(0,64)),Vo(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=Jx(r?e:$r(e));return new t(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Bi(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Bi(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=Rt.n>>vt;return this.s>e}normalizeS(){return this.hasHighS()?new t(this.r,O(-this.s,Rt.n)):this}toDERRawBytes(){return $r(this.toDERHex())}toDERHex(){let e=dl(vi(this.s)),r=dl(vi(this.r)),n=e.length/2,i=r.length/2,o=vi(n),s=vi(i);return`30${vi(i+n+4)}02${s}${r}02${o}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return $r(this.toCompactHex())}toCompactHex(){return _n(this.r)+_n(this.s)}};function Br(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}var jx=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Nn(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=jx[t[r]];return e}var tm=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function _n(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(at<=t&&t<tm))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function f0(t){let e=$r(_n(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function vi(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Vo(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function $r(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[r]=o}return e}function Cr(t){return Vo(Nn(t))}function Dn(t){return t instanceof Uint8Array?Uint8Array.from(t):$r(t)}function gl(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&Bi(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function O(t,e=Rt.P){let r=t%e;return r>=at?r:e+r}function ge(t,e){let{P:r}=Rt,n=t;for(;e-- >at;)n*=n,n%=r;return n}function em(t){let{P:e}=Rt,r=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),s=BigInt(44),a=BigInt(88),c=t*t*t%e,f=c*c*t%e,u=ge(f,Ei)*f%e,h=ge(u,Ei)*f%e,l=ge(h,Ar)*c%e,d=ge(l,n)*l%e,p=ge(d,i)*d%e,y=ge(p,s)*p%e,g=ge(y,a)*y%e,x=ge(g,s)*p%e,E=ge(x,Ei)*f%e,b=ge(E,o)*d%e,A=ge(b,r)*c%e,v=ge(A,Ar);if(v*v%e!==t)throw new Error("Cannot find square root");return v}function Un(t,e=Rt.P){if(t===at||e<=at)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=O(t,e),n=e,i=at,o=vt,s=vt,a=at;for(;r!==at;){let f=n/r,u=n%r,h=i-s*f,l=o-a*f;n=r,r=u,i=s,o=a,s=h,a=l}if(n!==vt)throw new Error("invert: does not exist");return O(i,e)}function rm(t,e=Rt.P){let r=new Array(t.length),n=t.reduce((o,s,a)=>s===at?o:(r[a]=o,O(o*s,e)),vt),i=Un(n,e);return t.reduceRight((o,s,a)=>s===at?o:(r[a]=O(o*r[a],e),O(o*s,e)),i),r}function nm(t){let e=t.length*8-Rn*8,r=Cr(t);return e>0?r>>BigInt(e):r}function h0(t,e=!1){let r=nm(t);if(e)return r;let{n}=Rt;return r>=n?r-n:r}var Ln,Si,u0=class{constructor(e,r){if(this.hashLen=e,this.qByteLen=r,typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return Ie.hmacSha256(this.k,...e)}hmacSync(...e){return Si(this.k,...e)}checkSync(){if(typeof Si!="function")throw new Ho("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Br(...r)}generateSync(){this.checkSync(),this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Br(...r)}};function Bi(t){return at<t&&t<Rt.n}function a0(t){return at<t&&t<Rt.P}function im(t,e,r,n=!0){let{n:i}=Rt,o=h0(t,!0);if(!Bi(o))return;let s=Un(o,i),a=Ct.BASE.multiply(o),c=O(a.x,i);if(c===at)return;let f=O(s*O(e+r*c,i),i);if(f===at)return;let u=new Tn(c,f),h=(a.x===u.r?0:2)|Number(a.y&vt);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function qo(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==2*Rn)throw new Error("Expected 32 bytes of private key");e=Vo(t)}else if(t instanceof Uint8Array){if(t.length!==Rn)throw new Error("Expected 32 bytes of private key");e=Cr(t)}else throw new TypeError("Expected valid private key");if(!Bi(e))throw new Error("Expected private key: 0 < key < n");return e}function om(t){return t instanceof Ct?(t.assertValidity(),t):Ct.fromHex(t)}function xl(t){if(t instanceof Tn)return t.assertValidity(),t;try{return Tn.fromDER(t)}catch{return Tn.fromCompact(t)}}function l0(t,e=!1){return Ct.fromPrivateKey(t).toRawBytes(e)}function ml(t){let e=t.length>Ce?t.slice(0,Ce):t;return Cr(e)}function sm(t){let e=ml(t),r=O(e,Rt.n);return bl(r<at?e:r)}function bl(t){return f0(t)}function am(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=Dn(t),i=qo(e),o=[bl(i),sm(n)];if(r!=null){r===!0&&(r=Ie.randomBytes(Ce));let c=Dn(r);if(c.length!==Ce)throw new Error(`sign: Expected ${Ce} bytes of extra data`);o.push(c)}let s=Br(...o),a=ml(n);return{seed:s,m:a,d:i}}function cm(t,e){let{sig:r,recovery:n}=t,{der:i,recovered:o}=Object.assign({canonical:!0,der:!0},e),s=i?r.toDERRawBytes():r.toCompactRawBytes();return o?[s,n]:s}async function wl(t,e,r={}){let{seed:n,m:i,d:o}=am(t,e,r.extraEntropy),s=new u0(Qx,Rn);await s.reseed(n);let a;for(;!(a=im(await s.generate(),i,o,r.canonical));)await s.reseed();return cm(a,r)}var fm={strict:!0};function vl(t,e,r,n=fm){let i;try{i=xl(t),e=Dn(e)}catch{return!1}let{r:o,s}=i;if(n.strict&&i.hasHighS())return!1;let a=h0(e),c;try{c=om(r)}catch{return!1}let{n:f}=Rt,u=Un(s,f),h=O(a*u,f),l=O(o*u,f),d=Ct.BASE.multiplyAndAddUnsafe(c,h,l);return d?O(d.x,f)===o:!1}Ct.BASE._setWindowSize(8);var ae={node:Xx,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Fo={},Ie={bytesToHex:Nn,hexToBytes:$r,concatBytes:Br,mod:O,invert:Un,isValidPrivateKey(t){try{return qo(t),!0}catch{return!1}},_bigintTo32Bytes:f0,_normalizePrivateKey:qo,hashToPrivateKey:t=>{t=Dn(t);let e=Rn+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=O(Cr(t),Rt.n-vt)+vt;return f0(r)},randomBytes:(t=32)=>{if(ae.web)return ae.web.getRandomValues(new Uint8Array(t));if(ae.node){let{randomBytes:e}=ae.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ie.hashToPrivateKey(Ie.randomBytes(Rn+8)),precompute(t=8,e=Ct.BASE){let r=e===Ct.BASE?e:new Ct(e.x,e.y);return r._setWindowSize(t),r.multiply(Ei),r},sha256:async(...t)=>{if(ae.web){let e=await ae.web.subtle.digest("SHA-256",Br(...t));return new Uint8Array(e)}else if(ae.node){let{createHash:e}=ae.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(ae.web){let r=await ae.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=Br(...e),i=await ae.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(ae.node){let{createHmac:r}=ae.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=Fo[t];if(r===void 0){let n=await Ie.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Br(n,n),Fo[t]=r}return Ie.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof Ln!="function")throw new Ho("sha256Sync is undefined, you need to set it");let r=Fo[t];if(r===void 0){let n=Ln(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Br(n,n),Fo[t]=r}return Ln(r,...e)},_JacobianPoint:jt};Object.defineProperties(Ie,{sha256Sync:{configurable:!1,get(){return Ln},set(t){Ln||(Ln=t)}},hmacSha256Sync:{configurable:!1,get(){return Si},set(t){Si||(Si=t)}}});function zo(t){if(isNaN(t)||t<=0)throw new dt("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Ie.randomBytes(t)}var eE=It(vo(),1),p0=It(yt(),1);function El(t,e){return e.map(r=>se(t[r]))}function Sl(t){return p0.default.pki.setRsaPrivateKey(...El(t,["n","e","d","p","q","dp","dq","qi"]))}function Bl(t){return p0.default.pki.setRsaPublicKey(...El(t,["n","e"]))}var Wr={};pt(Wr,{jwkToPkcs1:()=>lm,jwkToPkix:()=>dm,pkcs1ToJwk:()=>hm,pkixToJwk:()=>pm});var iE=It(ri(),1),oE=It(vo(),1);var tr=It(yt(),1);function hm(t){let e=tr.default.asn1.fromDer(At(t,"ascii")),r=tr.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Ae(r.n),e:Ae(r.e),d:Ae(r.d),p:Ae(r.p),q:Ae(r.q),dp:Ae(r.dP),dq:Ae(r.dQ),qi:Ae(r.qInv),alg:"RS256"}}function lm(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new dt("JWK was missing components","ERR_INVALID_PARAMETERS");let e=tr.default.pki.privateKeyToAsn1({n:se(t.n),e:se(t.e),d:se(t.d),p:se(t.p),q:se(t.q),dP:se(t.dp),dQ:se(t.dq),qInv:se(t.qi)});return Wt(tr.default.asn1.toDer(e).getBytes(),"ascii")}function pm(t){let e=tr.default.asn1.fromDer(At(t,"ascii")),r=tr.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Ae(r.n),e:Ae(r.e)}}function dm(t){if(t.n==null||t.e==null)throw new dt("JWK was missing components","ERR_INVALID_PARAMETERS");let e=tr.default.pki.publicKeyToAsn1({n:se(t.n),e:se(t.e)});return Wt(tr.default.asn1.toDer(e).getBytes(),"ascii")}async function Al(t){let e=await ne.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Tl(e);return{privateKey:r[0],publicKey:r[1]}}async function d0(t){let r=[await ne.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await ym(t)],n=await Tl({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Cl(t,e){let r=await ne.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ne.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function Il(t,e,r){let n=await ne.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return ne.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function Tl(t){if(t.privateKey==null||t.publicKey==null)throw new dt("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([ne.get().subtle.exportKey("jwk",t.privateKey),ne.get().subtle.exportKey("jwk",t.publicKey)])}async function ym(t){return ne.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function _l(t,e,r,n){let i=e?Bl(t):Sl(t),o=At(Uint8Array.from(r),"ascii"),s=n(o,i);return Wt(s,"ascii")}function Ll(t,e){return _l(t,!0,e,(r,n)=>n.encrypt(r))}function Rl(t,e){return _l(t,!1,e,(r,n)=>n.decrypt(r))}var Ci=class{_key;constructor(e){this._key=e}async verify(e,r){return Il(this._key,r,e)}marshal(){return Wr.jwkToPkix(this._key)}get bytes(){return He.encode({Type:St.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Ll(this._key,e)}equals(e){return Mt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Yt.digest(this.bytes);return e}},kn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return zo(16)}async sign(e){return Cl(this._key,e)}get public(){if(this._publicKey==null)throw new dt("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Ci(this._publicKey)}decrypt(e){return Rl(this._key,e)}marshal(){return Wr.jwkToPkcs1(this._key)}get bytes(){return Ve.encode({Type:St.RSA,Data:this.marshal()}).subarray()}equals(e){return Mt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Yt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return At(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Ai.default.util.ByteBuffer(this.marshal()),i=Ai.default.asn1.fromDer(n),o=Ai.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Ai.default.pki.encryptRsaPrivateKey(o,e,s)}else{if(r==="libp2p-key")return Bn(this.bytes,e);throw new dt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function xm(t){let e=Wr.pkcs1ToJwk(t),r=await d0(e);return new kn(r.privateKey,r.publicKey)}function mm(t){let e=Wr.pkixToJwk(t);return new Ci(e)}async function bm(t){let e=await d0(t);return new kn(e.privateKey,e.publicKey)}async function wm(t){let e=await Al(t);return new kn(e.privateKey,e.publicKey)}var x0={};pt(x0,{Secp256k1PrivateKey:()=>Ti,Secp256k1PublicKey:()=>Ii,generateKeyPair:()=>Bm,unmarshalSecp256k1PrivateKey:()=>Em,unmarshalSecp256k1PublicKey:()=>Sm});function Nl(){return Ie.randomPrivateKey()}async function Dl(t,e){let{digest:r}=await Yt.digest(e);try{return await wl(r,t)}catch(n){throw new dt(String(n),"ERR_INVALID_INPUT")}}async function Ul(t,e,r){try{let{digest:n}=await Yt.digest(r);return vl(e,n,t)}catch(n){throw new dt(String(n),"ERR_INVALID_INPUT")}}function kl(t){return Ct.fromHex(t).toRawBytes(!0)}function Pl(t){try{l0(t,!0)}catch(e){throw new dt(String(e),"ERR_INVALID_PRIVATE_KEY")}}function g0(t){try{Ct.fromHex(t)}catch(e){throw new dt(String(e),"ERR_INVALID_PUBLIC_KEY")}}function Kl(t){try{return l0(t,!0)}catch(e){throw new dt(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Ii=class{_key;constructor(e){g0(e),this._key=e}async verify(e,r){return Ul(this._key,r,e)}marshal(){return kl(this._key)}get bytes(){return He.encode({Type:St.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Mt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Yt.digest(this.bytes);return e}},Ti=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??Kl(e),Pl(this._key),g0(this._publicKey)}async sign(e){return Dl(this._key,e)}get public(){return new Ii(this._publicKey)}marshal(){return this._key}get bytes(){return Ve.encode({Type:St.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Mt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Yt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return At(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Bn(this.bytes,e);throw new dt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Em(t){return new Ti(t)}function Sm(t){return new Ii(t)}async function Bm(){let t=Nl();return new Ti(t)}var Zr={rsa:y0,ed25519:i0,secp256k1:x0};function Ol(t){let e=Object.keys(Zr).join(" / ");return new dt(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Ml(t){let e=He.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case St.RSA:return Zr.rsa.unmarshalRsaPublicKey(r);case St.Ed25519:return Zr.ed25519.unmarshalEd25519PublicKey(r);case St.Secp256k1:return Zr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Ol(e.Type??"RSA")}}async function Fl(t){let e=Ve.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case St.RSA:return Zr.rsa.unmarshalRsaPrivateKey(r);case St.Ed25519:return Zr.ed25519.unmarshalEd25519PrivateKey(r);case St.Secp256k1:return Zr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Ol(e.Type??"RSA")}}var Hl=Symbol.for("@libp2p/peer-id");var m0={};pt(m0,{identity:()=>Cm});var Cm=xn({prefix:"\0",name:"identity",encode:t=>Ou(t),decode:t=>Ku(t)});var b0={};pt(b0,{base2:()=>Im});var Im=Lt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var w0={};pt(w0,{base8:()=>Tm});var Tm=Lt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var v0={};pt(v0,{base10:()=>_m});var _m=yr({prefix:"9",name:"base10",alphabet:"0123456789"});var E0={};pt(E0,{base16:()=>Lm,base16upper:()=>Rm});var Lm=Lt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Rm=Lt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var S0={};pt(S0,{base32:()=>Ir,base32hex:()=>km,base32hexpad:()=>Km,base32hexpadupper:()=>Om,base32hexupper:()=>Pm,base32pad:()=>Dm,base32padupper:()=>Um,base32upper:()=>Nm,base32z:()=>Mm});var Ir=Lt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Nm=Lt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Dm=Lt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Um=Lt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),km=Lt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pm=Lt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Km=Lt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Om=Lt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Mm=Lt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var B0={};pt(B0,{base36:()=>Fm,base36upper:()=>Hm});var Fm=yr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Hm=yr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var A0={};pt(A0,{base256emoji:()=>$m});var Vl=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Vm=Vl.reduce((t,e,r)=>(t[r]=e,t),[]),qm=Vl.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function zm(t){return t.reduce((e,r)=>(e+=Vm[r],e),"")}function Gm(t){let e=[];for(let r of t){let n=qm[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var $m=xn({prefix:"\u{1F680}",name:"base256emoji",encode:zm,decode:Gm});var QE=new TextEncoder,JE=new TextDecoder;var ql=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Xm(r,C0(t),e||Zt.encoder);default:return Qm(r,C0(t),e||Ir.encoder)}};var zl=new WeakMap,C0=t=>{let e=zl.get(t);if(e==null){let r=new Map;return zl.set(t,r),r}return e},Yr=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==_i)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Jm)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Ke(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&zu(e.multihash,n.multihash)}toString(e){return ql(this,e)}toJSON(){return{"/":ql(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s||Gl(n,i,o.bytes))}else if(r[jm]===!0){let{version:n,multihash:i,code:o}=r,s=hi(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==_i)throw new Error(`Version 0 CID must use dag-pb (code: ${_i}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=Gl(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,_i,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=Je(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new wn(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=ui(e.subarray(r));return r+=l,h},i=n(),o=_i;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),c=n(),f=r+c,u=f-s;return{version:i,codec:o,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,i]=Ym(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return C0(o).set(n,e),o}},Ym=(t,e)=>{switch(t[0]){case"Q":{let r=e||Zt;return[Zt.prefix,r.decode(`${Zt.prefix}${t}`)]}case Zt.prefix:{let r=e||Zt;return[Zt.prefix,r.decode(t)]}case Ir.prefix:{let r=e||Ir;return[Ir.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Xm=(t,e,r)=>{let{prefix:n}=r;if(n!==Zt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},Qm=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},_i=112,Jm=18,Gl=(t,e,r)=>{let n=bn(t),i=n+bn(e),o=new Uint8Array(i+r.byteLength);return mn(t,o,0),mn(e,o,n),o.set(r,i),o},jm=Symbol.for("@ipld/js-cid/CID");var I0={...m0,...b0,...w0,...v0,...E0,...S0,...B0,...Sa,...Ka,...A0},c5={...Ta,...Aa};var tb=Symbol.for("nodejs.util.inspect.custom"),$l=Object.values(I0).map(t=>t.decoder).reduce((t,e)=>t.or(e),I0.identity.decoder),Wl=114,T0=36,_0=37,Li=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Hl]=!0;toString(){return this.string==null&&(this.string=Zt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Yr.createV1(Wl,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Mt(this.multihash.bytes,e);if(typeof e=="string")return eb(e).equals(this);if(e?.multihash?.bytes!=null)return Mt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[tb](){return`PeerId(${this.toString()})`}},Pn=class extends Li{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Kn=class extends Li{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},On=class extends Li{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function eb(t,e){if(e=e??$l,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=hi(Zt.decode(`z${t}`));return t.startsWith("12D")?new Kn({multihash:r}):t.startsWith("16U")?new On({multihash:r}):new Pn({multihash:r})}return rb($l.decode(t))}function rb(t){try{let e=hi(t);if(e.code===gr.code){if(e.digest.length===T0)return new Kn({multihash:e});if(e.digest.length===_0)return new On({multihash:e})}if(e.code===Yt.code)return new Pn({multihash:e})}catch{return nb(Yr.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function nb(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==Wl)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Yt.code)return new Pn({multihash:t.multihash});if(e.code===gr.code){if(e.digest.length===T0)return new Kn({multihash:t.multihash});if(e.digest.length===_0)return new On({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function L0(t,e){return t.length===T0?new Kn({multihash:Ke(gr.code,t),privateKey:e}):t.length===_0?new On({multihash:Ke(gr.code,t),privateKey:e}):new Pn({multihash:await Yt.digest(t),publicKey:t,privateKey:e})}var Go;(function(t){let e;t.codec=()=>(e==null&&(e=qr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.webtransportCerthashes!=null)for(let o of r.webtransportCerthashes)n.uint32(10),n.bytes(o);i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={webtransportCerthashes:[]},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.webtransportCerthashes.push(r.bytes());break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Vr(r,t.codec()),t.decode=r=>Hr(r,t.codec())})(Go||(Go={}));var Ri;(function(t){let e;t.codec=()=>(e==null&&(e=qr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),(i.writeDefaults===!0||r.identityKey!=null&&r.identityKey.byteLength>0)&&(n.uint32(10),n.bytes(r.identityKey??new Uint8Array(0))),(i.writeDefaults===!0||r.identitySig!=null&&r.identitySig.byteLength>0)&&(n.uint32(18),n.bytes(r.identitySig??new Uint8Array(0))),r.extensions!=null&&(n.uint32(34),Go.codec().encode(r.extensions,n,{writeDefaults:!1})),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.identityKey=r.bytes();break;case 2:i.identitySig=r.bytes();break;case 4:i.extensions=Go.codec().decode(r,r.uint32());break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Vr(r,t.codec()),t.decode=r=>Hr(r,t.codec())})(Ri||(Ri={}));async function Zl(t,e,r){let n=await ob(t,Yl(e));if(t.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return ib(t.publicKey,n,r)}function ib(t,e,r){return Ri.encode({identityKey:t,identitySig:e,extensions:r??{webtransportCerthashes:[]}}).subarray()}async function ob(t,e){if(t.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return(await Fl(t.privateKey)).sign(e)}async function R0(t){return L0(t.identityKey)}function N0(t){return Ri.decode(t)}function Yl(t){let e=Wt("noise-libp2p-static-key:");return Pt([e,t],e.length+t.length)}async function D0(t,e,r){let n=await L0(e.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);let i=Yl(t);if(n.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(e.identitySig==null)throw new Error("Signature was missing from message");if(!await Ml(n.publicKey).verify(i,e.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function Ni(t){return!(!(t instanceof Uint8Array)||t.length!==32)}var fe=It(tp(),1);fe.default.formatters.b=t=>t==null?"undefined":Zt.baseEncode(t);fe.default.formatters.t=t=>t==null?"undefined":Ir.baseEncode(t);fe.default.formatters.m=t=>t==null?"undefined":Sn.baseEncode(t);fe.default.formatters.p=t=>t==null?"undefined":t.toString();fe.default.formatters.c=t=>t==null?"undefined":t.toString();fe.default.formatters.k=t=>t==null?"undefined":t.toString();fe.default.formatters.a=t=>t==null?"undefined":t.toString();function mb(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function ep(t){let e=mb(`${t}:trace`);return fe.default.enabled(`${t}:trace`)&&fe.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,fe.default)(`${t}:trace`)),Object.assign((0,fe.default)(t),{error:(0,fe.default)(`${t}:error`),trace:e})}var Gt=ep("libp2p:noise");var xe;oc?xe=Gt:xe=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function rp(t){xe(`LOCAL_STATIC_PUBLIC_KEY ${At(t.publicKey,"hex")}`),xe(`LOCAL_STATIC_PRIVATE_KEY ${At(t.privateKey,"hex")}`)}function U0(t){t?(xe(`LOCAL_PUBLIC_EPHEMERAL_KEY ${At(t.publicKey,"hex")}`),xe(`LOCAL_PRIVATE_EPHEMERAL_KEY ${At(t.privateKey,"hex")}`)):xe("Missing local ephemeral keys.")}function np(t){xe(`REMOTE_STATIC_PUBLIC_KEY ${At(t,"hex")}`)}function k0(t){xe(`REMOTE_EPHEMERAL_PUBLIC_KEY ${At(t,"hex")}`)}function ip(t){t.cs1&&t.cs2?(xe(`CIPHER_STATE_1 ${t.cs1.n.getUint64()} ${At(t.cs1.k,"hex")}`),xe(`CIPHER_STATE_2 ${t.cs2.n.getUint64()} ${At(t.cs2.k,"hex")}`)):xe("Missing cipher state.")}var bb="Cipherstate has reached maximum n, a new handshake must be performed",Zo=class{n;bytes;view;constructor(e=0){this.n=e,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error(bb)}};var Yo=class{crypto;constructor(e){this.crypto=e}encryptWithAd(e,r,n){let i=this.encrypt(e.k,e.n,r,n);return e.n.increment(),i}decryptWithAd(e,r,n,i){let{plaintext:o,valid:s}=this.decrypt(e.k,e.n,r,n,i);return s&&e.n.increment(),{plaintext:o,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){let r=this.createEmptyKey();return Mt(r,e)}encrypt(e,r,n,i){return r.assertValue(),this.crypto.chaCha20Poly1305Encrypt(i,r.getBytes(),n,e)}encryptAndHash(e,r){let n;return this.hasKey(e.cs)?n=this.encryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,n),n}decrypt(e,r,n,i,o){r.assertValue();let s=this.crypto.chaCha20Poly1305Decrypt(i,r.getBytes(),n,e,o);return s?{plaintext:s,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,r){let n,i=!0;return this.hasKey(e.cs)?{plaintext:n,valid:i}=this.decryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,r),{plaintext:n,valid:i}}dh(e,r){try{let n=this.crypto.generateX25519SharedKey(e,r);return n.length===32?n:n.subarray(0,32)}catch(n){let i=n;return Gt.error(i),new Uint8Array(32)}}mixHash(e,r){e.h=this.getHash(e.h,r)}getHash(e,r){return this.crypto.hashSHA256(Pt([e,r],e.length+r.length))}mixKey(e,r){let[n,i]=this.crypto.getHKDF(e.ck,r);e.cs=this.initializeKey(i),e.ck=n}initializeKey(e){return{k:e,n:new Zo}}initializeSymmetric(e){let r=Wt(e,"utf-8"),n=this.hashProtocolName(r),i=n,o=this.createEmptyKey();return{cs:this.initializeKey(o),ck:i,h:n}}hashProtocolName(e){if(e.length<=32){let r=new Uint8Array(32);return r.set(e),r}else return this.getHash(e,new Uint8Array(0))}split(e){let[r,n]=this.crypto.getHKDF(e.ck,new Uint8Array(0)),i=this.initializeKey(r),o=this.initializeKey(n);return{cs1:i,cs2:o}}writeMessageRegular(e,r){let n=this.encryptWithAd(e,new Uint8Array(0),r),i=this.createEmptyKey(),o=new Uint8Array(0);return{ne:i,ns:o,ciphertext:n}}readMessageRegular(e,r){return this.decryptWithAd(e,new Uint8Array(0),r.ciphertext)}};var Xo=class extends Yo{initializeInitiator(e,r,n,i){let o="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,e);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,psk:i,re:a}}initializeResponder(e,r,n,i){let o="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,e);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,psk:i,re:a}}writeMessageA(e,r,n){let i=new Uint8Array(0);n!==void 0?e.e=n:e.e=this.crypto.generateX25519KeyPair();let o=e.e.publicKey;this.mixHash(e.ss,o);let s=this.encryptAndHash(e.ss,r);return{ne:o,ns:i,ciphertext:s}}writeMessageB(e,r){e.e=this.crypto.generateX25519KeyPair();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let i=e.s.publicKey,o=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,r);return{ne:n,ns:o,ciphertext:s}}writeMessageC(e,r){let n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,r),a={ne:this.createEmptyKey(),ns:i,ciphertext:o},{cs1:c,cs2:f}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:f}}readMessageA(e,r){return Ni(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,r.ciphertext)}readMessageB(e,r){if(Ni(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);i&&Ni(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:o,valid:s}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:o,valid:i&&s}}readMessageC(e,r){let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);if(i&&Ni(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:o,valid:s}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:o,valid:i&&s,cs1:a,cs2:c}}initSession(e,r,n){let i=this.createEmptyKey(),o=new Uint8Array(32),s;return e?s=this.initializeInitiator(r,n,o,i):s=this.initializeResponder(r,n,o,i),{hs:s,i:e,mc:0}}sendMessage(e,r,n){let i;if(e.mc===0)i=this.writeMessageA(e.hs,r,n);else if(e.mc===1)i=this.writeMessageB(e.hs,r);else if(e.mc===2){let{h:o,messageBuffer:s,cs1:a,cs2:c}=this.writeMessageC(e.hs,r);i=s,e.h=o,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,r){let n=new Uint8Array(0),i=!1;if(e.mc===0)({plaintext:n,valid:i}=this.readMessageA(e.hs,r));else if(e.mc===1)({plaintext:n,valid:i}=this.readMessageB(e.hs,r));else if(e.mc===2){let{h:o,plaintext:s,valid:a,cs1:c,cs2:f}=this.readMessageC(e.hs,r);n=s,i=a,e.h=o,e.cs1=c,e.cs2=f}return e.mc++,{plaintext:n,valid:i}}};var Qo=class{isInitiator;session;remotePeer;remoteExtensions={webtransportCerthashes:[]};payload;connection;xx;staticKeypair;prologue;constructor(e,r,n,i,o,s,a,c){this.isInitiator=e,this.payload=r,this.prologue=n,this.staticKeypair=o,this.connection=s,a&&(this.remotePeer=a),this.xx=c??new Xo(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(rp(this.session.hs.s),this.isInitiator){Gt.trace("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,new Uint8Array(0));await this.connection.write(Hc(e)),Gt.trace("Stage 0 - Initiator finished sending first message."),U0(this.session.hs.e)}else{Gt.trace("Stage 0 - Responder waiting to receive first message...");let e=zc((await this.connection.read()).subarray()),{valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new Lr("xx handshake stage 0 validation fail");Gt.trace("Stage 0 - Responder received first message."),k0(this.session.hs.re)}}async exchange(){if(this.isInitiator){Gt.trace("Stage 1 - Initiator waiting to receive first message from responder...");let e=Gc((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new Lr("xx handshake stage 1 validation fail");Gt.trace("Stage 1 - Initiator received the message."),k0(this.session.hs.re),np(this.session.hs.rs),Gt.trace("Initiator going to check remote's signature...");try{let i=N0(r);this.remotePeer=this.remotePeer||await R0(i),await D0(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let o=i;throw new Jn(`Error occurred while verifying signed payload: ${o.message}`)}Gt.trace("All good with the signature!")}else{Gt.trace("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(Vc(e)),Gt.trace("Stage 1 - Responder sent the second handshake message with signed payload."),U0(this.session.hs.e)}}async finish(){if(this.isInitiator){Gt.trace("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(qc(e)),Gt.trace("Stage 2 - Initiator sent message with signed payload.")}else{Gt.trace("Stage 2 - Responder waiting for third handshake message...");let e=$c((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new Lr("xx handshake stage 2 validation fail");Gt.trace("Stage 2 - Responder received the message, finished handshake.");try{let i=N0(r);this.remotePeer=this.remotePeer||await R0(i),await D0(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let o=i;throw new Jn(`Error occurred while verifying signed payload: ${o.message}`)}}ip(this.session)}encrypt(e,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,new Uint8Array(0),e)}decrypt(e,r,n){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,new Uint8Array(0),e,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Lr("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}};function op(t){return{xxHandshakeSuccesses:t.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:t.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:t.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:t.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:t.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}var Jo=class{protocol="/noise";crypto;prologue;staticKeys;extensions;metrics;constructor(e={}){let{staticNoiseKey:r,extensions:n,crypto:i,prologueBytes:o,metrics:s}=e;this.crypto=i??no,this.extensions=n,this.metrics=s?op(s):void 0,r?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(r):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=o??new Uint8Array(0)}async secureOutbound(e,r,n){let i=ns(r,{lengthEncoder:sn,lengthDecoder:Xn,maxDataLength:65535}),o=await this.performHandshake({connection:i,isInitiator:!0,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(i,o),remoteExtensions:o.remoteExtensions,remotePeer:o.remotePeer}}async secureInbound(e,r,n){let i=ns(r,{lengthEncoder:sn,lengthDecoder:Xn,maxDataLength:65535}),o=await this.performHandshake({connection:i,isInitiator:!1,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(i,o),remotePeer:o.remotePeer,remoteExtensions:o.remoteExtensions}}async performHandshake(e){let r=await Zl(e.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(e,r)}async performXXHandshake(e,r){let{isInitiator:n,remotePeer:i,connection:o}=e,s=new Qo(n,r,this.prologue,this.crypto,this.staticKeys,o,i);try{await s.propose(),await s.exchange(),await s.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(a){if(this.metrics?.xxHandshakeErrors.increment(),a instanceof Error)throw a.message=`Error occurred during XX handshake: ${a.message}`,a}return s}async createSecureConnection(e,r){let[n,i]=tc(),o=e.unwrap();return await rc(n,Yc(r,this.metrics),o,s=>qn(s,{lengthDecoder:Xn}),Xc(r,this.metrics),n),i}};function wb(t={}){return()=>new Jo(t)}return bp(vb);})();
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PNoise}));
