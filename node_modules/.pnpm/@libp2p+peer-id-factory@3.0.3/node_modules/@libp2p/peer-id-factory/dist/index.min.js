(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerIdFactory = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerIdFactory=(()=>{var Qf=Object.create;var hn=Object.defineProperty;var Xf=Object.getOwnPropertyDescriptor;var Jf=Object.getOwnPropertyNames;var jf=Object.getPrototypeOf,tc=Object.prototype.hasOwnProperty;var $=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),At=(t,e)=>{for(var r in e)hn(t,r,{get:e[r],enumerable:!0})},oa=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Jf(e))!tc.call(t,i)&&i!==r&&hn(t,i,{get:()=>e[i],enumerable:!(n=Xf(e,i))||n.enumerable});return t};var Ct=(t,e,r)=>(r=t!=null?Qf(jf(t)):{},oa(e||!t||!t.__esModule?hn(r,"default",{value:t,enumerable:!0}):r,t)),ec=t=>oa(hn({},"__esModule",{value:!0}),t);var ct=$((Mp,aa)=>{aa.exports={options:{usePureJavaScript:!1}}});var ca=$((qp,fa)=>{var ai={};fa.exports=ai;var sa={};ai.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=rc(t,e);else{var i=0,o=e.length,s=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<a.length;++f)c+=a[f]<<8,a[f]=c%o,c=c/o|0;for(;c>0;)a.push(c%o),c=c/o|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};ai.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=sa[e];if(!r){r=sa[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),s=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var f=0,c=a;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===o&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function rc(t,e){var r=0,n=e.length,i=e.charAt(0),o=[0];for(r=0;r<t.length();++r){for(var s=0,a=t.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=o.length-1;r>=0;--r)f+=e[o[r]];return f}});var wt=$((Vp,da)=>{var ua=ct(),ha=ca(),g=da.exports=ua.util=ua.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(a){return setImmediate(a)};return}if(g.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=a,t="forge.setImmediate",e=[];g.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var o=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),o(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self>"u"?window:self}();g.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};g.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};g.isArrayBufferView=function(t){return t&&g.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Mr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}g.ByteBuffer=si;function si(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(g.isArrayBuffer(t)||g.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof si||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}g.ByteStringBuffer=si;var nc=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>nc&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};g.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};g.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};g.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(g.encodeUtf8(t))};g.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};g.ByteStringBuffer.prototype.putInt=function(t,e){Mr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};g.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};g.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};g.ByteStringBuffer.prototype.getInt=function(t){Mr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};g.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};g.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var t=g.createBuffer(this.data);return t.read=this.read,t};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function ic(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=g.isArrayBuffer(t),n=g.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}g.DataBuffer=ic;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};g.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};g.DataBuffer.prototype.putBytes=function(t,e){if(g.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof g.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&g.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof g.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var o;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(t,o,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(t,o,this.write),this;if(e==="utf8"&&(t=g.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(o),this;if(e==="utf16")return this.accommodate(t.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};g.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};g.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};g.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(t,e){Mr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};g.DataBuffer.prototype.putSignedInt=function(t,e){return Mr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};g.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};g.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};g.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};g.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};g.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};g.DataBuffer.prototype.getInt=function(t){Mr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};g.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};g.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return g.binary.raw.encode(e);if(t==="hex")return g.binary.hex.encode(e);if(t==="base64")return g.binary.base64.encode(e);if(t==="utf8")return g.text.utf8.decode(e);if(t==="utf16")return g.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};g.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=g.encodeUtf8(t)),new g.ByteBuffer(t)};g.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};g.xorBytes=function(t,e,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o,n};g.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};g.bytesToHex=function(t){return g.createBuffer(t).toHex()};g.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",De=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],la="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.length;)i=t.charCodeAt(a++),o=t.charCodeAt(a++),s=t.charCodeAt(a++),r+=Le.charAt(i>>2),r+=Le.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Le.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Le.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,o,s=0;s<t.length;)r=De[t.charCodeAt(s++)-43],n=De[t.charCodeAt(s++)-43],i=De[t.charCodeAt(s++)-43],o=De[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(e+=String.fromCharCode((i&3)<<6|o)));return e};g.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};g.decodeUtf8=function(t){return decodeURIComponent(escape(t))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:ha.encode,decode:ha.decode}};g.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};g.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,o=r;for(t.length&1&&(i=1,n[o++]=parseInt(t[0],16));i<t.length;i+=2)n[o++]=parseInt(t.substr(i,2),16);return e?o-r:n};g.binary.base64.encode=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.byteLength;)i=t[a++],o=t[a++],s=t[a++],r+=Le.charAt(i>>2),r+=Le.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Le.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Le.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,s,a,f=0,c=r;f<t.length;)i=De[t.charCodeAt(f++)-43],o=De[t.charCodeAt(f++)-43],s=De[t.charCodeAt(f++)-43],a=De[t.charCodeAt(f++)-43],n[c++]=i<<2|o>>4,s!==64&&(n[c++]=(o&15)<<4|s>>2,a!==64&&(n[c++]=(s&3)<<6|a));return e?c-r:n.subarray(0,c)};g.binary.base58.encode=function(t,e){return g.binary.baseN.encode(t,la,e)};g.binary.base58.decode=function(t,e){return g.binary.baseN.decode(t,la,e)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(t,e,r){t=g.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};g.text.utf8.decode=function(t){return g.decodeUtf8(String.fromCharCode.apply(null,t))};g.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,s=r,a=0;a<t.length;++a)i[s++]=t.charCodeAt(a),o+=2;return e?o-r:n};g.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};g.deflate=function(t,e,r){if(e=g.decode64(t.deflate(g.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};g.inflate=function(t,e,r){var n=t.inflate(g.encode64(e)).rval;return n===null?null:g.decode64(n)};var fi=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=g.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},ci=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},oc=function(t,e,r,n){var i=ci(t,e);i===null&&(i={}),i[r]=n,fi(t,e,i)},ac=function(t,e,r){var n=ci(t,e);return n!==null&&(n=r in n?n[r]:null),n},sc=function(t,e,r){var n=ci(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),fi(t,e,n)}},fc=function(t,e){fi(t,e,null)},ln=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,s=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),o=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),o=!0)}catch(f){s=f}if(o)break}if(!o)throw s;return n};g.setItem=function(t,e,r,n,i){ln(oc,arguments,i)};g.getItem=function(t,e,r,n){return ln(ac,arguments,n)};g.removeItem=function(t,e,r,n){ln(sc,arguments,n)};g.clearItems=function(t,e,r){ln(fc,arguments,r)};g.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};g.format=function(t){for(var e=/%./g,r,n,i=0,o=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&o.push(n),s=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(t.substring(s)),o.join("")};g.formatNumber=function(t,e,r,n){var i=t,o=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,a=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+a:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-c).toFixed(o).slice(2):"")};g.formatSize=function(t){return t>=1073741824?t=g.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=g.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=g.formatNumber(t/1024,0)+" KiB":t=g.formatNumber(t,0)+" bytes",t};g.bytesFromIP=function(t){return t.indexOf(".")!==-1?g.bytesFromIPv4(t):t.indexOf(":")!==-1?g.bytesFromIPv6(t):null};g.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=g.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};g.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=g.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=g.hexToBytes(t[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};g.bytesToIP=function(t){return t.length===4?g.bytesToIPv4(t):t.length===16?g.bytesToIPv6(t):null};g.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};g.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var o=g.bytesToHex(t[i]+t[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var s=r[r.length-1],a=e.length;!s||a!==s.end+1?r.push({start:a,end:a}):(s.end=a,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(o)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};g.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in g&&!t.update)return e(null,g.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,e(null,g.cores);if(typeof Worker>"u")return g.cores=1,e(null,g.cores);if(typeof Blob>"u")return g.cores=2,e(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var a=Date.now(),f=a+4;Date.now()<f;);self.postMessage({st:a,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,a,f){if(a===0){var c=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return g.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,g.cores)}i(f,function(u,h){s.push(o(f,h)),n(s,a-1,f)})}function i(s,a){for(var f=[],c=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===s){for(var x=0;x<s;++x)f[x].terminate();a(null,c)}}),f.push(h)}for(var u=0;u<s;++u)f[u].postMessage(u)}function o(s,a){for(var f=[],c=0;c<s;++c)for(var u=a[c],h=f[c]=[],l=0;l<s;++l)if(c!==l){var x=a[l];(u.st>x.st&&u.st<x.et||x.st>u.st&&x.st<u.et)&&h.push(l)}return f.reduce(function(d,p){return Math.max(d,p.length)},0)}}});var dn=$((Fp,pa)=>{var qr=ct();qr.pki=qr.pki||{};var ui=pa.exports=qr.pki.oids=qr.oids=qr.oids||{};function T(t,e){ui[t]=e,ui[e]=t}function ot(t,e){ui[t]=e}T("1.2.840.113549.1.1.1","rsaEncryption");T("1.2.840.113549.1.1.4","md5WithRSAEncryption");T("1.2.840.113549.1.1.5","sha1WithRSAEncryption");T("1.2.840.113549.1.1.7","RSAES-OAEP");T("1.2.840.113549.1.1.8","mgf1");T("1.2.840.113549.1.1.9","pSpecified");T("1.2.840.113549.1.1.10","RSASSA-PSS");T("1.2.840.113549.1.1.11","sha256WithRSAEncryption");T("1.2.840.113549.1.1.12","sha384WithRSAEncryption");T("1.2.840.113549.1.1.13","sha512WithRSAEncryption");T("1.3.101.112","EdDSA25519");T("1.2.840.10040.4.3","dsa-with-sha1");T("1.3.14.3.2.7","desCBC");T("1.3.14.3.2.26","sha1");T("1.3.14.3.2.29","sha1WithRSASignature");T("2.16.840.1.101.3.4.2.1","sha256");T("2.16.840.1.101.3.4.2.2","sha384");T("2.16.840.1.101.3.4.2.3","sha512");T("2.16.840.1.101.3.4.2.4","sha224");T("2.16.840.1.101.3.4.2.5","sha512-224");T("2.16.840.1.101.3.4.2.6","sha512-256");T("1.2.840.113549.2.2","md2");T("1.2.840.113549.2.5","md5");T("1.2.840.113549.1.7.1","data");T("1.2.840.113549.1.7.2","signedData");T("1.2.840.113549.1.7.3","envelopedData");T("1.2.840.113549.1.7.4","signedAndEnvelopedData");T("1.2.840.113549.1.7.5","digestedData");T("1.2.840.113549.1.7.6","encryptedData");T("1.2.840.113549.1.9.1","emailAddress");T("1.2.840.113549.1.9.2","unstructuredName");T("1.2.840.113549.1.9.3","contentType");T("1.2.840.113549.1.9.4","messageDigest");T("1.2.840.113549.1.9.5","signingTime");T("1.2.840.113549.1.9.6","counterSignature");T("1.2.840.113549.1.9.7","challengePassword");T("1.2.840.113549.1.9.8","unstructuredAddress");T("1.2.840.113549.1.9.14","extensionRequest");T("1.2.840.113549.1.9.20","friendlyName");T("1.2.840.113549.1.9.21","localKeyId");T("1.2.840.113549.1.9.22.1","x509Certificate");T("1.2.840.113549.1.12.10.1.1","keyBag");T("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");T("1.2.840.113549.1.12.10.1.3","certBag");T("1.2.840.113549.1.12.10.1.4","crlBag");T("1.2.840.113549.1.12.10.1.5","secretBag");T("1.2.840.113549.1.12.10.1.6","safeContentsBag");T("1.2.840.113549.1.5.13","pkcs5PBES2");T("1.2.840.113549.1.5.12","pkcs5PBKDF2");T("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");T("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");T("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");T("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");T("1.2.840.113549.2.7","hmacWithSHA1");T("1.2.840.113549.2.8","hmacWithSHA224");T("1.2.840.113549.2.9","hmacWithSHA256");T("1.2.840.113549.2.10","hmacWithSHA384");T("1.2.840.113549.2.11","hmacWithSHA512");T("1.2.840.113549.3.7","des-EDE3-CBC");T("2.16.840.1.101.3.4.1.2","aes128-CBC");T("2.16.840.1.101.3.4.1.22","aes192-CBC");T("2.16.840.1.101.3.4.1.42","aes256-CBC");T("2.5.4.3","commonName");T("2.5.4.4","surname");T("2.5.4.5","serialNumber");T("2.5.4.6","countryName");T("2.5.4.7","localityName");T("2.5.4.8","stateOrProvinceName");T("2.5.4.9","streetAddress");T("2.5.4.10","organizationName");T("2.5.4.11","organizationalUnitName");T("2.5.4.12","title");T("2.5.4.13","description");T("2.5.4.15","businessCategory");T("2.5.4.17","postalCode");T("2.5.4.42","givenName");T("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");T("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");T("2.16.840.1.113730.1.1","nsCertType");T("2.16.840.1.113730.1.13","nsComment");ot("2.5.29.1","authorityKeyIdentifier");ot("2.5.29.2","keyAttributes");ot("2.5.29.3","certificatePolicies");ot("2.5.29.4","keyUsageRestriction");ot("2.5.29.5","policyMapping");ot("2.5.29.6","subtreesConstraint");ot("2.5.29.7","subjectAltName");ot("2.5.29.8","issuerAltName");ot("2.5.29.9","subjectDirectoryAttributes");ot("2.5.29.10","basicConstraints");ot("2.5.29.11","nameConstraints");ot("2.5.29.12","policyConstraints");ot("2.5.29.13","basicConstraints");T("2.5.29.14","subjectKeyIdentifier");T("2.5.29.15","keyUsage");ot("2.5.29.16","privateKeyUsagePeriod");T("2.5.29.17","subjectAltName");T("2.5.29.18","issuerAltName");T("2.5.29.19","basicConstraints");ot("2.5.29.20","cRLNumber");ot("2.5.29.21","cRLReason");ot("2.5.29.22","expirationDate");ot("2.5.29.23","instructionCode");ot("2.5.29.24","invalidityDate");ot("2.5.29.25","cRLDistributionPoints");ot("2.5.29.26","issuingDistributionPoint");ot("2.5.29.27","deltaCRLIndicator");ot("2.5.29.28","issuingDistributionPoint");ot("2.5.29.29","certificateIssuer");ot("2.5.29.30","nameConstraints");T("2.5.29.31","cRLDistributionPoints");T("2.5.29.32","certificatePolicies");ot("2.5.29.33","policyMappings");ot("2.5.29.34","policyConstraints");T("2.5.29.35","authorityKeyIdentifier");ot("2.5.29.36","policyConstraints");T("2.5.29.37","extKeyUsage");ot("2.5.29.46","freshestCRL");ot("2.5.29.54","inhibitAnyPolicy");T("1.3.6.1.4.1.11129.2.4.2","timestampList");T("1.3.6.1.5.5.7.1.1","authorityInfoAccess");T("1.3.6.1.5.5.7.3.1","serverAuth");T("1.3.6.1.5.5.7.3.2","clientAuth");T("1.3.6.1.5.5.7.3.3","codeSigning");T("1.3.6.1.5.5.7.3.4","emailProtection");T("1.3.6.1.5.5.7.3.8","timeStamping")});var Fr=$((Hp,xa)=>{var lt=ct();wt();dn();var P=xa.exports=lt.asn1=lt.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(lt.util.isArray(n)){for(var o=[],s=0;s<n.length;++s)n[s]!==void 0&&o.push(n[s]);n=o}var a={tagClass:t,type:e,constructed:r,composed:r||lt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=P.copy(a)),a};P.copy=function(t,e){var r;if(lt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(lt.util.isArray(t)){if(!lt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Vr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var cc=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;Vr(t,e,o),n=t.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=lt.util.createBuffer(t));var r=t.length(),n=pn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function pn(t,e,r,n){var i;Vr(t,e,2);var o=t.getByte();e--;var s=o&192,a=o&31;i=t.length();var f=cc(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,l=(o&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Vr(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(pn(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(pn(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===P.Class.UNIVERSAL&&a===P.Type.BITSTRING&&f>1){var x=t.read,d=e,p=0;if(a===P.Type.BITSTRING&&(Vr(t,e,1),p=t.getByte(),e--),p===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},m=pn(t,e,r+1,y),E=i-t.length();e-=E,a==P.Type.BITSTRING&&E++;var b=m.tagClass;E===f&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=x,e=d)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(a===P.Type.BMPSTRING)for(u="";f>0;f-=2)Vr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var R=h===void 0?null:{bitStringContents:h};return P.create(s,a,l,u,R)}P.toDer=function(t){var e=lt.util.createBuffer(),r=t.tagClass|t.type,n=lt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var o=0;o<t.value.length;++o)t.value[o]!==void 0&&n.putBuffer(P.toDer(t.value[o]))}else if(t.type===P.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)n.putInt16(t.value.charCodeAt(o));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),a="";do a+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)e.putByte(a.charCodeAt(o))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=lt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,o,s,a=2;a<e.length;++a){n=!0,i=[],o=parseInt(e[a],10);do s=o&127,o=o>>>7,n||(s|=128),i.push(s),n=!1;while(o>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=lt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(a=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var x=parseInt(t.substr(h+1,2),10),d=parseInt(t.substr(h+4,2),10);c=x*60+d,c*=6e4,l==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(o,s,a,f)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=lt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=lt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&lt.util.isArray(e.value))for(var o=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[o]&&(i=P.validate(t.value[o],e.value[s],r,n),i?++o:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var ya=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",o=0;o<e*r;++o)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,a="",o=0;o<t.value.length;++o)t.value[o]!==void 0&&(s+=1,a+=P.prettyPrint(t.value[o],e+1,r),o+1<t.value.length&&(a+=","));n+=i+"Sub values: "+s+a}else{if(n+=i+"Value: ",t.type===P.Type.OID){var f=P.derToOid(t.value);n+=f,lt.pki&&lt.pki.oids&&f in lt.pki.oids&&(n+=" ("+lt.pki.oids[f]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+lt.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+lt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)ya.test(t.value)||(n+="("+t.value+") "),n+="0x"+lt.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=lt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+lt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:ya.test(t.value)?n+="0x"+lt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var li=$((zp,ga)=>{var It=ct();wt();ga.exports=It.cipher=It.cipher||{};It.cipher.algorithms=It.cipher.algorithms||{};It.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=It.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new It.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};It.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=It.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new It.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};It.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),It.cipher.algorithms[t]=e};It.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in It.cipher.algorithms?It.cipher.algorithms[t]:null};var hi=It.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};hi.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=It.util.createBuffer(),this.output=t.output||It.util.createBuffer(),this.mode.start(e)};hi.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};hi.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var pi=$((Gp,ma)=>{var Tt=ct();wt();Tt.cipher=Tt.cipher||{};var Q=ma.exports=Tt.cipher.modes=Tt.cipher.modes||{};Q.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Q.ecb.prototype.start=function(t){};Q.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Q.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Q.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Q.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Q.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Q.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=yn(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Q.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Q.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Q.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Q.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Q.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Tt.util.createBuffer(),this._partialBytes=0};Q.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=yn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Q.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Q.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Q.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Tt.util.createBuffer(),this._partialBytes=0};Q.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=yn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Q.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Q.ofb.prototype.decrypt=Q.ofb.prototype.encrypt;Q.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Tt.util.createBuffer(),this._partialBytes=0};Q.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=yn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Q.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}xn(this._inBlock)};Q.ctr.prototype.decrypt=Q.ctr.prototype.encrypt;Q.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Tt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Q.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Tt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Tt.util.createBuffer(t.additionalData):r=Tt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Tt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(di(n*8)))}this._inBlock=this._j0.slice(0),xn(this._inBlock),this._partialBytes=0,r=Tt.util.createBuffer(r),this._aDataLength=di(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Q.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),xn(this._inBlock)};Q.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),xn(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Q.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Tt.util.createBuffer();var n=this._aDataLength.concat(di(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Q.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var o=t[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Q.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Q.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,o=this._m[r][i];e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3]}return e};Q.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Q.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;a[f]=1<<e-1<<c,o[s]=this.generateSubHashTable(this.multiply(a,t),e)}return o};Q.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],f=i[s];i[o+s]=[a[0]^f[0],a[1]^f[1],a[2]^f[2],a[3]^f[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var c=i[o^n];i[o]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function yn(t,e){if(typeof t=="string"&&(t=Tt.util.createBuffer(t)),Tt.util.isArray(t)&&t.length>4){var r=t;t=Tt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Tt.util.isArray(t)){for(var i=[],o=e/4,n=0;n<o;++n)i.push(t.getInt32());t=i}return t}function xn(t){t[t.length-1]=t[t.length-1]+1&4294967295}function di(t){return[t/4294967296|0,t&4294967295]}});var mi=$((Wp,wa)=>{var ut=ct();li();pi();wt();wa.exports=ut.aes=ut.aes||{};ut.aes.startEncrypting=function(t,e,r,n){var i=gn({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};ut.aes.createEncryptionCipher=function(t,e){return gn({key:t,output:null,decrypt:!1,mode:e})};ut.aes.startDecrypting=function(t,e,r,n){var i=gn({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};ut.aes.createDecryptionCipher=function(t,e){return gn({key:t,output:null,decrypt:!0,mode:e})};ut.aes.Algorithm=function(t,e){gi||ba();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return xi(r._w,n,i,!1)},decrypt:function(n,i){return xi(r._w,n,i,!0)}}}),r._init=!1};ut.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=ut.util.createBuffer(e);else if(ut.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=ut.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!ut.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!ut.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=Ea(e,t.decrypt&&!s),this._init=!0}};ut.aes._expandKey=function(t,e){return gi||ba(),Ea(t,e)};ut.aes._updateBlock=xi;hr("AES-ECB",ut.cipher.modes.ecb);hr("AES-CBC",ut.cipher.modes.cbc);hr("AES-CFB",ut.cipher.modes.cfb);hr("AES-OFB",ut.cipher.modes.ofb);hr("AES-CTR",ut.cipher.modes.ctr);hr("AES-GCM",ut.cipher.modes.gcm);function hr(t,e){var r=function(){return new ut.aes.Algorithm(t,e)};ut.cipher.registerAlgorithm(t,r)}var gi=!1,ur=4,Ut,yi,va,Ye,Xt;function ba(){gi=!0,va=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Ut=new Array(256),yi=new Array(256),Ye=new Array(4),Xt=new Array(4);for(var e=0;e<4;++e)Ye[e]=new Array(256),Xt[e]=new Array(256);for(var r=0,n=0,i,o,s,a,f,c,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Ut[r]=a,yi[a]=r,f=t[a],i=t[r],o=t[i],s=t[o],c=f<<24^a<<16^a<<8^(a^f),u=(i^o^s)<<24^(r^s)<<16^(r^o^s)<<8^(r^i^s);for(var h=0;h<4;++h)Ye[h][r]=c,Xt[h][a]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function Ea(t,e){for(var r=t.slice(0),n,i=1,o=r.length,s=o+6+1,a=ur*s,f=o;f<a;++f)n=r[f-1],f%o===0?(n=Ut[n>>>16&255]<<24^Ut[n>>>8&255]<<16^Ut[n&255]<<8^Ut[n>>>24]^va[i]<<24,i++):o>6&&f%o===4&&(n=Ut[n>>>24]<<24^Ut[n>>>16&255]<<16^Ut[n>>>8&255]<<8^Ut[n&255]),r[f]=r[f-o]^n;if(e){var c,u=Xt[0],h=Xt[1],l=Xt[2],x=Xt[3],d=r.slice(0);a=r.length;for(var f=0,p=a-ur;f<a;f+=ur,p-=ur)if(f===0||f===a-ur)d[f]=r[p],d[f+1]=r[p+3],d[f+2]=r[p+2],d[f+3]=r[p+1];else for(var y=0;y<ur;++y)c=r[p+y],d[f+(3&-y)]=u[Ut[c>>>24]]^h[Ut[c>>>16&255]]^l[Ut[c>>>8&255]]^x[Ut[c&255]];r=d}return r}function xi(t,e,r,n){var i=t.length/4-1,o,s,a,f,c;n?(o=Xt[0],s=Xt[1],a=Xt[2],f=Xt[3],c=yi):(o=Ye[0],s=Ye[1],a=Ye[2],f=Ye[3],c=Ut);var u,h,l,x,d,p,y;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],x=e[n?1:3]^t[3];for(var m=3,E=1;E<i;++E)d=o[u>>>24]^s[h>>>16&255]^a[l>>>8&255]^f[x&255]^t[++m],p=o[h>>>24]^s[l>>>16&255]^a[x>>>8&255]^f[u&255]^t[++m],y=o[l>>>24]^s[x>>>16&255]^a[u>>>8&255]^f[h&255]^t[++m],x=o[x>>>24]^s[u>>>16&255]^a[h>>>8&255]^f[l&255]^t[++m],u=d,h=p,l=y;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[x&255]^t[++m],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[x>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[l>>>24]<<24^c[x>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++m],r[n?1:3]=c[x>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^t[++m]}function gn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=ut.cipher.createDecipher(r,t.key):n=ut.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof ut.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var Aa=$((Yp,Sa)=>{var pt=ct();li();pi();wt();Sa.exports=pt.des=pt.des||{};pt.des.startEncrypting=function(t,e,r,n){var i=mn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};pt.des.createEncryptionCipher=function(t,e){return mn({key:t,output:null,decrypt:!1,mode:e})};pt.des.startDecrypting=function(t,e,r,n){var i=mn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};pt.des.createDecryptionCipher=function(t,e){return mn({key:t,output:null,decrypt:!0,mode:e})};pt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Ba(r._keys,n,i,!1)},decrypt:function(n,i){return Ba(r._keys,n,i,!0)}}}),r._init=!1};pt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=pt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=mc(e),this._init=!0}};ae("DES-ECB",pt.cipher.modes.ecb);ae("DES-CBC",pt.cipher.modes.cbc);ae("DES-CFB",pt.cipher.modes.cfb);ae("DES-OFB",pt.cipher.modes.ofb);ae("DES-CTR",pt.cipher.modes.ctr);ae("3DES-ECB",pt.cipher.modes.ecb);ae("3DES-CBC",pt.cipher.modes.cbc);ae("3DES-CFB",pt.cipher.modes.cfb);ae("3DES-OFB",pt.cipher.modes.ofb);ae("3DES-CTR",pt.cipher.modes.ctr);function ae(t,e){var r=function(){return new pt.des.Algorithm(t,e)};pt.cipher.registerAlgorithm(t,r)}var uc=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],hc=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],lc=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],dc=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],pc=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],yc=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],xc=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],gc=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function mc(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],x=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,R=0;R<p;R++){var w=t.getInt32(),B=t.getInt32();b=(w>>>4^B)&252645135,B^=b,w^=b<<4,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>2^B)&858993459,B^=b,w^=b<<2,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=(B>>>8^w)&16711935,w^=b,B^=b<<8,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=w<<8|B>>>20&240,w=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=b;for(var L=0;L<m.length;++L){m[L]?(w=w<<2|w>>>26,B=B<<2|B>>>26):(w=w<<1|w>>>27,B=B<<1|B>>>27),w&=-15,B&=-15;var D=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|o[w>>>12&15]|s[w>>>8&15]|a[w>>>4&15],z=f[B>>>28]|c[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|l[B>>>12&15]|x[B>>>8&15]|d[B>>>4&15];b=(z>>>16^D)&65535,y[E++]=D^b,y[E++]=z^b<<16}}return y}function Ba(t,e,r,n){var i=t.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,a=e[0],f=e[1];s=(a>>>4^f)&252645135,f^=s,a^=s<<4,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,a=a<<1|a>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=o[c+1],h=o[c+2],l=o[c];l!=u;l+=h){var x=f^t[l],d=(f>>>4|f<<28)^t[l+1];s=a,a=f,f=s^(hc[x>>>24&63]|dc[x>>>16&63]|yc[x>>>8&63]|gc[x&63]|uc[d>>>24&63]|lc[d>>>16&63]|pc[d>>>8&63]|xc[d&63])}s=a,a=f,f=s}a=a>>>1|a<<31,f=f>>>1|f<<31,s=(a>>>1^f)&1431655765,f^=s,a^=s<<1,s=(f>>>8^a)&16711935,a^=s,f^=s<<8,s=(f>>>2^a)&858993459,a^=s,f^=s<<2,s=(a>>>16^f)&65535,f^=s,a^=s<<16,s=(a>>>4^f)&252645135,f^=s,a^=s<<4,r[0]=a,r[1]=f}function mn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=pt.cipher.createDecipher(r,t.key):n=pt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof pt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var Ze=$((Zp,Ca)=>{var vn=ct();Ca.exports=vn.md=vn.md||{};vn.md.algorithms=vn.md.algorithms||{}});var Ta=$(($p,Ia)=>{var be=ct();Ze();wt();var vc=Ia.exports=be.hmac=be.hmac||{};vc.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(o,s){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in be.md.algorithms)e=be.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else e=o;if(s===null)s=t;else{if(typeof s=="string")s=be.util.createBuffer(s);else if(be.util.isArray(s)){var a=s;s=be.util.createBuffer();for(var f=0;f<a.length;++f)s.putByte(a[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=be.util.createBuffer(),n=be.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var a=s.at(f);r.putByte(54^a),n.putByte(92^a)}if(c<e.blockLength)for(var a=e.blockLength-c,f=0;f<a;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(o){e.update(o)},i.getMac=function(){var o=e.digest().bytes();return e.start(),e.update(n),e.update(o),e.digest()},i.digest=i.getMac,i}});var bn=$(()=>{});var Ra=$((Jp,_a)=>{var Ot=ct();Ta();Ze();wt();var bc=Ot.pkcs5=Ot.pkcs5||{},Ee;Ot.util.isNodejs&&!Ot.options.usePureJavaScript&&(Ee=bn());_a.exports=Ot.pbkdf2=bc.pbkdf2=function(t,e,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),Ot.util.isNodejs&&!Ot.options.usePureJavaScript&&Ee.pbkdf2&&(i===null||typeof i!="object")&&(Ee.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?Ee.pbkdf2Sync.length===4?Ee.pbkdf2(t,e,r,n,function(b,R){if(b)return o(b);o(null,R.toString("binary"))}):Ee.pbkdf2(t,e,r,n,i,function(b,R){if(b)return o(b);o(null,R.toString("binary"))}):Ee.pbkdf2Sync.length===4?Ee.pbkdf2Sync(t,e,r,n).toString("binary"):Ee.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Ot.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Ot.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var a=new Error("Derived key is too long.");if(o)return o(a);throw a}var f=Math.ceil(n/s),c=n-(f-1)*s,u=Ot.hmac.create();u.start(i,t);var h="",l,x,d;if(!o){for(var p=1;p<=f;++p){u.start(null,null),u.update(e),u.update(Ot.util.int32ToBytes(p)),l=d=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(d),x=u.digest().getBytes(),l=Ot.util.xorBytes(l,x,s),d=x;h+=p<f?l:l.substr(0,c)}return h}var p=1,y;function m(){if(p>f)return o(null,h);u.start(null,null),u.update(e),u.update(Ot.util.int32ToBytes(p)),l=d=u.digest().getBytes(),y=2,E()}function E(){if(y<=r)return u.start(null,null),u.update(d),x=u.digest().getBytes(),l=Ot.util.xorBytes(l,x,s),d=x,++y,Ot.util.setImmediate(E);h+=p<f?l:l.substr(0,c),++p,m()}m()}});var Na=$((jp,Da)=>{var wn=ct();wt();var La=Da.exports=wn.pem=wn.pem||{};La.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=En(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=En(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=En(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=En(t.headers[i]);return t.procType&&(r+=`\r
`),r+=wn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};La.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(t),!!o;){var s=o[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var a={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:wn.util.decode64(o[3])};if(e.push(a),!!o[2]){for(var f=o[2].split(i),c=0;o&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(o=u.match(n),o){for(var x={name:o[1],values:[]},d=o[2].split(","),p=0;p<d.length;++p)x.values.push(Ec(d[p]));if(a.procType)if(!a.contentDomain&&x.name==="Content-Domain")a.contentDomain=d[0]||"";else if(!a.dekInfo&&x.name==="DEK-Info"){if(x.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:d[0],parameters:d[1]||null}}else a.headers.push(x);else{if(x.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(x.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:d[0],type:d[1]}}}++c}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function En(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var o=0,s=-1,i=0;i<e.length;++i,++o)if(o>65&&s!==-1){var a=e[s];a===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+a+e.substr(s+1),o=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Ec(t){return t.replace(/^\s+/,"")}});var Ma=$((t1,Oa)=>{var se=ct();Ze();wt();var Pa=Oa.exports=se.sha256=se.sha256||{};se.md.sha256=se.md.algorithms.sha256=Pa;Pa.create=function(){Ka||wc();var t=null,e=se.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=se.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=se.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),ka(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=se.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(vi.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};ka(h,r,i);var l=se.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var vi=null,Ka=!1,Ua=null;function wc(){vi=String.fromCharCode(128),vi+=se.util.fillString(String.fromCharCode(0),64),Ua=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Ka=!0}function ka(t,e,r){for(var n,i,o,s,a,f,c,u,h,l,x,d,p,y,m,E=r.length();E>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,l=t.h2,x=t.h3,d=t.h4,p=t.h5,y=t.h6,m=t.h7,c=0;c<64;++c)s=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),a=y^d&(p^y),o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=m+s+a+Ua[c]+e[c],i=o+f,m=y,y=p,p=d,d=x+n>>>0,x=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+x|0,t.h4=t.h4+d|0,t.h5=t.h5+p|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,E-=64}}});var Va=$((e1,qa)=>{var fe=ct();wt();var Bn=null;fe.util.isNodejs&&!fe.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Bn=bn());var Bc=qa.exports=fe.prng=fe.prng||{};Bc.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,l=e.plugin.increment,x=e.plugin.formatKey,d=e.plugin.formatSeed,p=fe.util.createBuffer();e.key=null,y();function y(m){if(m)return u(m);if(p.length()>=c)return u(null,p.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return fe.util.nextTick(function(){o(y)});var E=h(e.key,e.seed);e.generated+=E.length,p.putBytes(E),e.key=x(h(e.key,l(e.seed))),e.seed=d(h(e.key,e.seed)),fe.util.setImmediate(y)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,x=e.plugin.formatSeed;e.key=null;for(var d=fe.util.createBuffer();d.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var p=u(e.key,e.seed);e.generated+=p.length,d.putBytes(p),e.key=l(u(e.key,h(e.seed))),e.seed=x(u(e.key,e.seed))}return d.getBytes(c)};function o(c){if(e.pools[0].messageLength>=32)return a(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return c(h);e.collect(l),a(),c()})}function s(){if(e.pools[0].messageLength>=32)return a();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var l=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(c){var u=null,h=fe.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(w){return l.getRandomValues(w)});var x=fe.util.createBuffer();if(u)for(;x.length()<c;){var d=Math.max(1,Math.min(c-x.length(),65536)/4),p=new Uint32Array(Math.floor(d));try{u(p);for(var y=0;y<p.length;++y)x.putInt32(p[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(x.length()<c)for(var m,E,b,R=Math.floor(Math.random()*65536);x.length()<c;){E=16807*(R&65535),m=16807*(R>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),R=E&4294967295;for(var y=0;y<3;++y)b=R>>>(y<<3),b^=Math.floor(Math.random()*256),x.putByte(b&255)}return x.getBytes(c)}return Bn?(e.seedFile=function(c,u){Bn.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(c){return Bn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,l){function x(d){var p=d.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",x),l(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",x),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(x,d){c.postMessage({forge:{prng:{err:x,bytes:d}}})})};c.addEventListener("message",u)}},e}});var Hr=$((r1,bi)=>{var _t=ct();mi();Ma();Va();wt();(function(){if(_t.random&&_t.random.getBytes){bi.exports=_t.random;return}(function(t){var e={},r=new Array(4),n=_t.util.createBuffer();e.formatKey=function(h){var l=_t.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),_t.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=_t.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return _t.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=_t.md.sha256;function i(){var h=_t.prng.create(e);return h.getBytes=function(l,x){return h.generate(l,x)},h.getBytesSync=function(l){return h.generate(l)},h}var o=i(),s=null,a=_t.util.globalScope,f=a.crypto||a.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),_t.options.usePureJavaScript||!_t.util.isNodejs&&!s){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}o.collect(c),c=null}t&&(t().mousemove(function(h){o.collectInt(h.clientX,16),o.collectInt(h.clientY,16)}),t().keypress(function(h){o.collectInt(h.charCode,8)}))}if(!_t.random)_t.random=o;else for(var u in o)_t.random[u]=o[u];_t.random.createInstance=i,bi.exports=_t.random})(typeof jQuery<"u"?jQuery:null)})()});var Ga=$((n1,za)=>{var qt=ct();wt();var Ei=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Fa=[1,2,3,5],Sc=function(t,e){return t<<e&65535|(t&65535)>>16-e},Ac=function(t,e){return(t&65535)>>e|t<<16-e&65535};za.exports=qt.rc2=qt.rc2||{};qt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=qt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,o=Math.ceil(i/8),s=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Ei[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-o,Ei[r.at(128-o)&s]),a=127-o;a>=0;a--)r.setAt(a,Ei[r.at(a+1)^r.at(a+o)]);return r};var Ha=function(t,e,r){var n=!1,i=null,o=null,s=null,a,f,c,u,h=[];for(t=qt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(a=function(d){for(c=0;c<4;c++)d[c]+=h[u]+(d[(c+3)%4]&d[(c+2)%4])+(~d[(c+3)%4]&d[(c+1)%4]),d[c]=Sc(d[c],Fa[c]),u++},f=function(d){for(c=0;c<4;c++)d[c]+=h[d[(c+3)%4]&63]}):(a=function(d){for(c=3;c>=0;c--)d[c]=Ac(d[c],Fa[c]),d[c]-=h[u]+(d[(c+3)%4]&d[(c+2)%4])+(~d[(c+3)%4]&d[(c+1)%4]),u--},f=function(d){for(c=3;c>=0;c--)d[c]-=h[d[(c+3)%4]&63]});var l=function(d){var p=[];for(c=0;c<4;c++){var y=i.getInt16Le();s!==null&&(r?y^=s.getInt16Le():s.putInt16Le(y)),p.push(y&65535)}u=r?0:63;for(var m=0;m<d.length;m++)for(var E=0;E<d[m][0];E++)d[m][1](p);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(p[c]):p[c]^=s.getInt16Le()),o.putInt16Le(p[c])},x=null;return x={start:function(d,p){d&&typeof d=="string"&&(d=qt.util.createBuffer(d)),n=!1,i=qt.util.createBuffer(),o=p||new qt.util.createBuffer,s=d,x.output=o},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)l([[5,a],[1,f],[6,a],[1,f],[5,a]])},finish:function(d){var p=!0;if(r)if(d)p=d(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(p&&(n=!0,x.update()),!r&&(p=i.length()===0,p))if(d)p=d(8,o,!r);else{var m=o.length(),E=o.at(m-1);E>m?p=!1:o.truncate(E)}return p}},x};qt.rc2.startEncrypting=function(t,e,r){var n=qt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};qt.rc2.createEncryptionCipher=function(t,e){return Ha(t,e,!0)};qt.rc2.startDecrypting=function(t,e,r){var n=qt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};qt.rc2.createDecryptionCipher=function(t,e){return Ha(t,e,!1)}});var Cn=$((i1,ja)=>{var wi=ct();ja.exports=wi.jsbn=wi.jsbn||{};var we,Cc=0xdeadbeefcafe,Wa=(Cc&16777215)==15715070;function C(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}wi.jsbn.BigInteger=C;function rt(){return new C(null)}function Ic(t,e,r,n,i,o){for(;--o>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function Tc(t,e,r,n,i,o){for(var s=e&32767,a=e>>15;--o>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=a*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+a*c+(i>>>30),r.data[n++]=f&1073741823}return i}function Ya(t,e,r,n,i,o){for(var s=e&16383,a=e>>14;--o>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=a*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+a*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(C.prototype.am=Ya,we=28):Wa&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=Tc,we=30):Wa&&navigator.appName!="Netscape"?(C.prototype.am=Ic,we=26):(C.prototype.am=Ya,we=28);C.prototype.DB=we;C.prototype.DM=(1<<we)-1;C.prototype.DV=1<<we;var Bi=52;C.prototype.FV=Math.pow(2,Bi);C.prototype.F1=Bi-we;C.prototype.F2=2*we-Bi;var _c="0123456789abcdefghijklmnopqrstuvwxyz",Sn=new Array,lr,Wt;lr="0".charCodeAt(0);for(Wt=0;Wt<=9;++Wt)Sn[lr++]=Wt;lr="a".charCodeAt(0);for(Wt=10;Wt<36;++Wt)Sn[lr++]=Wt;lr="A".charCodeAt(0);for(Wt=10;Wt<36;++Wt)Sn[lr++]=Wt;function Za(t){return _c.charAt(t)}function $a(t,e){var r=Sn[t.charCodeAt(e)];return r??-1}function Rc(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Lc(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Ne(t){var e=rt();return e.fromInt(t),e}function Dc(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=r==8?t[n]&255:$a(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&t[0]&128&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&C.ZERO.subTo(this,this)}function Nc(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function kc(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=Za(n));s>=0;)a<e?(n=(this.data[s]&(1<<a)-1)<<e-a,n|=this.data[--s]>>(a+=this.DB-e)):(n=this.data[s]>>(a-=e)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=Za(n));return i?o:"0"}function Pc(){var t=rt();return C.ZERO.subTo(this,t),t}function Kc(){return this.s<0?this.negate():this}function Uc(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function An(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Oc(){return this.t<=0?0:this.DB*(this.t-1)+An(this.data[this.t-1]^this.s&this.DM)}function Mc(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function qc(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Vc(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(t/this.DB),s=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+o+1]=this.data[a]>>n|s,s=(this.data[a]&i)<<r;for(a=o-1;a>=0;--a)e.data[a]=0;e.data[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function Fc(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&o)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function Hc(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function zc(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&C.ZERO.subTo(e,e)}function Gc(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Wc(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=rt());var o=rt(),s=this.s,a=t.s,f=this.DB-An(n.data[n.t-1]);f>0?(n.lShiftTo(f,o),i.lShiftTo(f,r)):(n.copyTo(o),i.copyTo(r));var c=o.t,u=o.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?o.data[c-2]>>this.F2:0),l=this.FV/h,x=(1<<this.F1)/h,d=1<<this.F2,p=r.t,y=p-c,m=e??rt();for(o.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),C.ONE.dlShiftTo(c,m),m.subTo(o,o);o.t<c;)o.data[o.t++]=0;for(;--y>=0;){var E=r.data[--p]==u?this.DM:Math.floor(r.data[p]*l+(r.data[p-1]+d)*x);if((r.data[p]+=o.am(0,E,r,y,0,c))<E)for(o.dlShiftTo(y,m),r.subTo(m,r);r.data[p]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=a&&C.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&C.ZERO.subTo(r,r)}}}function Yc(t){var e=rt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(C.ZERO)>0&&t.subTo(e,e),e}function $e(t){this.m=t}function Zc(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function $c(t){return t}function Qc(t){t.divRemTo(this.m,null,t)}function Xc(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Jc(t,e){t.squareTo(e),this.reduce(e)}$e.prototype.convert=Zc;$e.prototype.revert=$c;$e.prototype.reduce=Qc;$e.prototype.mulTo=Xc;$e.prototype.sqrTo=Jc;function jc(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Qe(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function tu(t){var e=rt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(C.ZERO)>0&&this.m.subTo(e,e),e}function eu(t){var e=rt();return t.copyTo(e),this.reduce(e),e}function ru(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function nu(t,e){t.squareTo(e),this.reduce(e)}function iu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Qe.prototype.convert=tu;Qe.prototype.revert=eu;Qe.prototype.reduce=ru;Qe.prototype.mulTo=iu;Qe.prototype.sqrTo=nu;function ou(){return(this.t>0?this.data[0]&1:this.s)==0}function au(t,e){if(t>4294967295||t<1)return C.ONE;var r=rt(),n=rt(),i=e.convert(this),o=An(t)-1;for(i.copyTo(r);--o>=0;)if(e.sqrTo(r,n),(t&1<<o)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function su(t,e){var r;return t<256||e.isEven()?r=new $e(e):r=new Qe(e),this.exp(t,r)}C.prototype.copyTo=Rc;C.prototype.fromInt=Lc;C.prototype.fromString=Dc;C.prototype.clamp=Nc;C.prototype.dlShiftTo=Mc;C.prototype.drShiftTo=qc;C.prototype.lShiftTo=Vc;C.prototype.rShiftTo=Fc;C.prototype.subTo=Hc;C.prototype.multiplyTo=zc;C.prototype.squareTo=Gc;C.prototype.divRemTo=Wc;C.prototype.invDigit=jc;C.prototype.isEven=ou;C.prototype.exp=au;C.prototype.toString=kc;C.prototype.negate=Pc;C.prototype.abs=Kc;C.prototype.compareTo=Uc;C.prototype.bitLength=Oc;C.prototype.mod=Yc;C.prototype.modPowInt=su;C.ZERO=Ne(0);C.ONE=Ne(1);function fu(){var t=rt();return this.copyTo(t),t}function cu(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function uu(){return this.t==0?this.s:this.data[0]<<24>>24}function hu(){return this.t==0?this.s:this.data[0]<<16>>16}function lu(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function du(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function pu(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Ne(r),i=rt(),o=rt(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function yu(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,o=0,s=0,a=0;a<t.length;++a){var f=$a(t,a);if(f<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),i&&C.ZERO.subTo(this,this)}function xu(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(C.ONE.shiftLeft(t-1),Si,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(C.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function gu(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function mu(t){return this.compareTo(t)==0}function vu(t){return this.compareTo(t)<0?this:t}function bu(t){return this.compareTo(t)>0?this:t}function Eu(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function wu(t,e){return t&e}function Bu(t){var e=rt();return this.bitwiseTo(t,wu,e),e}function Si(t,e){return t|e}function Su(t){var e=rt();return this.bitwiseTo(t,Si,e),e}function Qa(t,e){return t^e}function Au(t){var e=rt();return this.bitwiseTo(t,Qa,e),e}function Xa(t,e){return t&~e}function Cu(t){var e=rt();return this.bitwiseTo(t,Xa,e),e}function Iu(){for(var t=rt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Tu(t){var e=rt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function _u(t){var e=rt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Ru(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Lu(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Ru(this.data[t]);return this.s<0?this.t*this.DB:-1}function Du(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Nu(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Du(this.data[r]^e);return t}function ku(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Pu(t,e){var r=C.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Ku(t){return this.changeBit(t,Si)}function Uu(t){return this.changeBit(t,Xa)}function Ou(t){return this.changeBit(t,Qa)}function Mu(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function qu(t){var e=rt();return this.addTo(t,e),e}function Vu(t){var e=rt();return this.subTo(t,e),e}function Fu(t){var e=rt();return this.multiplyTo(t,e),e}function Hu(t){var e=rt();return this.divRemTo(t,e,null),e}function zu(t){var e=rt();return this.divRemTo(t,null,e),e}function Gu(t){var e=rt(),r=rt();return this.divRemTo(t,e,r),new Array(e,r)}function Wu(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Yu(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function zr(){}function Ja(t){return t}function Zu(t,e,r){t.multiplyTo(e,r)}function $u(t,e){t.squareTo(e)}zr.prototype.convert=Ja;zr.prototype.revert=Ja;zr.prototype.mulTo=Zu;zr.prototype.sqrTo=$u;function Qu(t){return this.exp(t,new zr)}function Xu(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Ju(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function dr(t){this.r2=rt(),this.q3=rt(),C.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function ju(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=rt();return t.copyTo(e),this.reduce(e),e}function th(t){return t}function eh(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function rh(t,e){t.squareTo(e),this.reduce(e)}function nh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}dr.prototype.convert=ju;dr.prototype.revert=th;dr.prototype.reduce=eh;dr.prototype.mulTo=nh;dr.prototype.sqrTo=rh;function ih(t,e){var r=t.bitLength(),n,i=Ne(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new $e(e):e.isEven()?o=new dr(e):o=new Qe(e);var s=new Array,a=3,f=n-1,c=(1<<n)-1;if(s[1]=o.convert(this),n>1){var u=rt();for(o.sqrTo(s[1],u);a<=c;)s[a]=rt(),o.mulTo(u,s[a-2],s[a]),a+=2}var h=t.t-1,l,x=!0,d=rt(),p;for(r=An(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&c:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),x)s[l].copyTo(i),x=!1;else{for(;a>1;)o.sqrTo(i,d),o.sqrTo(d,i),a-=2;a>0?o.sqrTo(i,d):(p=i,i=d,d=p),o.mulTo(d,s[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)o.sqrTo(i,d),p=i,i=d,d=p,--r<0&&(r=this.DB-1,--h)}return o.revert(i)}function oh(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function ah(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function sh(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return C.ZERO;for(var r=t.clone(),n=this.clone(),i=Ne(1),o=Ne(0),s=Ne(0),a=Ne(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),e&&s.subTo(i,s),a.subTo(o,a))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var Jt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],fh=(1<<26)/Jt[Jt.length-1];function ch(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Jt[Jt.length-1]){for(e=0;e<Jt.length;++e)if(r.data[0]==Jt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Jt.length;){for(var n=Jt[e],i=e+1;i<Jt.length&&n<fh;)n*=Jt[i++];for(n=r.modInt(n);e<i;)if(n%Jt[e++]==0)return!1}return r.millerRabin(t)}function uh(t){var e=this.subtract(C.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=hh(),o,s=0;s<t;++s){do o=new C(this.bitLength(),i);while(o.compareTo(C.ONE)<=0||o.compareTo(e)>=0);var a=o.modPow(n,this);if(a.compareTo(C.ONE)!=0&&a.compareTo(e)!=0){for(var f=1;f++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(C.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function hh(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=lu;C.prototype.toRadix=pu;C.prototype.fromRadix=yu;C.prototype.fromNumber=xu;C.prototype.bitwiseTo=Eu;C.prototype.changeBit=Pu;C.prototype.addTo=Mu;C.prototype.dMultiply=Wu;C.prototype.dAddOffset=Yu;C.prototype.multiplyLowerTo=Xu;C.prototype.multiplyUpperTo=Ju;C.prototype.modInt=ah;C.prototype.millerRabin=uh;C.prototype.clone=fu;C.prototype.intValue=cu;C.prototype.byteValue=uu;C.prototype.shortValue=hu;C.prototype.signum=du;C.prototype.toByteArray=gu;C.prototype.equals=mu;C.prototype.min=vu;C.prototype.max=bu;C.prototype.and=Bu;C.prototype.or=Su;C.prototype.xor=Au;C.prototype.andNot=Cu;C.prototype.not=Iu;C.prototype.shiftLeft=Tu;C.prototype.shiftRight=_u;C.prototype.getLowestSetBit=Lu;C.prototype.bitCount=Nu;C.prototype.testBit=ku;C.prototype.setBit=Ku;C.prototype.clearBit=Uu;C.prototype.flipBit=Ou;C.prototype.add=qu;C.prototype.subtract=Vu;C.prototype.multiply=Fu;C.prototype.divide=Hu;C.prototype.remainder=zu;C.prototype.divideAndRemainder=Gu;C.prototype.modPow=ih;C.prototype.modInverse=sh;C.prototype.pow=Qu;C.prototype.gcd=oh;C.prototype.isProbablePrime=ch});var is=$((o1,ns)=>{var ce=ct();Ze();wt();var es=ns.exports=ce.sha1=ce.sha1||{};ce.md.sha1=ce.md.algorithms.sha1=es;es.create=function(){rs||lh();var t=null,e=ce.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=ce.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=ce.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),ts(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ce.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Ai.substr(0,n.blockLength-s));for(var a,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,f=a/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=a>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};ts(h,r,i);var l=ce.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Ai=null,rs=!1;function lh(){Ai=String.fromCharCode(128),Ai+=ce.util.fillString(String.fromCharCode(0),64),rs=!0}function ts(t,e,r){for(var n,i,o,s,a,f,c,u,h=r.length();h>=64;){for(i=t.h0,o=t.h1,s=t.h2,a=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^o&(s^a),n=(i<<5|i>>>27)+c+f+1518500249+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+1859775393+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o&s|a&(o^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=o^s^a,n=(i<<5|i>>>27)+c+f+3395469782+n,f=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+s|0,t.h3=t.h3+a|0,t.h4=t.h4+f|0,h-=64}}});var ss=$((a1,as)=>{var ue=ct();wt();Hr();is();var os=as.exports=ue.pkcs1=ue.pkcs1||{};os.encode_rsa_oaep=function(t,e,r){var n,i,o,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),o?o.start():o=ue.md.sha1.create(),s||(s=o);var a=Math.ceil(t.n.bitLength()/8),f=a-2*o.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),o.update(n,"raw");for(var u=o.digest(),h="",l=f-e.length,x=0;x<l;x++)h+="\0";var d=u.getBytes()+h+""+e;if(!i)i=ue.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=o.digestLength,c}var p=In(i,a-o.digestLength-1,s),y=ue.util.xorBytes(d,p,d.length),m=In(y,o.digestLength,s),E=ue.util.xorBytes(i,m,i.length);return"\0"+E+y};os.decode_rsa_oaep=function(t,e,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=s,y}if(i===void 0?i=ue.md.sha1.create():i.start(),o||(o=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=In(u,i.digestLength,o),l=ue.util.xorBytes(c,h,c.length),x=In(l,s-i.digestLength-1,o),d=ue.util.xorBytes(u,x,u.length),p=d.substring(0,i.digestLength),y=f!=="\0",m=0;m<i.digestLength;++m)y|=a.charAt(m)!==p.charAt(m);for(var E=1,b=i.digestLength,R=i.digestLength;R<d.length;R++){var w=d.charCodeAt(R),B=w&1^1,L=E?65534:0;y|=w&L,E=E&B,b+=E}if(y||d.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(b+1)};function In(t,e,r){r||(r=ue.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),o=0;o<i;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var fs=$((s1,Ci)=>{var ke=ct();wt();Cn();Hr();(function(){if(ke.prime){Ci.exports=ke.prime;return}var t=Ci.exports=ke.prime=ke.prime||{},e=ke.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,x){typeof l=="function"&&(x=l,l={}),l=l||{};var d=l.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var p=l.prng||ke.random,y={nextBytes:function(m){for(var E=p.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=E.charCodeAt(b)}};if(d.name==="PRIMEINC")return o(h,y,d.options,x);throw new Error("Invalid prime generation algorithm: "+d.name)};function o(h,l,x,d){return"workers"in x?f(h,l,x,d):s(h,l,x,d)}function s(h,l,x,d){var p=c(h,l),y=0,m=u(p.bitLength());"millerRabinTests"in x&&(m=x.millerRabinTests);var E=10;"maxBlockTime"in x&&(E=x.maxBlockTime),a(p,h,l,y,m,E,d)}function a(h,l,x,d,p,y,m){var E=+new Date;do{if(h.bitLength()>l&&(h=c(l,x)),h.isProbablePrime(p))return m(null,h);h.dAddOffset(r[d++%8],0)}while(y<0||+new Date-E<y);ke.util.setImmediate(function(){a(h,l,x,d,p,y,m)})}function f(h,l,x,d){if(typeof Worker>"u")return s(h,l,x,d);var p=c(h,l),y=x.workers,m=x.workLoad||100,E=m*30/8,b=x.workerScript||"forge/prime.worker.js";if(y===-1)return ke.util.estimateCores(function(w,B){w&&(B=2),y=B-1,R()});R();function R(){y=Math.max(1,y);for(var w=[],B=0;B<y;++B)w[B]=new Worker(b);for(var L=y,B=0;B<y;++B)w[B].addEventListener("message",z);var D=!1;function z(H){if(!D){--L;var V=H.data;if(V.found){for(var X=0;X<w.length;++X)w[X].terminate();return D=!0,d(null,new e(V.prime,16))}p.bitLength()>h&&(p=c(h,l));var ft=p.toString(16);H.target.postMessage({hex:ft,workLoad:m}),p.dAddOffset(E,0)}}}}function c(h,l){var x=new e(h,l),d=h-1;return x.testBit(d)||x.bitwiseTo(e.ONE.shiftLeft(d),i,x),x.dAddOffset(31-x.mod(n).byteValue(),0),x}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var _n=$((f1,ys)=>{var q=ct();Fr();Cn();dn();ss();fs();Hr();wt();typeof tt>"u"&&(tt=q.jsbn.BigInteger);var tt,Ii=q.util.isNodejs?bn():null,v=q.asn1,Yt=q.util;q.pki=q.pki||{};ys.exports=q.pki.rsa=q.rsa=q.rsa||{};var G=q.pki,dh=[6,4,2,4,2,4,6,2],ph={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},yh={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},xh={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},gh=q.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},mh={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},vh=function(t){var e;if(t.algorithm in G.oids)e=G.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=v.oidToDer(e).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),o=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);o.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),o.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var s=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(o),i.value.push(s),v.toDer(i).getBytes()},ds=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(tt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(tt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new tt(q.util.bytesToHex(q.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(tt.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);var s=i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};G.rsa.encrypt=function(t,e,r){var n=r,i,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=ps(t,e,r)):(i=q.util.createBuffer(),i.putBytes(t));for(var s=new tt(i.toHex(),16),a=ds(s,e,n),f=a.toString(16),c=q.util.createBuffer(),u=o-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(q.util.hexToBytes(f)),c.getBytes()};G.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=t.length,o.expected=i,o}var s=new tt(q.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=ds(s,e,r),f=a.toString(16),c=q.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(q.util.hexToBytes(f)),n!==!1?Tn(c.getBytes(),e,r):c.getBytes()};G.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||q.random,i={nextBytes:function(a){for(var f=n.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=f.charCodeAt(c)}},o=r.algorithm||"PRIMEINC",s;if(o==="PRIMEINC")s={algorithm:o,state:0,bits:t,rng:i,eInt:e||65537,e:new tt(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+o);return s};G.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new tt(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},o=+new Date,s,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new tt(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(tt.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Eh(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(dh[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(tt.ONE).gcd(t.e).compareTo(tt.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(tt.ONE),t.q1=t.q.subtract(tt.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(tt.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)}}s=+new Date,a+=s-o,o=s}return t.keys!==null};G.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!q.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(cs("generateKeyPair"))return Ii.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,f,c){if(a)return n(a);n(null,{privateKey:G.privateKeyFromPem(c),publicKey:G.publicKeyFromPem(f)})});if(us("generateKey")&&us("exportKey"))return Yt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:ls(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Yt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var f=G.privateKeyFromAsn1(v.fromDer(q.util.createBuffer(a)));n(null,{privateKey:f,publicKey:G.setRsaPublicKey(f.n,f.e)})}});if(hs("generateKey")&&hs("exportKey")){var i=Yt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:ls(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var f=a.target.result,c=Yt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=G.privateKeyFromAsn1(v.fromDer(q.util.createBuffer(h)));n(null,{privateKey:l,publicKey:G.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(cs("generateKeyPairSync")){var o=Ii.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:G.privateKeyFromPem(o.privateKey),publicKey:G.publicKeyFromPem(o.publicKey)}}}var s=G.rsa.createKeyPairGenerationState(t,e,r);if(!n)return G.rsa.stepKeyPairGenerationState(s,0),s.keys;bh(s,r,n)};G.setRsaPublicKey=G.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,f,c){return ps(a,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,f){return q.pkcs1.encode_rsa_oaep(f,a,o)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return G.rsa.encrypt(s,r,!0)},r.verify=function(n,i,o,s){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:function(f,c){c=Tn(c,r,!0);var u=v.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!v.validate(u,mh,h,l)){var x=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw x.errors=l,x}var d=v.derToOid(h.algorithmIdentifier);if(!(d===q.oids.md2||d===q.oids.md5||d===q.oids.sha1||d===q.oids.sha224||d===q.oids.sha256||d===q.oids.sha384||d===q.oids.sha512||d===q.oids["sha512-224"]||d===q.oids["sha512-256"])){var x=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw x.oid=d,x}if((d===q.oids.md2||d===q.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:function(f,c){return c=Tn(c,r,!0),f===c}});var a=G.rsa.decrypt(i,r,!0,!1);return o.verify(n,a,r.n.bitLength())},r};G.setRsaPrivateKey=G.rsa.setPrivateKey=function(t,e,r,n,i,o,s,a){var f={n:t,e,d:r,p:n,q:i,dP:o,dQ:s,qInv:a};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=G.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Tn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(x,d){return q.pkcs1.decode_rsa_oaep(d,x,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(x){return x}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:vh},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return G.rsa.encrypt(l,f,h)},f};G.wrapRsaPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(t).getBytes())])};G.privateKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,ph,e,r)&&(t=v.fromDer(q.util.createBuffer(e.privateKey))),e={},r=[],!v.validate(t,yh,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,s,a,f,c,u,h;return i=q.util.createBuffer(e.privateKeyModulus).toHex(),o=q.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=q.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=q.util.createBuffer(e.privateKeyPrime1).toHex(),f=q.util.createBuffer(e.privateKeyPrime2).toHex(),c=q.util.createBuffer(e.privateKeyExponent1).toHex(),u=q.util.createBuffer(e.privateKeyExponent2).toHex(),h=q.util.createBuffer(e.privateKeyCoefficient).toHex(),G.setRsaPrivateKey(new tt(i,16),new tt(o,16),new tt(s,16),new tt(a,16),new tt(f,16),new tt(c,16),new tt(u,16),new tt(h,16))};G.privateKeyToAsn1=G.privateKeyToRSAPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.qInv))])};G.publicKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,gh,e,r)){var n=v.derToOid(e.publicKeyOid);if(n!==G.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!v.validate(t,xh,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=q.util.createBuffer(e.publicKeyModulus).toHex(),s=q.util.createBuffer(e.publicKeyExponent).toHex();return G.setRsaPublicKey(new tt(o,16),new tt(s,16))};G.publicKeyToAsn1=G.publicKeyToSubjectPublicKeyInfo=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[G.publicKeyToRSAPublicKey(t)])])};G.publicKeyToRSAPublicKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,he(t.e))])};function ps(t,e,r){var n=q.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var s=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<s;++f)n.putByte(a)}else for(;s>0;){for(var c=0,u=q.random.getBytes(s),f=0;f<s;++f)a=u.charCodeAt(f),a===0?++c:n.putByte(a);s=c}return n.putByte(0),n.putBytes(t),n}function Tn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),o=q.util.createBuffer(t),s=o.getByte(),a=o.getByte();if(s!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=i-3-n;for(var c=0;c<f;++c)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(f=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++f}else if(a===2)for(f=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++f}var u=o.getByte();if(u!==0||f!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function bh(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){o(t.pBits,function(a,f){if(a)return r(a);if(t.p=f,t.q!==null)return s(a,t.q);o(t.qBits,s)})}function o(a,f){q.prime.generateProbablePrime(a,n,f)}function s(a,f){if(a)return r(a);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(tt.ONE).gcd(t.e).compareTo(tt.ONE)!==0){t.p=null,i();return}if(t.q.subtract(tt.ONE).gcd(t.e).compareTo(tt.ONE)!==0){t.q=null,o(t.qBits,s);return}if(t.p1=t.p.subtract(tt.ONE),t.q1=t.q.subtract(tt.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(tt.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,o(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function he(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=q.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Eh(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function cs(t){return q.util.isNodejs&&typeof Ii[t]=="function"}function us(t){return typeof Yt.globalScope<"u"&&typeof Yt.globalScope.crypto=="object"&&typeof Yt.globalScope.crypto.subtle=="object"&&typeof Yt.globalScope.crypto.subtle[t]=="function"}function hs(t){return typeof Yt.globalScope<"u"&&typeof Yt.globalScope.msCrypto=="object"&&typeof Yt.globalScope.msCrypto.subtle=="object"&&typeof Yt.globalScope.msCrypto.subtle[t]=="function"}function ls(t){for(var e=q.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Es=$((c1,bs)=>{var K=ct();mi();Fr();Aa();Ze();dn();Ra();Na();Hr();Ga();_n();wt();typeof xs>"u"&&(xs=K.jsbn.BigInteger);var xs,S=K.asn1,W=K.pki=K.pki||{};bs.exports=W.pbe=K.pbe=K.pbe||{};var Xe=W.oids,wh={name:"EncryptedPrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Bh={name:"PBES2Algorithms",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Sh={name:"pkcs-12PbeParams",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"iterations"}]};W.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=K.random.getBytesSync(r.saltSize),i=r.count,o=S.integerToDer(i),s,a,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":s=16,c=16,u=Xe["aes128-CBC"],h=K.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=Xe["aes192-CBC"],h=K.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=Xe["aes256-CBC"],h=K.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=Xe.desCBC,h=K.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var x="hmacWith"+r.prfAlgorithm.toUpperCase(),d=vs(x),p=K.pkcs5.pbkdf2(e,n,i,s,d),y=K.random.getBytesSync(c),m=h(p);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes();var E=Ah(n,o,s,x);a=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Xe.pkcs5PBES2).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Xe.pkcs5PBKDF2).getBytes()),E]),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(u).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){s=24;var b=new K.util.ByteBuffer(n),p=W.pbe.generatePkcs12Key(e,b,1,i,s),y=W.pbe.generatePkcs12Key(e,b,2,i,s),m=K.des.createEncryptionCipher(p);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes(),a=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Xe["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,n),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,o.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var R=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[a,S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,f)]);return R};W.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!S.validate(t,wh,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=S.derToOid(n.encryptionOid),a=W.pbe.getCipher(s,n.encryptionParams,e),f=K.util.createBuffer(n.encryptedData);return a.update(f),a.finish()&&(r=S.fromDer(a.output)),r};W.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:S.toDer(t).getBytes()};return K.pem.encode(r,{maxline:e})};W.encryptedPrivateKeyFromPem=function(t){var e=K.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return S.fromDer(e.body)};W.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=W.wrapRsaPrivateKey(W.privateKeyToAsn1(t));return n=W.encryptPrivateKeyInfo(n,e,r),W.encryptedPrivateKeyToPem(n)}var i,o,s,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,o=K.random.getBytesSync(16),a=K.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,o=K.random.getBytesSync(16),a=K.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,o=K.random.getBytesSync(16),a=K.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,o=K.random.getBytesSync(8),a=K.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,o=K.random.getBytesSync(8),a=K.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=K.pbe.opensslDeriveBytes(e,o.substr(0,8),s),u=a(c);u.start(o),u.update(S.toDer(W.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:K.util.bytesToHex(o).toUpperCase()},body:u.output.getBytes()};return K.pem.encode(h)};W.decryptRsaPrivateKey=function(t,e){var r=null,n=K.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,s;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,s=K.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,s=K.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,s=K.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,s=K.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,s=K.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,s=function(h){return K.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":o=8,s=function(h){return K.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":o=16,s=function(h){return K.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=K.util.hexToBytes(n.dekInfo.parameters),f=K.pbe.opensslDeriveBytes(e,a.substr(0,8),o),c=s(f);if(c.start(a),c.update(K.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=W.decryptPrivateKeyInfo(S.fromDer(r),e):r=S.fromDer(r),r!==null&&(r=W.privateKeyFromAsn1(r)),r};W.pbe.generatePkcs12Key=function(t,e,r,n,i,o){var s,a;if(typeof o>"u"||o===null){if(!("sha1"in K.md))throw new Error('"sha1" hash algorithm unavailable.');o=K.md.sha1.create()}var f=o.digestLength,c=o.blockLength,u=new K.util.ByteBuffer,h=new K.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),x=e.length(),d=new K.util.ByteBuffer;d.fillWithByte(r,c);var p=c*Math.ceil(x/c),y=new K.util.ByteBuffer;for(a=0;a<p;a++)y.putByte(e.at(a%x));var m=c*Math.ceil(l/c),E=new K.util.ByteBuffer;for(a=0;a<m;a++)E.putByte(h.at(a%l));var b=y;b.putBuffer(E);for(var R=Math.ceil(i/f),w=1;w<=R;w++){var B=new K.util.ByteBuffer;B.putBytes(d.bytes()),B.putBytes(b.bytes());for(var L=0;L<n;L++)o.start(),o.update(B.getBytes()),B=o.digest();var D=new K.util.ByteBuffer;for(a=0;a<c;a++)D.putByte(B.at(a%f));var z=Math.ceil(x/c)+Math.ceil(l/c),H=new K.util.ByteBuffer;for(s=0;s<z;s++){var V=new K.util.ByteBuffer(b.getBytes(c)),X=511;for(a=D.length()-1;a>=0;a--)X=X>>8,X+=D.at(a)+V.at(a),V.setAt(a,X&255);H.putBuffer(V)}b=H,u.putBuffer(B)}return u.truncate(u.length()-i),u};W.pbe.getCipher=function(t,e,r){switch(t){case W.oids.pkcs5PBES2:return W.pbe.getCipherForPBES2(t,e,r);case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case W.oids["pbewithSHAAnd40BitRC2-CBC"]:return W.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};W.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!S.validate(e,Bh,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(t=S.derToOid(n.kdfOid),t!==W.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=t,o.supportedOids=["pkcs5PBKDF2"],o}if(t=S.derToOid(n.encOid),t!==W.oids["aes128-CBC"]&&t!==W.oids["aes192-CBC"]&&t!==W.oids["aes256-CBC"]&&t!==W.oids["des-EDE3-CBC"]&&t!==W.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=t,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var s=n.kdfSalt,a=K.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var f,c;switch(W.oids[t]){case"aes128-CBC":f=16,c=K.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=K.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=K.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=K.des.createDecryptionCipher;break;case"desCBC":f=8,c=K.des.createDecryptionCipher;break}var u=ms(n.prfOid),h=K.pkcs5.pbkdf2(r,s,a,f,u),l=n.encIv,x=c(h);return x.start(l),x};W.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!S.validate(e,Sh,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=K.util.createBuffer(n.salt),a=K.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var f,c,u;switch(t){case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=K.des.startDecrypting;break;case W.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(p,y){var m=K.rc2.createDecryptionCipher(p,40);return m.start(y,null),m};break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=t,o}var h=ms(n.prfOid),l=W.pbe.generatePkcs12Key(r,s,1,a,f,h);h.start();var x=W.pbe.generatePkcs12Key(r,s,2,a,c,h);return u(l,x)};W.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in K.md))throw new Error('"md5" hash algorithm unavailable.');n=K.md.md5.create()}e===null&&(e="");for(var i=[gs(n,t+e)],o=16,s=1;o<r;++s,o+=16)i.push(gs(n,i[s-1]+t+e));return i.join("").substr(0,r)};function gs(t,e){return t.start().update(e).digest().getBytes()}function ms(t){var e;if(!t)e="hmacWithSHA1";else if(e=W.oids[S.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return vs(e)}function vs(t){var e=K.md;switch(t){case"hmacWithSHA224":e=K.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Ah(t,e,r,n){var i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,K.util.hexToBytes(r.toString(16))),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(W.oids[n]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])),i}});var d0=$((d2,l0)=>{"use strict";l0.exports=Od;function Od(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,f){r[n]=function(u){if(o)if(o=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{t.apply(e||null,r)}catch(c){o&&(o=!1,f(c))}})}});var g0=$(x0=>{"use strict";var Zn=x0;Zn.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Tr=new Array(64),y0=new Array(123);for(ne=0;ne<64;)y0[Tr[ne]=ne<26?ne+65:ne<52?ne+71:ne<62?ne-4:ne-59|43]=ne++;var ne;Zn.encode=function(e,r,n){for(var i=null,o=[],s=0,a=0,f;r<n;){var c=e[r++];switch(a){case 0:o[s++]=Tr[c>>2],f=(c&3)<<4,a=1;break;case 1:o[s++]=Tr[f|c>>4],f=(c&15)<<2,a=2;break;case 2:o[s++]=Tr[f|c>>6],o[s++]=Tr[c&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=Tr[f],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var p0="invalid encoding";Zn.decode=function(e,r,n){for(var i=n,o=0,s,a=0;a<e.length;){var f=e.charCodeAt(a++);if(f===61&&o>1)break;if((f=y0[f])===void 0)throw Error(p0);switch(o){case 0:s=f,o=1;break;case 1:r[n++]=s<<2|(f&48)>>4,s=f,o=2;break;case 2:r[n++]=(s&15)<<4|(f&60)>>2,s=f,o=3;break;case 3:r[n++]=(s&3)<<6|f,o=0;break}}if(o===1)throw Error(p0);return n-i};Zn.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var v0=$((y2,m0)=>{"use strict";m0.exports=$n;function $n(){this._listeners={}}$n.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};$n.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};$n.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var C0=$((x2,A0)=>{"use strict";A0.exports=b0(b0);function b0(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function o(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:o,t.writeFloatBE=n?o:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function a(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?s:a,t.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((a<<31|f+127<<23|c)>>>0,o,s)}}t.writeFloatLE=e.bind(null,E0),t.writeFloatBE=e.bind(null,w0);function r(n,i,o){var s=n(i,o),a=(s>>31)*2+1,f=s>>>23&255,c=s&8388607;return f===255?c?NaN:a*(1/0):f===0?a*1401298464324817e-60*c:a*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,B0),t.readFloatBE=r.bind(null,S0)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function o(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:o,t.writeDoubleBE=n?o:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function a(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?s:a,t.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,f){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,a,f+i),n(1/s>0?0:2147483648,a,f+o);else if(isNaN(s))n(0,a,f+i),n(2146959360,a,f+o);else if(s>17976931348623157e292)n(0,a,f+i),n((c<<31|2146435072)>>>0,a,f+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,a,f+i),n((c<<31|u/4294967296)>>>0,a,f+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,a,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,a,f+o)}}}t.writeDoubleLE=e.bind(null,E0,0,4),t.writeDoubleBE=e.bind(null,w0,4,0);function r(n,i,o,s,a){var f=n(s,a+i),c=n(s,a+o),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,B0,0,4),t.readDoubleBE=r.bind(null,S0,4,0)}(),t}function E0(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function w0(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function B0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function S0(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var I0=$((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var _0=$(T0=>{"use strict";var po=T0;po.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};po.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var o=null,s=[],a=0,f;r<n;)f=e[r++],f<128?s[a++]=f:f>191&&f<224?s[a++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[a++]=55296+(f>>10),s[a++]=56320+(f&1023)):s[a++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};po.write=function(e,r,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=o&63|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=o&63|128);return n-i}});var L0=$((m2,R0)=>{"use strict";R0.exports=Md;function Md(t,e,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(f){if(f<1||f>i)return t(f);s+f>n&&(o=t(n),s=0);var c=e.call(o,s,s+=f);return s&7&&(s=(s|7)+1),c}}});var N0=$((v2,D0)=>{"use strict";D0.exports=Rt;var Jr=ir();function Rt(t,e){this.lo=t>>>0,this.hi=e>>>0}var nr=Rt.zero=new Rt(0,0);nr.toNumber=function(){return 0};nr.zzEncode=nr.zzDecode=function(){return this};nr.length=function(){return 1};var qd=Rt.zeroHash="\0\0\0\0\0\0\0\0";Rt.fromNumber=function(e){if(e===0)return nr;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Rt(n,i)};Rt.from=function(e){if(typeof e=="number")return Rt.fromNumber(e);if(Jr.isString(e))if(Jr.Long)e=Jr.Long.fromString(e);else return Rt.fromNumber(parseInt(e,10));return e.low||e.high?new Rt(e.low>>>0,e.high>>>0):nr};Rt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Rt.prototype.toLong=function(e){return Jr.Long?new Jr.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Ve=String.prototype.charCodeAt;Rt.fromHash=function(e){return e===qd?nr:new Rt((Ve.call(e,0)|Ve.call(e,1)<<8|Ve.call(e,2)<<16|Ve.call(e,3)<<24)>>>0,(Ve.call(e,4)|Ve.call(e,5)<<8|Ve.call(e,6)<<16|Ve.call(e,7)<<24)>>>0)};Rt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Rt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Rt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Rt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var ir=$(yo=>{"use strict";var M=yo;M.asPromise=d0();M.base64=g0();M.EventEmitter=v0();M.float=C0();M.inquire=I0();M.utf8=_0();M.pool=L0();M.LongBits=N0();M.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);M.global=M.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||yo;M.emptyArray=Object.freeze?Object.freeze([]):[];M.emptyObject=Object.freeze?Object.freeze({}):{};M.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};M.isString=function(e){return typeof e=="string"||e instanceof String};M.isObject=function(e){return e&&typeof e=="object"};M.isset=M.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};M.Buffer=function(){try{var t=M.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();M._Buffer_from=null;M._Buffer_allocUnsafe=null;M.newBuffer=function(e){return typeof e=="number"?M.Buffer?M._Buffer_allocUnsafe(e):new M.Array(e):M.Buffer?M._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};M.Array=typeof Uint8Array<"u"?Uint8Array:Array;M.Long=M.global.dcodeIO&&M.global.dcodeIO.Long||M.global.Long||M.inquire("long");M.key2Re=/^true|false|0|1$/;M.key32Re=/^-?(?:0|[1-9][0-9]*)$/;M.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;M.longToHash=function(e){return e?M.LongBits.from(e).toHash():M.LongBits.zeroHash};M.longFromHash=function(e,r){var n=M.LongBits.fromHash(e);return M.Long?M.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function k0(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}M.merge=k0;M.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function P0(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&k0(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}M.newError=P0;M.ProtocolError=P0("ProtocolError");M.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(r[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};M.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};M.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};M._configure=function(){var t=M.Buffer;if(!t){M._Buffer_from=M._Buffer_allocUnsafe=null;return}M._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},M._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var mo=$((E2,q0)=>{"use strict";q0.exports=bt;var ye=ir(),go,O0=ye.LongBits,Vd=ye.utf8;function ie(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function bt(t){this.buf=t,this.pos=0,this.len=t.length}var K0=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new bt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new bt(e);throw Error("illegal buffer")},M0=function(){return ye.Buffer?function(r){return(bt.create=function(i){return ye.Buffer.isBuffer(i)?new go(i):K0(i)})(r)}:K0};bt.create=M0();bt.prototype._slice=ye.Array.prototype.subarray||ye.Array.prototype.slice;bt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,ie(this,10);return e}}();bt.prototype.int32=function(){return this.uint32()|0};bt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function xo(){var t=new O0(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw ie(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw ie(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}bt.prototype.bool=function(){return this.uint32()!==0};function Qn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}bt.prototype.fixed32=function(){if(this.pos+4>this.len)throw ie(this,4);return Qn(this.buf,this.pos+=4)};bt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ie(this,4);return Qn(this.buf,this.pos+=4)|0};function U0(){if(this.pos+8>this.len)throw ie(this,8);return new O0(Qn(this.buf,this.pos+=4),Qn(this.buf,this.pos+=4))}bt.prototype.float=function(){if(this.pos+4>this.len)throw ie(this,4);var e=ye.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};bt.prototype.double=function(){if(this.pos+8>this.len)throw ie(this,4);var e=ye.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};bt.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw ie(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};bt.prototype.string=function(){var e=this.bytes();return Vd.read(e,0,e.length)};bt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw ie(this,e);this.pos+=e}else do if(this.pos>=this.len)throw ie(this);while(this.buf[this.pos++]&128);return this};bt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};bt._configure=function(t){go=t,bt.create=M0(),go._configure();var e=ye.Long?"toLong":"toNumber";ye.merge(bt.prototype,{int64:function(){return xo.call(this)[e](!1)},uint64:function(){return xo.call(this)[e](!0)},sint64:function(){return xo.call(this).zzDecode()[e](!1)},fixed64:function(){return U0.call(this)[e](!0)},sfixed64:function(){return U0.call(this)[e](!1)}})}});var z0=$((w2,H0)=>{"use strict";H0.exports=or;var F0=mo();(or.prototype=Object.create(F0.prototype)).constructor=or;var V0=ir();function or(t){F0.call(this,t)}or._configure=function(){V0.Buffer&&(or.prototype._slice=V0.Buffer.prototype.slice)};or.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};or._configure()});var Ao=$((B2,Z0)=>{"use strict";Z0.exports=nt;var $t=ir(),vo,Xn=$t.LongBits,G0=$t.base64,W0=$t.utf8;function jr(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Eo(){}function Fd(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function nt(){this.len=0,this.head=new jr(Eo,0,0),this.tail=this.head,this.states=null}var Y0=function(){return $t.Buffer?function(){return(nt.create=function(){return new vo})()}:function(){return new nt}};nt.create=Y0();nt.alloc=function(e){return new $t.Array(e)};$t.Array!==Array&&(nt.alloc=$t.pool(nt.alloc,$t.Array.prototype.subarray));nt.prototype._push=function(e,r,n){return this.tail=this.tail.next=new jr(e,r,n),this.len+=r,this};function wo(t,e,r){e[r]=t&255}function Hd(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Bo(t,e){this.len=t,this.next=void 0,this.val=e}Bo.prototype=Object.create(jr.prototype);Bo.prototype.fn=Hd;nt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Bo((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};nt.prototype.int32=function(e){return e<0?this._push(So,10,Xn.fromNumber(e)):this.uint32(e)};nt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function So(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}nt.prototype.uint64=function(e){var r=Xn.from(e);return this._push(So,r.length(),r)};nt.prototype.int64=nt.prototype.uint64;nt.prototype.sint64=function(e){var r=Xn.from(e).zzEncode();return this._push(So,r.length(),r)};nt.prototype.bool=function(e){return this._push(wo,1,e?1:0)};function bo(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}nt.prototype.fixed32=function(e){return this._push(bo,4,e>>>0)};nt.prototype.sfixed32=nt.prototype.fixed32;nt.prototype.fixed64=function(e){var r=Xn.from(e);return this._push(bo,4,r.lo)._push(bo,4,r.hi)};nt.prototype.sfixed64=nt.prototype.fixed64;nt.prototype.float=function(e){return this._push($t.float.writeFloatLE,4,e)};nt.prototype.double=function(e){return this._push($t.float.writeDoubleLE,8,e)};var zd=$t.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};nt.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(wo,1,0);if($t.isString(e)){var n=nt.alloc(r=G0.length(e));G0.decode(e,n,0),e=n}return this.uint32(r)._push(zd,r,e)};nt.prototype.string=function(e){var r=W0.length(e);return r?this.uint32(r)._push(W0.write,r,e):this._push(wo,1,0)};nt.prototype.fork=function(){return this.states=new Fd(this),this.head=this.tail=new jr(Eo,0,0),this.len=0,this};nt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new jr(Eo,0,0),this.len=0),this};nt.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};nt.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};nt._configure=function(t){vo=t,nt.create=Y0(),vo._configure()}});var X0=$((S2,Q0)=>{"use strict";Q0.exports=xe;var $0=Ao();(xe.prototype=Object.create($0.prototype)).constructor=xe;var Fe=ir();function xe(){$0.call(this)}xe._configure=function(){xe.alloc=Fe._Buffer_allocUnsafe,xe.writeBytesBuffer=Fe.Buffer&&Fe.Buffer.prototype instanceof Uint8Array&&Fe.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};xe.prototype.bytes=function(e){Fe.isString(e)&&(e=Fe._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(xe.writeBytesBuffer,r,e),this};function Gd(t,e,r){t.length<40?Fe.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}xe.prototype.string=function(e){var r=Fe.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Gd,r,e),this};xe._configure()});var uf=$((Sx,cf)=>{var dt=ct();Ze();wt();var en=cf.exports=dt.sha512=dt.sha512||{};dt.md.sha512=dt.md.algorithms.sha512=en;var sf=dt.sha384=dt.sha512.sha384=dt.sha512.sha384||{};sf.create=function(){return en.create("SHA-384")};dt.md.sha384=dt.md.algorithms.sha384=sf;dt.sha512.sha256=dt.sha512.sha256||{create:function(){return en.create("SHA-512/256")}};dt.md["sha512/256"]=dt.md.algorithms["sha512/256"]=dt.sha512.sha256;dt.sha512.sha224=dt.sha512.sha224||{create:function(){return en.create("SHA-512/224")}};dt.md["sha512/224"]=dt.md.algorithms["sha512/224"]=dt.sha512.sha224;en.create=function(t){if(ff||ep(),typeof t>"u"&&(t="SHA-512"),!(t in sr))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=sr[t],r=null,n=dt.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var f=a.messageLengthSize/4,c=0;c<f;++c)a.fullMessageLength.push(0);n=dt.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return a},a.start(),a.update=function(f,c){c==="utf8"&&(f=dt.util.encodeUtf8(f));var u=f.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),af(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var f=dt.util.createBuffer();f.putBytes(n.bytes());var c=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=c&a.blockLength-1;f.putBytes(No.substr(0,a.blockLength-u));for(var h,l,x=a.fullMessageLength[0]*8,d=0;d<a.fullMessageLength.length-1;++d)h=a.fullMessageLength[d+1]*8,l=h/4294967296>>>0,x+=l,f.putInt32(x>>>0),x=h>>>0;f.putInt32(x);for(var p=new Array(r.length),d=0;d<r.length;++d)p[d]=r[d].slice(0);af(p,i,f);var y=dt.util.createBuffer(),m;t==="SHA-512"?m=p.length:t==="SHA-384"?m=p.length-2:m=p.length-4;for(var d=0;d<m;++d)y.putInt32(p[d][0]),(d!==m-1||t!=="SHA-512/224")&&y.putInt32(p[d][1]);return y},a};var No=null,ff=!1,ko=null,sr=null;function ep(){No=String.fromCharCode(128),No+=dt.util.fillString(String.fromCharCode(0),128),ko=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],sr={},sr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],sr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],sr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],sr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],ff=!0}function af(t,e,r){for(var n,i,o,s,a,f,c,u,h,l,x,d,p,y,m,E,b,R,w,B,L,D,z,H,V,X,ft,Lt,I,k,_,N,A,U,O,F=r.length();F>=128;){for(I=0;I<16;++I)e[I][0]=r.getInt32()>>>0,e[I][1]=r.getInt32()>>>0;for(;I<80;++I)N=e[I-2],k=N[0],_=N[1],n=((k>>>19|_<<13)^(_>>>29|k<<3)^k>>>6)>>>0,i=((k<<13|_>>>19)^(_<<3|k>>>29)^(k<<26|_>>>6))>>>0,U=e[I-15],k=U[0],_=U[1],o=((k>>>1|_<<31)^(k>>>8|_<<24)^k>>>7)>>>0,s=((k<<31|_>>>1)^(k<<24|_>>>8)^(k<<25|_>>>7))>>>0,A=e[I-7],O=e[I-16],_=i+A[1]+s+O[1],e[I][0]=n+A[0]+o+O[0]+(_/4294967296>>>0)>>>0,e[I][1]=_>>>0;for(p=t[0][0],y=t[0][1],m=t[1][0],E=t[1][1],b=t[2][0],R=t[2][1],w=t[3][0],B=t[3][1],L=t[4][0],D=t[4][1],z=t[5][0],H=t[5][1],V=t[6][0],X=t[6][1],ft=t[7][0],Lt=t[7][1],I=0;I<80;++I)c=((L>>>14|D<<18)^(L>>>18|D<<14)^(D>>>9|L<<23))>>>0,u=((L<<18|D>>>14)^(L<<14|D>>>18)^(D<<23|L>>>9))>>>0,h=(V^L&(z^V))>>>0,l=(X^D&(H^X))>>>0,a=((p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25))>>>0,f=((p<<4|y>>>28)^(y<<30|p>>>2)^(y<<25|p>>>7))>>>0,x=(p&m|b&(p^m))>>>0,d=(y&E|R&(y^E))>>>0,_=Lt+u+l+ko[I][1]+e[I][1],n=ft+c+h+ko[I][0]+e[I][0]+(_/4294967296>>>0)>>>0,i=_>>>0,_=f+d,o=a+x+(_/4294967296>>>0)>>>0,s=_>>>0,ft=V,Lt=X,V=z,X=H,z=L,H=D,_=B+i,L=w+n+(_/4294967296>>>0)>>>0,D=_>>>0,w=b,B=R,b=m,R=E,m=p,E=y,_=i+s,p=n+o+(_/4294967296>>>0)>>>0,y=_>>>0;_=t[0][1]+y,t[0][0]=t[0][0]+p+(_/4294967296>>>0)>>>0,t[0][1]=_>>>0,_=t[1][1]+E,t[1][0]=t[1][0]+m+(_/4294967296>>>0)>>>0,t[1][1]=_>>>0,_=t[2][1]+R,t[2][0]=t[2][0]+b+(_/4294967296>>>0)>>>0,t[2][1]=_>>>0,_=t[3][1]+B,t[3][0]=t[3][0]+w+(_/4294967296>>>0)>>>0,t[3][1]=_>>>0,_=t[4][1]+D,t[4][0]=t[4][0]+L+(_/4294967296>>>0)>>>0,t[4][1]=_>>>0,_=t[5][1]+H,t[5][0]=t[5][0]+z+(_/4294967296>>>0)>>>0,t[5][1]=_>>>0,_=t[6][1]+X,t[6][0]=t[6][0]+V+(_/4294967296>>>0)>>>0,t[6][1]=_>>>0,_=t[7][1]+Lt,t[7][0]=t[7][0]+ft+(_/4294967296>>>0)>>>0,t[7][1]=_>>>0,F-=128}}});var Up={};At(Up,{createEd25519PeerId:()=>Lp,createFromJSON:()=>Kp,createFromPrivKey:()=>un,createFromProtobuf:()=>Pp,createFromPubKey:()=>qf,createRSAPeerId:()=>Np,createSecp256k1PeerId:()=>Dp,exportToProtobuf:()=>kp});var Pg=Ct(Fr(),1),Kg=Ct(Es(),1);var et=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Ip=Ct(ct(),1);function pr(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var Di={};At(Di,{identity:()=>Lh});function Ch(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,f=t.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var p=0,y=0,m=0,E=d.length;m!==E&&d[m]===0;)m++,p++;for(var b=(E-m)*u+1>>>0,R=new Uint8Array(b);m!==E;){for(var w=d[m],B=0,L=b-1;(w!==0||B<y)&&L!==-1;L--,B++)w+=256*R[L]>>>0,R[L]=w%a>>>0,w=w/a>>>0;if(w!==0)throw new Error("Non-zero carry");y=B,m++}for(var D=b-y;D!==b&&R[D]===0;)D++;for(var z=f.repeat(p);D<b;++D)z+=t.charAt(R[D]);return z}function l(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var p=0;if(d[p]!==" "){for(var y=0,m=0;d[p]===f;)y++,p++;for(var E=(d.length-p)*c+1>>>0,b=new Uint8Array(E);d[p];){var R=r[d.charCodeAt(p)];if(R===255)return;for(var w=0,B=E-1;(R!==0||w<m)&&B!==-1;B--,w++)R+=a*b[B]>>>0,b[B]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");m=w,p++}if(d[p]!==" "){for(var L=E-m;L!==E&&b[L]===0;)L++;for(var D=new Uint8Array(y+(E-L)),z=y;L!==E;)D[z++]=b[L++];return D}}}function x(d){var p=l(d);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:x}}var Ih=Ch,Th=Ih,ws=Th;var d1=new Uint8Array(0);var Bs=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Be=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Ss=t=>new TextEncoder().encode(t),As=t=>new TextDecoder().decode(t);var Ti=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},_i=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Is(this,e)}},Ri=class{constructor(e){this.decoders=e}or(e){return Is(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Is=(t,e)=>new Ri({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Li=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ti(e,r,n),this.decoder=new _i(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},yr=({name:t,prefix:e,encode:r,decode:n})=>new Li(t,e,r,n),Pe=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=ws(r,e);return yr({prefix:t,name:e,encode:n,decode:o=>Be(i(o))})},_h=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,f=0,c=0;for(let u=0;u<o;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,a+=r,a>=8&&(a-=8,s[c++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return s},Rh=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},vt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>yr({prefix:e,name:t,encode(i){return Rh(i,n,r)},decode(i){return _h(i,n,r,t)}});var Lh=yr({prefix:"\0",name:"identity",encode:t=>As(t),decode:t=>Ss(t)});var Ni={};At(Ni,{base2:()=>Dh});var Dh=vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ki={};At(ki,{base8:()=>Nh});var Nh=vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Pi={};At(Pi,{base10:()=>kh});var kh=Pe({prefix:"9",name:"base10",alphabet:"0123456789"});var Ki={};At(Ki,{base16:()=>Ph,base16upper:()=>Kh});var Ph=vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Kh=vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ui={};At(Ui,{base32:()=>xr,base32hex:()=>qh,base32hexpad:()=>Fh,base32hexpadupper:()=>Hh,base32hexupper:()=>Vh,base32pad:()=>Oh,base32padupper:()=>Mh,base32upper:()=>Uh,base32z:()=>zh});var xr=vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Uh=vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Oh=vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Mh=vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qh=vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Vh=vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Fh=vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Hh=vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zh=vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Oi={};At(Oi,{base36:()=>Gh,base36upper:()=>Wh});var Gh=Pe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Wh=Pe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Mi={};At(Mi,{base58btc:()=>Mt,base58flickr:()=>Yh});var Mt=Pe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Yh=Pe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var qi={};At(qi,{base64:()=>Rn,base64pad:()=>Zh,base64url:()=>$h,base64urlpad:()=>Qh});var Rn=vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Zh=vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$h=vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Qh=vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Vi={};At(Vi,{base256emoji:()=>el});var Ts=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Xh=Ts.reduce((t,e,r)=>(t[r]=e,t),[]),Jh=Ts.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function jh(t){return t.reduce((e,r)=>(e+=Xh[r],e),"")}function tl(t){let e=[];for(let r of t){let n=Jh[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var el=yr({prefix:"\u{1F680}",name:"base256emoji",encode:jh,decode:tl});var Gi={};At(Gi,{sha256:()=>kt,sha512:()=>bl});var rl=Ls,_s=128,nl=127,il=~nl,ol=Math.pow(2,31);function Ls(t,e,r){e=e||[],r=r||0;for(var n=r;t>=ol;)e[r++]=t&255|_s,t/=128;for(;t&il;)e[r++]=t&255|_s,t>>>=7;return e[r]=t|0,Ls.bytes=r-n+1,e}var al=Fi,sl=128,Rs=127;function Fi(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw Fi.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&Rs)<<i:(s&Rs)*Math.pow(2,i),i+=7}while(s>=sl);return Fi.bytes=o-n,r}var fl=Math.pow(2,7),cl=Math.pow(2,14),ul=Math.pow(2,21),hl=Math.pow(2,28),ll=Math.pow(2,35),dl=Math.pow(2,42),pl=Math.pow(2,49),yl=Math.pow(2,56),xl=Math.pow(2,63),gl=function(t){return t<fl?1:t<cl?2:t<ul?3:t<hl?4:t<ll?5:t<dl?6:t<pl?7:t<yl?8:t<xl?9:10},ml={encode:rl,decode:al,encodingLength:gl},vl=ml,Gr=vl;var Wr=(t,e=0)=>[Gr.decode(t,e),Gr.decode.bytes],gr=(t,e,r=0)=>(Gr.encode(t,e,r),e),mr=t=>Gr.encodingLength(t);var le=(t,e)=>{let r=e.byteLength,n=mr(t),i=n+mr(r),o=new Uint8Array(i+r);return gr(t,o,0),gr(r,o,n),o.set(e,i),new vr(t,r,e,o)},Yr=t=>{let e=Be(t),[r,n]=Wr(e),[i,o]=Wr(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new vr(r,i,s,e)},Ds=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Bs(t.bytes,r.bytes)}},vr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var zi=({name:t,code:e,encode:r})=>new Hi(t,e,r),Hi=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?le(this.code,r):r.then(n=>le(this.code,n))}else throw Error("Unknown type, must be binary type")}};var ks=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),kt=zi({name:"sha2-256",code:18,encode:ks("SHA-256")}),bl=zi({name:"sha2-512",code:19,encode:ks("SHA-512")});var Wi={};At(Wi,{identity:()=>Ke});var Ps=0,El="identity",Ks=Be,wl=t=>le(Ps,Ks(t)),Ke={code:Ps,name:El,encode:Ks,digest:wl};var k1=new TextEncoder,P1=new TextDecoder;var Us=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Cl(r,Yi(t),e||Mt.encoder);default:return Il(r,Yi(t),e||xr.encoder)}};var Os=new WeakMap,Yi=t=>{let e=Os.get(t);if(e==null){let r=new Map;return Os.set(t,r),r}return e},Je=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Zr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Tl)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=le(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Ds(e.multihash,n.multihash)}toString(e){return Us(this,e)}toJSON(){return{"/":Us(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s||Ms(n,i,o.bytes))}else if(r[_l]===!0){let{version:n,multihash:i,code:o}=r,s=Yr(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Zr)throw new Error(`Version 0 CID must use dag-pb (code: ${Zr}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=Ms(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Zr,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=Be(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new vr(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Wr(e.subarray(r));return r+=l,h},i=n(),o=Zr;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:o,multihashCode:a,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=Al(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Yi(o).set(n,e),o}},Al=(t,e)=>{switch(t[0]){case"Q":{let r=e||Mt;return[Mt.prefix,r.decode(`${Mt.prefix}${t}`)]}case Mt.prefix:{let r=e||Mt;return[Mt.prefix,r.decode(t)]}case xr.prefix:{let r=e||xr;return[xr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Cl=(t,e,r)=>{let{prefix:n}=r;if(n!==Mt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},Il=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},Zr=112,Tl=18,Ms=(t,e,r)=>{let n=mr(t),i=n+mr(e),o=new Uint8Array(i+r.byteLength);return gr(t,o,0),gr(e,o,n),o.set(r,i),o},_l=Symbol.for("@ipld/js-cid/CID");var Er={...Di,...Ni,...ki,...Pi,...Ki,...Ui,...Oi,...Mi,...qi,...Vi},G1={...Gi,...Wi};function Dn(t=0){return globalThis.Buffer?.allocUnsafe!=null?pr(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Vs(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var qs=Vs("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Zi=Vs("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Dn(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Rl={utf8:qs,"utf-8":qs,hex:Er.base16,latin1:Zi,ascii:Zi,binary:Zi,...Er},Nn=Rl;function Pt(t,e="utf8"){let r=Nn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?pr(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var Do={};At(Do,{Ed25519PrivateKey:()=>ar,Ed25519PublicKey:()=>tn,generateKeyPair:()=>Xd,generateKeyPairFromSeed:()=>rf,unmarshalEd25519PrivateKey:()=>$d,unmarshalEd25519PublicKey:()=>Qd});function Ft(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function $i(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Ll(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Fs(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Dl(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");$i(t.outputLen),$i(t.blockLen)}function Nl(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function kl(t,e){Fs(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Pl={number:$i,bool:Ll,bytes:Fs,hash:Dl,exists:Nl,output:kl},Se=Pl;var kn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Hs=t=>t instanceof Uint8Array;var Pn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),jt=(t,e)=>t<<32-e|t>>>e,Kl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Kl)throw new Error("Non little-endian hardware is not supported");var oy=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Qi(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function $r(t){if(typeof t=="string"&&(t=Qi(t)),!Hs(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Kn(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Hs(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var wr=class{clone(){return this._cloneInto()}};function Ue(t){let e=n=>t().update($r(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function je(t=32){if(kn&&typeof kn.getRandomValues=="function")return kn.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Ul(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),f=n?4:0,c=n?0:4;t.setUint32(e+f,s,n),t.setUint32(e+c,a,n)}var Br=class extends wr{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Pn(this.buffer)}update(e){Se.exists(this);let{view:r,buffer:n,blockLen:i}=this;e=$r(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let f=Pn(e);for(;i<=o-s;s+=i)this.process(f,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Se.exists(this),Se.output(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)r[h]=0;Ul(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=Pn(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)a.setUint32(4*h,u[h],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};var Un=BigInt(4294967295),Xi=BigInt(32);function zs(t,e=!1){return e?{h:Number(t&Un),l:Number(t>>Xi&Un)}:{h:Number(t>>Xi&Un)|0,l:Number(t&Un)|0}}function Ol(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=zs(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}var Ml=(t,e)=>BigInt(t>>>0)<<Xi|BigInt(e>>>0),ql=(t,e,r)=>t>>>r,Vl=(t,e,r)=>t<<32-r|e>>>r,Fl=(t,e,r)=>t>>>r|e<<32-r,Hl=(t,e,r)=>t<<32-r|e>>>r,zl=(t,e,r)=>t<<64-r|e>>>r-32,Gl=(t,e,r)=>t>>>r-32|e<<64-r,Wl=(t,e)=>e,Yl=(t,e)=>t,Zl=(t,e,r)=>t<<r|e>>>32-r,$l=(t,e,r)=>e<<r|t>>>32-r,Ql=(t,e,r)=>e<<r-32|t>>>64-r,Xl=(t,e,r)=>t<<r-32|e>>>64-r;function Jl(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var jl=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),td=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,ed=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),rd=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,nd=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),id=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0,od={fromBig:zs,split:Ol,toBig:Ml,shrSH:ql,shrSL:Vl,rotrSH:Fl,rotrSL:Hl,rotrBH:zl,rotrBL:Gl,rotr32H:Wl,rotr32L:Yl,rotlSH:Zl,rotlSL:$l,rotlBH:Ql,rotlBL:Xl,add:Jl,add3L:jl,add3H:td,add4L:ed,add4H:rd,add5H:id,add5L:nd},Y=od;var[ad,sd]=Y.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Oe=new Uint32Array(80),Me=new Uint32Array(80),Sr=class extends Br{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:f,Eh:c,El:u,Fh:h,Fl:l,Gh:x,Gl:d,Hh:p,Hl:y}=this;return[e,r,n,i,o,s,a,f,c,u,h,l,x,d,p,y]}set(e,r,n,i,o,s,a,f,c,u,h,l,x,d,p,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=x|0,this.Gl=d|0,this.Hh=p|0,this.Hl=y|0}process(e,r){for(let b=0;b<16;b++,r+=4)Oe[b]=e.getUint32(r),Me[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let R=Oe[b-15]|0,w=Me[b-15]|0,B=Y.rotrSH(R,w,1)^Y.rotrSH(R,w,8)^Y.shrSH(R,w,7),L=Y.rotrSL(R,w,1)^Y.rotrSL(R,w,8)^Y.shrSL(R,w,7),D=Oe[b-2]|0,z=Me[b-2]|0,H=Y.rotrSH(D,z,19)^Y.rotrBH(D,z,61)^Y.shrSH(D,z,6),V=Y.rotrSL(D,z,19)^Y.rotrBL(D,z,61)^Y.shrSL(D,z,6),X=Y.add4L(L,V,Me[b-7],Me[b-16]),ft=Y.add4H(X,B,H,Oe[b-7],Oe[b-16]);Oe[b]=ft|0,Me[b]=X|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:f,Dh:c,Dl:u,Eh:h,El:l,Fh:x,Fl:d,Gh:p,Gl:y,Hh:m,Hl:E}=this;for(let b=0;b<80;b++){let R=Y.rotrSH(h,l,14)^Y.rotrSH(h,l,18)^Y.rotrBH(h,l,41),w=Y.rotrSL(h,l,14)^Y.rotrSL(h,l,18)^Y.rotrBL(h,l,41),B=h&x^~h&p,L=l&d^~l&y,D=Y.add5L(E,w,L,sd[b],Me[b]),z=Y.add5H(D,m,R,B,ad[b],Oe[b]),H=D|0,V=Y.rotrSH(n,i,28)^Y.rotrBH(n,i,34)^Y.rotrBH(n,i,39),X=Y.rotrSL(n,i,28)^Y.rotrBL(n,i,34)^Y.rotrBL(n,i,39),ft=n&o^n&a^o&a,Lt=i&s^i&f^s&f;m=p|0,E=y|0,p=x|0,y=d|0,x=h|0,d=l|0,{h,l}=Y.add(c|0,u|0,z|0,H|0),c=a|0,u=f|0,a=o|0,f=s|0,o=n|0,s=i|0;let I=Y.add3L(H,X,Lt);n=Y.add3H(I,z,V,ft),i=I|0}({h:n,l:i}=Y.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=Y.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:f}=Y.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:c,l:u}=Y.add(this.Dh|0,this.Dl|0,c|0,u|0),{h,l}=Y.add(this.Eh|0,this.El|0,h|0,l|0),{h:x,l:d}=Y.add(this.Fh|0,this.Fl|0,x|0,d|0),{h:p,l:y}=Y.add(this.Gh|0,this.Gl|0,p|0,y|0),{h:m,l:E}=Y.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,i,o,s,a,f,c,u,h,l,x,d,p,y,m,E)}roundClean(){Oe.fill(0),Me.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Ji=class extends Sr{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},ji=class extends Sr{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},to=class extends Sr{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}},eo=Ue(()=>new Sr),py=Ue(()=>new Ji),yy=Ue(()=>new ji),xy=Ue(()=>new to);var qn={};At(qn,{bitGet:()=>ld,bitLen:()=>hd,bitMask:()=>Qr,bitSet:()=>dd,bytesToHex:()=>de,bytesToNumberBE:()=>te,bytesToNumberLE:()=>pe,concatBytes:()=>ee,createHmacDrbg:()=>io,ensureBytes:()=>ht,equalBytes:()=>Zs,hexToBytes:()=>tr,hexToNumber:()=>no,numberToBytesBE:()=>Ae,numberToBytesLE:()=>qe,numberToHexUnpadded:()=>Ys,numberToVarBytesBE:()=>ud,utf8ToBytes:()=>$s,validateObject:()=>Zt});var Ws=BigInt(0),On=BigInt(1),fd=BigInt(2),Mn=t=>t instanceof Uint8Array,cd=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function de(t){if(!Mn(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=cd[t[r]];return e}function Ys(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function no(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function tr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,o=t.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function te(t){return no(de(t))}function pe(t){if(!Mn(t))throw new Error("Uint8Array expected");return no(de(Uint8Array.from(t).reverse()))}function Ae(t,e){return tr(t.toString(16).padStart(e*2,"0"))}function qe(t,e){return Ae(t,e).reverse()}function ud(t){return tr(Ys(t))}function ht(t,e,r){let n;if(typeof e=="string")try{n=tr(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(Mn(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function ee(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Mn(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function Zs(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function $s(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function hd(t){let e;for(e=0;t>Ws;t>>=On,e+=1);return e}function ld(t,e){return t>>BigInt(e)&On}var dd=(t,e,r)=>t|(r?On:Ws)<<BigInt(e),Qr=t=>(fd<<BigInt(t-1))-On,ro=t=>new Uint8Array(t),Gs=t=>Uint8Array.from(t);function io(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=ro(t),i=ro(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...h)=>r(i,n,...h),f=(h=ro())=>{i=a(Gs([0]),h),n=a(),h.length!==0&&(i=a(Gs([1]),h),n=a())},c=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,l=[];for(;h<e;){n=a();let x=n.slice();l.push(x),h+=n.length}return ee(...l)};return(h,l)=>{s(),f(h);let x;for(;!(x=l(c()));)f();return s(),x}}var pd={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Zt(t,e,r={}){let n=(i,o,s)=>{let a=pd[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let f=t[i];if(!(s&&f===void 0)&&!a(f,t))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}var St=BigInt(0),yt=BigInt(1),er=BigInt(2),yd=BigInt(3),oo=BigInt(4),Qs=BigInt(5),Xs=BigInt(8),xd=BigInt(9),gd=BigInt(16);function at(t,e){let r=t%e;return r>=St?r:e+r}function Js(t,e,r){if(r<=St||e<St)throw new Error("Expected power/modulo > 0");if(r===yt)return St;let n=yt;for(;e>St;)e&yt&&(n=n*t%r),t=t*t%r,e>>=yt;return n}function xt(t,e,r){let n=t;for(;e-- >St;)n*=n,n%=r;return n}function Vn(t,e){if(t===St||e<=St)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=at(t,e),n=e,i=St,o=yt,s=yt,a=St;for(;r!==St;){let c=n/r,u=n%r,h=i-s*c,l=o-a*c;n=r,r=u,i=s,o=a,s=h,a=l}if(n!==yt)throw new Error("invert: does not exist");return at(i,e)}function md(t){let e=(t-yt)/er,r,n,i;for(r=t-yt,n=0;r%er===St;r/=er,n++);for(i=er;i<t&&Js(i,e,t)!==t-yt;i++);if(n===1){let s=(t+yt)/oo;return function(f,c){let u=f.pow(c,s);if(!f.eql(f.sqr(u),c))throw new Error("Cannot find square root");return u}}let o=(r+yt)/er;return function(a,f){if(a.pow(f,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let c=n,u=a.pow(a.mul(a.ONE,i),r),h=a.pow(f,o),l=a.pow(f,r);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let x=1;for(let p=a.sqr(l);x<c&&!a.eql(p,a.ONE);x++)p=a.sqr(p);let d=a.pow(u,yt<<BigInt(c-x-1));u=a.sqr(d),h=a.mul(h,d),l=a.mul(l,u),c=x}return h}}function vd(t){if(t%oo===yd){let e=(t+yt)/oo;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%Xs===Qs){let e=(t-Qs)/Xs;return function(n,i){let o=n.mul(i,er),s=n.pow(o,e),a=n.mul(i,s),f=n.mul(n.mul(a,er),s),c=n.mul(a,n.sub(f,n.ONE));if(!n.eql(n.sqr(c),i))throw new Error("Cannot find square root");return c}}return t%gd,md(t)}var js=(t,e)=>(at(t,e)&yt)===yt,bd=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ao(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=bd.reduce((n,i)=>(n[i]="function",n),e);return Zt(t,r)}function Ed(t,e,r){if(r<St)throw new Error("Expected power > 0");if(r===St)return t.ONE;if(r===yt)return e;let n=t.ONE,i=e;for(;r>St;)r&yt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=yt;return n}function wd(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}function Fn(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Hn(t,e,r=!1,n={}){if(t<=St)throw new Error(`Expected Fp ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=Fn(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=vd(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:Qr(i),ZERO:St,ONE:yt,create:f=>at(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return St<=f&&f<t},is0:f=>f===St,isOdd:f=>(f&yt)===yt,neg:f=>at(-f,t),eql:(f,c)=>f===c,sqr:f=>at(f*f,t),add:(f,c)=>at(f+c,t),sub:(f,c)=>at(f-c,t),mul:(f,c)=>at(f*c,t),pow:(f,c)=>Ed(a,f,c),div:(f,c)=>at(f*Vn(c,t),t),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>Vn(f,t),sqrt:n.sqrt||(f=>s(a,f)),invertBatch:f=>wd(a,f),cmov:(f,c,u)=>u?c:f,toBytes:f=>r?qe(f,o):Ae(f,o),fromBytes:f=>{if(f.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${f.length}`);return r?pe(f):te(f)}});return Object.freeze(a)}function t0(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function e0(t,e,r=!1){t=ht("privateHash",t);let n=t.length,i=Fn(e).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let o=r?pe(t):te(t);return at(o,e-yt)+yt}var Sd=BigInt(0),so=BigInt(1);function zn(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>Sd;)o&so&&(s=s.add(a)),a=a.double(),o>>=so;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),f=[],c=i,u=c;for(let h=0;h<s;h++){u=c,f.push(u);for(let l=1;l<a;l++)u=u.add(c),f.push(u);c=u.double()}return f},wNAF(i,o,s){let{windows:a,windowSize:f}=n(i),c=t.ZERO,u=t.BASE,h=BigInt(2**i-1),l=2**i,x=BigInt(i);for(let d=0;d<a;d++){let p=d*f,y=Number(s&h);s>>=x,y>f&&(y-=l,s+=so);let m=p,E=p+Math.abs(y)-1,b=d%2!==0,R=y<0;y===0?u=u.add(r(b,o[m])):c=c.add(r(R,o[E]))}return{p:c,f:u}},wNAFCached(i,o,s,a){let f=i._WINDOW_SIZE||1,c=o.get(i);return c||(c=this.precomputeWindow(i,f),f!==1&&o.set(i,a(c))),this.wNAF(f,c,s)}}}function Xr(t){return ao(t.Fp),Zt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Fn(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var re=BigInt(0),Ht=BigInt(1),Gn=BigInt(2),Ad=BigInt(8),Cd={zip215:!0};function Id(t){let e=Xr(t);return Zt(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Wn(t){let e=Id(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:f}=e,c=Gn<<BigInt(a*8)-Ht,u=r.create,h=e.uvRatio||((N,A)=>{try{return{isValid:!0,value:r.sqrt(N*r.inv(A))}}catch{return{isValid:!1,value:re}}}),l=e.adjustScalarBytes||(N=>N),x=e.domain||((N,A,U)=>{if(A.length||U)throw new Error("Contexts/pre-hash are not supported");return N}),d=N=>typeof N=="bigint"&&re<N,p=(N,A)=>d(N)&&d(A)&&N<A,y=N=>N===re||p(N,c);function m(N,A){if(p(N,A))return N;throw new Error(`Expected valid scalar < ${A}, got ${typeof N} ${N}`)}function E(N){return N===re?N:m(N,n)}let b=new Map;function R(N){if(!(N instanceof w))throw new Error("ExtendedPoint expected")}class w{constructor(A,U,O,F){if(this.ex=A,this.ey=U,this.ez=O,this.et=F,!y(A))throw new Error("x required");if(!y(U))throw new Error("y required");if(!y(O))throw new Error("z required");if(!y(F))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof w)throw new Error("extended point not allowed");let{x:U,y:O}=A||{};if(!y(U)||!y(O))throw new Error("invalid affine point");return new w(U,O,Ht,u(U*O))}static normalizeZ(A){let U=r.invertBatch(A.map(O=>O.ez));return A.map((O,F)=>O.toAffine(U[F])).map(w.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:U}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:O,ey:F,ez:Z,et:J}=this,st=u(O*O),j=u(F*F),it=u(Z*Z),Et=u(it*it),mt=u(st*A),Dt=u(it*u(mt+j)),Nt=u(Et+u(U*u(st*j)));if(Dt!==Nt)throw new Error("bad point: equation left != right (1)");let Bt=u(O*F),Kt=u(Z*J);if(Bt!==Kt)throw new Error("bad point: equation left != right (2)")}equals(A){R(A);let{ex:U,ey:O,ez:F}=this,{ex:Z,ey:J,ez:st}=A,j=u(U*st),it=u(Z*F),Et=u(O*st),mt=u(J*F);return j===it&&Et===mt}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:A}=e,{ex:U,ey:O,ez:F}=this,Z=u(U*U),J=u(O*O),st=u(Gn*u(F*F)),j=u(A*Z),it=U+O,Et=u(u(it*it)-Z-J),mt=j+J,Dt=mt-st,Nt=j-J,Bt=u(Et*Dt),Kt=u(mt*Nt),ve=u(Et*Nt),We=u(Dt*mt);return new w(Bt,Kt,We,ve)}add(A){R(A);let{a:U,d:O}=e,{ex:F,ey:Z,ez:J,et:st}=this,{ex:j,ey:it,ez:Et,et:mt}=A;if(U===BigInt(-1)){let Jo=u((Z-F)*(it+j)),jo=u((Z+F)*(it-j)),oi=u(jo-Jo);if(oi===re)return this.double();let ta=u(J*Gn*mt),ea=u(st*Gn*Et),ra=ea+ta,na=jo+Jo,ia=ea-ta,Wf=u(ra*oi),Yf=u(na*ia),Zf=u(ra*ia),$f=u(oi*na);return new w(Wf,Yf,$f,Zf)}let Dt=u(F*j),Nt=u(Z*it),Bt=u(st*O*mt),Kt=u(J*Et),ve=u((F+Z)*(j+it)-Dt-Nt),We=Kt-Bt,Or=Kt+Bt,Xo=u(Nt-U*Dt),Ff=u(ve*We),Hf=u(Or*Xo),zf=u(ve*Xo),Gf=u(We*Or);return new w(Ff,Hf,Gf,zf)}subtract(A){return this.add(A.negate())}wNAF(A){return D.wNAFCached(this,b,A,w.normalizeZ)}multiply(A){let{p:U,f:O}=this.wNAF(m(A,n));return w.normalizeZ([U,O])[0]}multiplyUnsafe(A){let U=E(A);return U===re?L:this.equals(L)||U===Ht?this:this.equals(B)?this.wNAF(U).p:D.unsafeLadder(this,U)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return D.unsafeLadder(this,n).is0()}toAffine(A){let{ex:U,ey:O,ez:F}=this,Z=this.is0();A==null&&(A=Z?Ad:r.inv(F));let J=u(U*A),st=u(O*A),j=u(F*A);if(Z)return{x:re,y:Ht};if(j!==Ht)throw new Error("invZ was invalid");return{x:J,y:st}}clearCofactor(){let{h:A}=e;return A===Ht?this:this.multiplyUnsafe(A)}static fromHex(A,U=!1){let{d:O,a:F}=e,Z=r.BYTES;A=ht("pointHex",A,Z);let J=A.slice(),st=A[Z-1];J[Z-1]=st&-129;let j=pe(J);j===re||(U?m(j,c):m(j,r.ORDER));let it=u(j*j),Et=u(it-Ht),mt=u(O*it-F),{isValid:Dt,value:Nt}=h(Et,mt);if(!Dt)throw new Error("Point.fromHex: invalid y coordinate");let Bt=(Nt&Ht)===Ht,Kt=(st&128)!==0;if(!U&&Nt===re&&Kt)throw new Error("Point.fromHex: x=0 and x_0=1");return Kt!==Bt&&(Nt=u(-Nt)),w.fromAffine({x:Nt,y:j})}static fromPrivateKey(A){return V(A).point}toRawBytes(){let{x:A,y:U}=this.toAffine(),O=qe(U,r.BYTES);return O[O.length-1]|=A&Ht?128:0,O}toHex(){return de(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,Ht,u(e.Gx*e.Gy)),w.ZERO=new w(re,Ht,Ht,re);let{BASE:B,ZERO:L}=w,D=zn(w,a*8);function z(N){return at(N,n)}function H(N){return z(pe(N))}function V(N){let A=a;N=ht("private key",N,A);let U=ht("hashed private key",o(N),2*A),O=l(U.slice(0,A)),F=U.slice(A,2*A),Z=H(O),J=B.multiply(Z),st=J.toRawBytes();return{head:O,prefix:F,scalar:Z,point:J,pointBytes:st}}function X(N){return V(N).pointBytes}function ft(N=new Uint8Array,...A){let U=ee(...A);return H(o(x(U,ht("context",N),!!i)))}function Lt(N,A,U={}){N=ht("message",N),i&&(N=i(N));let{prefix:O,scalar:F,pointBytes:Z}=V(A),J=ft(U.context,O,N),st=B.multiply(J).toRawBytes(),j=ft(U.context,st,Z,N),it=z(J+j*F);E(it);let Et=ee(st,qe(it,r.BYTES));return ht("result",Et,a*2)}let I=Cd;function k(N,A,U,O=I){let{context:F,zip215:Z}=O,J=r.BYTES;N=ht("signature",N,2*J),A=ht("message",A),i&&(A=i(A));let st=pe(N.slice(J,2*J)),j,it,Et;try{j=w.fromHex(U,Z),it=w.fromHex(N.slice(0,J),Z),Et=B.multiplyUnsafe(st)}catch{return!1}if(!Z&&j.isSmallOrder())return!1;let mt=ft(F,it.toRawBytes(),j.toRawBytes(),A);return it.add(j.multiplyUnsafe(mt)).subtract(Et).clearCofactor().equals(w.ZERO)}return B._setWindowSize(8),{CURVE:e,getPublicKey:X,sign:Lt,verify:k,ExtendedPoint:w,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>s(r.BYTES),precompute(N=8,A=w.BASE){return A._setWindowSize(N),A.multiply(BigInt(3)),A}}}}var Ty=BigInt(0),_y=BigInt(1);var co=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),r0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Hy=BigInt(0),_d=BigInt(1),fo=BigInt(2),Rd=BigInt(5),n0=BigInt(10),Ld=BigInt(20),Dd=BigInt(40),i0=BigInt(80);function Nd(t){let e=co,n=t*t%e*t%e,i=xt(n,fo,e)*n%e,o=xt(i,_d,e)*t%e,s=xt(o,Rd,e)*o%e,a=xt(s,n0,e)*s%e,f=xt(a,Ld,e)*a%e,c=xt(f,Dd,e)*f%e,u=xt(c,i0,e)*c%e,h=xt(u,i0,e)*c%e,l=xt(h,n0,e)*s%e;return{pow_p_5_8:xt(l,fo,e)*t%e,b2:n}}function kd(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Pd(t,e){let r=co,n=at(e*e*e,r),i=at(n*n*e,r),o=Nd(t*i).pow_p_5_8,s=at(t*n*o,r),a=at(e*s*s,r),f=s,c=at(s*r0,r),u=a===t,h=a===at(-t,r),l=a===at(-t*r0,r);return u&&(s=f),(h||l)&&(s=c),js(s,r)&&(s=at(-s,r)),{isValid:u||h,value:s}}var Ce=Hn(co,void 0,!0),uo={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ce,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:eo,randomBytes:je,adjustScalarBytes:kd,uvRatio:Pd},Ar=Wn(uo);function o0(t,e,r){if(e.length>255)throw new Error("Context is too big");return Kn(Qi("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var zy=Wn({...uo,domain:o0}),Gy=Wn({...uo,domain:o0,prehash:eo});var Kd=(Ce.ORDER+BigInt(3))/BigInt(8),Wy=Ce.pow(fo,Kd),Yy=Ce.sqrt(Ce.neg(Ce.ONE)),Zy=(Ce.ORDER-BigInt(5))/BigInt(8),$y=BigInt(486662);var Qy=t0(Ce,Ce.neg(BigInt(486664)));var Xy=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Jy=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),jy=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),t2=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var e2=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Cr=32,Ie=64,Yn=32;async function a0(){let t=Ar.utils.randomPrivateKey(),e=Ar.getPublicKey(t);return{privateKey:u0(t,e),publicKey:e}}async function s0(t){if(t.length!==Yn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=Ar.getPublicKey(e);return{privateKey:u0(e,r),publicKey:r}}async function f0(t,e){let r=t.subarray(0,Yn);return Ar.sign(e,r)}async function c0(t,e,r){return Ar.verify(e,r,t)}function u0(t,e){let r=new Uint8Array(Ie);for(let n=0;n<Yn;n++)r[n]=t[n],r[Yn+n]=e[n];return r}function rr(t,e){e==null&&(e=t.reduce((i,o)=>i+o.length,0));let r=Dn(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return pr(r)}var Vt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var ho={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function lo(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",o=t?.saltLength??16,s=t?.iterations??32767,a=Vt.get();r*=8;async function f(h,l){let x=a.getRandomValues(new Uint8Array(o)),d=a.getRandomValues(new Uint8Array(n)),p={name:e,iv:d};typeof l=="string"&&(l=Pt(l));let y;if(l.length===0){y=await a.subtle.importKey("jwk",ho,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",ho,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}let m=await a.subtle.encrypt(p,y,h);return rr([x,p.iv,new Uint8Array(m)])}async function c(h,l){let x=h.subarray(0,o),d=h.subarray(o,o+n),p=h.subarray(o+n),y={name:e,iv:d};typeof l=="string"&&(l=Pt(l));let m;if(l.length===0)try{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}catch{m=await a.subtle.importKey("jwk",ho,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:x,iterations:s,hash:{name:i}},R=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await a.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}let E=await a.subtle.decrypt(y,m,p);return new Uint8Array(E)}return{encrypt:f,decrypt:c}}async function Ir(t,e){let n=await lo().encrypt(t,e);return Rn.encode(n)}var Co=Ct(mo(),1),J0=Ct(z0(),1),j0=Ct(ir(),1),Io=Ct(Ao(),1),tf=Ct(X0(),1);function Wd(){j0.default._configure(),Co.default._configure(J0.default),Io.default._configure(tf.default)}Wd();var ef=["uint64","int64","sint64","fixed64","sfixed64"];function Yd(t){for(let e of ef){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function To(t){return Yd(new Co.default(t))}function Zd(t){for(let e of ef){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function _o(){return Zd(Io.default.create())}function _r(t,e){let r=To(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Rr(t,e){let r=_o();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Lr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Lr||(Lr={}));function Jn(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Ro(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return Jn("enum",Lr.VARINT,r,n)}function Dr(t,e){return Jn("message",Lr.LENGTH_DELIMITED,t,e)}var gt;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(gt||(gt={}));var Lo;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Lo||(Lo={}));(function(t){t.codec=()=>Ro(Lo)})(gt||(gt={}));var ge;(function(t){let e;t.codec=()=>(e==null&&(e=Dr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),gt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=gt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Rr(r,t.codec()),t.decode=r=>_r(r,t.codec())})(ge||(ge={}));var me;(function(t){let e;t.codec=()=>(e==null&&(e=Dr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),gt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=gt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Rr(r,t.codec()),t.decode=r=>_r(r,t.codec())})(me||(me={}));var tn=class{_key;constructor(e){this._key=Nr(e,Cr)}async verify(e,r){return c0(this._key,r,e)}marshal(){return this._key}get bytes(){return ge.encode({Type:gt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Ft(this.bytes,e.bytes)}async hash(){let{bytes:e}=await kt.digest(this.bytes);return e}},ar=class{_key;_publicKey;constructor(e,r){this._key=Nr(e,Ie),this._publicKey=Nr(r,Cr)}async sign(e){return f0(this._key,e)}get public(){return new tn(this._publicKey)}marshal(){return this._key}get bytes(){return me.encode({Type:gt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Ft(this.bytes,e.bytes)}async hash(){let{bytes:e}=await kt.digest(this.bytes);return e}async id(){let e=Ke.digest(this.public.bytes);return Mt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Ir(this.bytes,e);throw new et(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function $d(t){if(t.length>Ie){t=Nr(t,Ie+Cr);let n=t.subarray(0,Ie),i=t.subarray(Ie,t.length);return new ar(n,i)}t=Nr(t,Ie);let e=t.subarray(0,Ie),r=t.subarray(Cr);return new ar(e,r)}function Qd(t){return t=Nr(t,Cr),new tn(t)}async function Xd(){let{privateKey:t,publicKey:e}=await a0();return new ar(t,e)}async function rf(t){let{privateKey:e,publicKey:r}=await s0(t);return new ar(e,r)}function Nr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new et(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}function zt(t,e="utf8"){let r=Nn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Q2=Ct(wt(),1),X2=Ct(Cn(),1),nf=Ct(ct(),1);function oe(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=rr([new Uint8Array(e-r.length),r])}return zt(r,"base64url")}function Gt(t){let e=of(t);return new nf.default.jsbn.BigInteger(zt(e,"base16"),16)}function of(t,e){let r=Pt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=rr([new Uint8Array(e-r.length),r])}return r}var Jd={"P-256":256,"P-384":384,"P-521":521},jd=Object.keys(Jd),fx=jd.join(" / ");var Uo={};At(Uo,{MAX_KEY_SIZE:()=>on,RsaPrivateKey:()=>kr,RsaPublicKey:()=>nn,fromJwk:()=>up,generateKeyPair:()=>hp,unmarshalRsaPrivateKey:()=>fp,unmarshalRsaPublicKey:()=>cp});var rn=Ct(ct(),1);var Wx=Ct(uf(),1);function ti(t){if(isNaN(t)||t<=0)throw new et("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return je(t)}var Tx=Ct(_n(),1),Po=Ct(ct(),1);function hf(t,e){return e.map(r=>Gt(t[r]))}function lf(t){return Po.default.pki.setRsaPrivateKey(...hf(t,["n","e","d","p","q","dp","dq","qi"]))}function df(t){return Po.default.pki.setRsaPublicKey(...hf(t,["n","e"]))}var fr={};At(fr,{jwkToPkcs1:()=>np,jwkToPkix:()=>op,pkcs1ToJwk:()=>rp,pkixToJwk:()=>ip});var Lx=Ct(Fr(),1),Dx=Ct(_n(),1);var Te=Ct(ct(),1);function rp(t){let e=Te.default.asn1.fromDer(zt(t,"ascii")),r=Te.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:oe(r.n),e:oe(r.e),d:oe(r.d),p:oe(r.p),q:oe(r.q),dp:oe(r.dP),dq:oe(r.dQ),qi:oe(r.qInv),alg:"RS256"}}function np(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new et("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Te.default.pki.privateKeyToAsn1({n:Gt(t.n),e:Gt(t.e),d:Gt(t.d),p:Gt(t.p),q:Gt(t.q),dP:Gt(t.dp),dQ:Gt(t.dq),qInv:Gt(t.qi)});return Pt(Te.default.asn1.toDer(e).getBytes(),"ascii")}function ip(t){let e=Te.default.asn1.fromDer(zt(t,"ascii")),r=Te.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:oe(r.n),e:oe(r.e)}}function op(t){if(t.n==null||t.e==null)throw new et("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Te.default.pki.publicKeyToAsn1({n:Gt(t.n),e:Gt(t.e)});return Pt(Te.default.asn1.toDer(e).getBytes(),"ascii")}async function pf(t){let e=await Vt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await gf(e);return{privateKey:r[0],publicKey:r[1]}}async function Ko(t){let r=[await Vt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await ap(t)],n=await gf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function yf(t,e){let r=await Vt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Vt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function xf(t,e,r){let n=await Vt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Vt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function gf(t){if(t.privateKey==null||t.publicKey==null)throw new et("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Vt.get().subtle.exportKey("jwk",t.privateKey),Vt.get().subtle.exportKey("jwk",t.publicKey)])}async function ap(t){return Vt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function mf(t,e,r,n){let i=e?df(t):lf(t),o=zt(Uint8Array.from(r),"ascii"),s=n(o,i);return Pt(s,"ascii")}function vf(t,e){return mf(t,!0,e,(r,n)=>n.encrypt(r))}function bf(t,e){return mf(t,!1,e,(r,n)=>n.decrypt(r))}function ei(t){if(t.kty!=="RSA")throw new et("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new et("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Pt(t.n,"base64url").length*8}var on=8192,nn=class{_key;constructor(e){this._key=e}async verify(e,r){return xf(this._key,r,e)}marshal(){return fr.jwkToPkix(this._key)}get bytes(){return ge.encode({Type:gt.RSA,Data:this.marshal()}).subarray()}encrypt(e){return vf(this._key,e)}equals(e){return Ft(this.bytes,e.bytes)}async hash(){let{bytes:e}=await kt.digest(this.bytes);return e}},kr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return ti(16)}async sign(e){return yf(this._key,e)}get public(){if(this._publicKey==null)throw new et("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new nn(this._publicKey)}decrypt(e){return bf(this._key,e)}marshal(){return fr.jwkToPkcs1(this._key)}get bytes(){return me.encode({Type:gt.RSA,Data:this.marshal()}).subarray()}equals(e){return Ft(this.bytes,e.bytes)}async hash(){let{bytes:e}=await kt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return zt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new rn.default.util.ByteBuffer(this.marshal()),i=rn.default.asn1.fromDer(n),o=rn.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return rn.default.pki.encryptRsaPrivateKey(o,e,s)}else{if(r==="libp2p-key")return Ir(this.bytes,e);throw new et(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function fp(t){let e=fr.pkcs1ToJwk(t);if(ei(e)>on)throw new et("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await Ko(e);return new kr(r.privateKey,r.publicKey)}function cp(t){let e=fr.pkixToJwk(t);if(ei(e)>on)throw new et("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new nn(e)}async function up(t){if(ei(t)>on)throw new et("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Ko(t);return new kr(e.privateKey,e.publicKey)}async function hp(t){if(t>on)throw new et("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await pf(t);return new kr(e.privateKey,e.publicKey)}var Ho={};At(Ho,{Secp256k1PrivateKey:()=>sn,Secp256k1PublicKey:()=>an,generateKeyPair:()=>Cp,unmarshalSecp256k1PrivateKey:()=>Sp,unmarshalSecp256k1PublicKey:()=>Ap});var lp=(t,e,r)=>t&e^~t&r,dp=(t,e,r)=>t&e^t&r^e&r,pp=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),He=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ze=new Uint32Array(64),ri=class extends Br{constructor(){super(64,32,8,!1),this.A=He[0]|0,this.B=He[1]|0,this.C=He[2]|0,this.D=He[3]|0,this.E=He[4]|0,this.F=He[5]|0,this.G=He[6]|0,this.H=He[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:f}=this;return[e,r,n,i,o,s,a,f]}set(e,r,n,i,o,s,a,f){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=f|0}process(e,r){for(let h=0;h<16;h++,r+=4)ze[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let l=ze[h-15],x=ze[h-2],d=jt(l,7)^jt(l,18)^l>>>3,p=jt(x,17)^jt(x,19)^x>>>10;ze[h]=p+ze[h-7]+d+ze[h-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:f,G:c,H:u}=this;for(let h=0;h<64;h++){let l=jt(a,6)^jt(a,11)^jt(a,25),x=u+l+lp(a,f,c)+pp[h]+ze[h]|0,p=(jt(n,2)^jt(n,13)^jt(n,22))+dp(n,i,o)|0;u=c,c=f,f=a,a=s+x|0,s=o,o=i,i=n,n=x+p|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,f,c,u)}roundClean(){ze.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Oo=class extends ri{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},Ef=Ue(()=>new ri),Xx=Ue(()=>new Oo);function yp(t){let e=Xr(t);Zt(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:xp,hexToBytes:gp}=qn,cr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=cr;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:xp(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=cr,r=typeof t=="string"?gp(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=cr._parseInt(r.subarray(2)),{d:s,l:a}=cr._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,r=c=>{let u=c.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),f=r(s);return`30${r(s+o+4)}02${f}${i}02${a}${n}`}},_e=BigInt(0),Qt=BigInt(1),rg=BigInt(2),wf=BigInt(3),ng=BigInt(4);function mp(t){let e=yp(t),{Fp:r}=e,n=e.toBytes||((d,p,y)=>{let m=p.toAffine();return ee(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),i=e.fromBytes||(d=>{let p=d.subarray(1),y=r.fromBytes(p.subarray(0,r.BYTES)),m=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function o(d){let{a:p,b:y}=e,m=r.sqr(d),E=r.mul(m,d);return r.add(r.add(E,r.mul(d,p)),y)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(d){return typeof d=="bigint"&&_e<d&&d<e.n}function a(d){if(!s(d))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(d){let{allowedPrivateKeyLengths:p,nByteLength:y,wrapPrivateKey:m,n:E}=e;if(p&&typeof d!="bigint"){if(d instanceof Uint8Array&&(d=de(d)),typeof d!="string"||!p.includes(d.length))throw new Error("Invalid key");d=d.padStart(y*2,"0")}let b;try{b=typeof d=="bigint"?d:te(ht("private key",d,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof d}`)}return m&&(b=at(b,E)),a(b),b}let c=new Map;function u(d){if(!(d instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,y,m){if(this.px=p,this.py=y,this.pz=m,p==null||!r.isValid(p))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(p){let{x:y,y:m}=p||{};if(!p||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");let E=b=>r.eql(b,r.ZERO);return E(y)&&E(m)?h.ZERO:new h(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let y=r.invertBatch(p.map(m=>m.pz));return p.map((m,E)=>m.toAffine(y[E])).map(h.fromAffine)}static fromHex(p){let y=h.fromAffine(i(ht("pointHex",p)));return y.assertValidity(),y}static fromPrivateKey(p){return h.BASE.multiply(f(p))}_setWindowSize(p){this._WINDOW_SIZE=p,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:p,y}=this.toAffine();if(!r.isValid(p)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=o(p);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=p,B=r.eql(r.mul(y,w),r.mul(b,E)),L=r.eql(r.mul(m,w),r.mul(R,E));return B&&L}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:y}=e,m=r.mul(y,wf),{px:E,py:b,pz:R}=this,w=r.ZERO,B=r.ZERO,L=r.ZERO,D=r.mul(E,E),z=r.mul(b,b),H=r.mul(R,R),V=r.mul(E,b);return V=r.add(V,V),L=r.mul(E,R),L=r.add(L,L),w=r.mul(p,L),B=r.mul(m,H),B=r.add(w,B),w=r.sub(z,B),B=r.add(z,B),B=r.mul(w,B),w=r.mul(V,w),L=r.mul(m,L),H=r.mul(p,H),V=r.sub(D,H),V=r.mul(p,V),V=r.add(V,L),L=r.add(D,D),D=r.add(L,D),D=r.add(D,H),D=r.mul(D,V),B=r.add(B,D),H=r.mul(b,R),H=r.add(H,H),D=r.mul(H,V),w=r.sub(w,D),L=r.mul(H,z),L=r.add(L,L),L=r.add(L,L),new h(w,B,L)}add(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=p,B=r.ZERO,L=r.ZERO,D=r.ZERO,z=e.a,H=r.mul(e.b,wf),V=r.mul(y,b),X=r.mul(m,R),ft=r.mul(E,w),Lt=r.add(y,m),I=r.add(b,R);Lt=r.mul(Lt,I),I=r.add(V,X),Lt=r.sub(Lt,I),I=r.add(y,E);let k=r.add(b,w);return I=r.mul(I,k),k=r.add(V,ft),I=r.sub(I,k),k=r.add(m,E),B=r.add(R,w),k=r.mul(k,B),B=r.add(X,ft),k=r.sub(k,B),D=r.mul(z,I),B=r.mul(H,ft),D=r.add(B,D),B=r.sub(X,D),D=r.add(X,D),L=r.mul(B,D),X=r.add(V,V),X=r.add(X,V),ft=r.mul(z,ft),I=r.mul(H,I),X=r.add(X,ft),ft=r.sub(V,ft),ft=r.mul(z,ft),I=r.add(I,ft),V=r.mul(X,I),L=r.add(L,V),V=r.mul(k,I),B=r.mul(Lt,B),B=r.sub(B,V),V=r.mul(Lt,X),D=r.mul(k,D),D=r.add(D,V),new h(B,L,D)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return x.wNAFCached(this,c,p,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,b)=>E.toAffine(m[b])).map(h.fromAffine)})}multiplyUnsafe(p){let y=h.ZERO;if(p===_e)return y;if(a(p),p===Qt)return this;let{endo:m}=e;if(!m)return x.unsafeLadder(this,p);let{k1neg:E,k1:b,k2neg:R,k2:w}=m.splitScalar(p),B=y,L=y,D=this;for(;b>_e||w>_e;)b&Qt&&(B=B.add(D)),w&Qt&&(L=L.add(D)),D=D.double(),b>>=Qt,w>>=Qt;return E&&(B=B.negate()),R&&(L=L.negate()),L=new h(r.mul(L.px,m.beta),L.py,L.pz),B.add(L)}multiply(p){a(p);let y=p,m,E,{endo:b}=e;if(b){let{k1neg:R,k1:w,k2neg:B,k2:L}=b.splitScalar(y),{p:D,f:z}=this.wNAF(w),{p:H,f:V}=this.wNAF(L);D=x.constTimeNegate(R,D),H=x.constTimeNegate(B,H),H=new h(r.mul(H.px,b.beta),H.py,H.pz),m=D.add(H),E=z.add(V)}else{let{p:R,f:w}=this.wNAF(y);m=R,E=w}return h.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(p,y,m){let E=h.BASE,b=(w,B)=>B===_e||B===Qt||!w.equals(E)?w.multiplyUnsafe(B):w.multiply(B),R=b(this,y).add(b(p,m));return R.is0()?void 0:R}toAffine(p){let{px:y,py:m,pz:E}=this,b=this.is0();p==null&&(p=b?r.ONE:r.inv(E));let R=r.mul(y,p),w=r.mul(m,p),B=r.mul(E,p);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:R,y:w}}isTorsionFree(){let{h:p,isTorsionFree:y}=e;if(p===Qt)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:y}=e;return p===Qt?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return de(this.toRawBytes(p))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let l=e.nBitLength,x=zn(h,e.endo?Math.ceil(l/2):l);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:f,weierstrassEquation:o,isWithinCurveOrder:s}}function vp(t){let e=Xr(t);return Zt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Bf(t){let e=vp(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(I){return _e<I&&I<r.ORDER}function a(I){return at(I,n)}function f(I){return Vn(I,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=mp({...e,toBytes(I,k,_){let N=k.toAffine(),A=r.toBytes(N.x),U=ee;return _?U(Uint8Array.from([k.hasEvenY()?2:3]),A):U(Uint8Array.from([4]),A,r.toBytes(N.y))},fromBytes(I){let k=I.length,_=I[0],N=I.subarray(1);if(k===i&&(_===2||_===3)){let A=te(N);if(!s(A))throw new Error("Point is not on curve");let U=h(A),O=r.sqrt(U),F=(O&Qt)===Qt;return(_&1)===1!==F&&(O=r.neg(O)),{x:A,y:O}}else if(k===o&&_===4){let A=r.fromBytes(N.subarray(0,r.BYTES)),U=r.fromBytes(N.subarray(r.BYTES,2*r.BYTES));return{x:A,y:U}}else throw new Error(`Point of length ${k} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),x=I=>de(Ae(I,e.nByteLength));function d(I){let k=n>>Qt;return I>k}function p(I){return d(I)?a(-I):I}let y=(I,k,_)=>te(I.slice(k,_));class m{constructor(k,_,N){this.r=k,this.s=_,this.recovery=N,this.assertValidity()}static fromCompact(k){let _=e.nByteLength;return k=ht("compactSignature",k,_*2),new m(y(k,0,_),y(k,_,2*_))}static fromDER(k){let{r:_,s:N}=cr.toSig(ht("DER",k));return new m(_,N)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(k){return new m(this.r,this.s,k)}recoverPublicKey(k){let{r:_,s:N,recovery:A}=this,U=L(ht("msgHash",k));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let O=A===2||A===3?_+e.n:_;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let F=A&1?"03":"02",Z=c.fromHex(F+x(O)),J=f(O),st=a(-U*J),j=a(N*J),it=c.BASE.multiplyAndAddUnsafe(Z,st,j);if(!it)throw new Error("point at infinify");return it.assertValidity(),it}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return tr(this.toDERHex())}toDERHex(){return cr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return tr(this.toCompactHex())}toCompactHex(){return x(this.r)+x(this.s)}}let E={isValidPrivateKey(I){try{return u(I),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let I=e.randomBytes(r.BYTES+8),k=e0(I,n);return Ae(k,e.nByteLength)},precompute(I=8,k=c.BASE){return k._setWindowSize(I),k.multiply(BigInt(3)),k}};function b(I,k=!0){return c.fromPrivateKey(I).toRawBytes(k)}function R(I){let k=I instanceof Uint8Array,_=typeof I=="string",N=(k||_)&&I.length;return k?N===i||N===o:_?N===2*i||N===2*o:I instanceof c}function w(I,k,_=!0){if(R(I))throw new Error("first arg must be private key");if(!R(k))throw new Error("second arg must be public key");return c.fromHex(k).multiply(u(I)).toRawBytes(_)}let B=e.bits2int||function(I){let k=te(I),_=I.length*8-e.nBitLength;return _>0?k>>BigInt(_):k},L=e.bits2int_modN||function(I){return a(B(I))},D=Qr(e.nBitLength);function z(I){if(typeof I!="bigint")throw new Error("bigint expected");if(!(_e<=I&&I<D))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ae(I,e.nByteLength)}function H(I,k,_=V){if(["recovered","canonical"].some(mt=>mt in _))throw new Error("sign() legacy options not supported");let{hash:N,randomBytes:A}=e,{lowS:U,prehash:O,extraEntropy:F}=_;U==null&&(U=!0),I=ht("msgHash",I),O&&(I=ht("prehashed msgHash",N(I)));let Z=L(I),J=u(k),st=[z(J),z(Z)];if(F!=null){let mt=F===!0?A(r.BYTES):F;st.push(ht("extraEntropy",mt,r.BYTES))}let j=ee(...st),it=Z;function Et(mt){let Dt=B(mt);if(!l(Dt))return;let Nt=f(Dt),Bt=c.BASE.multiply(Dt).toAffine(),Kt=a(Bt.x);if(Kt===_e)return;let ve=a(Nt*a(it+Kt*J));if(ve===_e)return;let We=(Bt.x===Kt?0:2)|Number(Bt.y&Qt),Or=ve;return U&&d(ve)&&(Or=p(ve),We^=1),new m(Kt,Or,We)}return{seed:j,k2sig:Et}}let V={lowS:e.lowS,prehash:!1},X={lowS:e.lowS,prehash:!1};function ft(I,k,_=V){let{seed:N,k2sig:A}=H(I,k,_),U=e;return io(U.hash.outputLen,U.nByteLength,U.hmac)(N,A)}c.BASE._setWindowSize(8);function Lt(I,k,_,N=X){let A=I;if(k=ht("msgHash",k),_=ht("publicKey",_),"strict"in N)throw new Error("options.strict was renamed to lowS");let{lowS:U,prehash:O}=N,F,Z;try{if(typeof A=="string"||A instanceof Uint8Array)try{F=m.fromDER(A)}catch(Bt){if(!(Bt instanceof cr.Err))throw Bt;F=m.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:Bt,s:Kt}=A;F=new m(Bt,Kt)}else throw new Error("PARSE");Z=c.fromHex(_)}catch(Bt){if(Bt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(U&&F.hasHighS())return!1;O&&(k=e.hash(k));let{r:J,s:st}=F,j=L(k),it=f(st),Et=a(j*it),mt=a(J*it),Dt=c.BASE.multiplyAndAddUnsafe(Z,Et,mt)?.toAffine();return Dt?a(Dt.x)===J:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:w,sign:ft,verify:Lt,ProjectivePoint:c,Signature:m,utils:E}}var ni=class extends wr{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Se.hash(e);let n=$r(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return Se.exists(this),this.iHash.update(e),this}digestInto(e){Se.exists(this),Se.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Mo=(t,e,r)=>new ni(t,e).update(r).digest();Mo.create=(t,e)=>new ni(t,e);function bp(t){return{hash:t,hmac:(e,...r)=>Mo(t,e,Kn(...r)),randomBytes:je}}function Sf(t,e){let r=n=>Bf({...t,...bp(n)});return Object.freeze({...r(e),create:r})}var If=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Af=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Ep=BigInt(1),qo=BigInt(2),Cf=(t,e)=>(t+e/qo)/e;function wp(t){let e=If,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),f=BigInt(88),c=t*t*t%e,u=c*c*t%e,h=xt(u,r,e)*u%e,l=xt(h,r,e)*u%e,x=xt(l,qo,e)*c%e,d=xt(x,i,e)*x%e,p=xt(d,o,e)*d%e,y=xt(p,a,e)*p%e,m=xt(y,f,e)*y%e,E=xt(m,a,e)*p%e,b=xt(E,r,e)*u%e,R=xt(b,s,e)*d%e,w=xt(R,n,e)*c%e,B=xt(w,qo,e);if(!Vo.eql(Vo.sqr(B),t))throw new Error("Cannot find square root");return B}var Vo=Hn(If,void 0,void 0,{sqrt:wp}),Re=Sf({a:BigInt(0),b:BigInt(7),Fp:Vo,n:Af,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=Af,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Ep*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Cf(o*t,e),f=Cf(-n*t,e),c=at(t-a*r-f*i,e),u=at(-a*n-f*o,e),h=c>s,l=u>s;if(h&&(c=e-c),l&&(u=e-u),c>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:l,k2:u}}}},Ef),Eg=BigInt(0);var wg=Re.ProjectivePoint;function Tf(){return Re.utils.randomPrivateKey()}async function _f(t,e){let{digest:r}=await kt.digest(e);try{return Re.sign(r,t).toDERRawBytes()}catch(n){throw new et(String(n),"ERR_INVALID_INPUT")}}async function Rf(t,e,r){try{let{digest:n}=await kt.digest(r);return Re.verify(e,n,t)}catch(n){throw new et(String(n),"ERR_INVALID_INPUT")}}function Lf(t){return Re.ProjectivePoint.fromHex(t).toRawBytes(!0)}function Df(t){try{Re.getPublicKey(t,!0)}catch(e){throw new et(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Fo(t){try{Re.ProjectivePoint.fromHex(t)}catch(e){throw new et(String(e),"ERR_INVALID_PUBLIC_KEY")}}function Nf(t){try{return Re.getPublicKey(t,!0)}catch(e){throw new et(String(e),"ERR_INVALID_PRIVATE_KEY")}}var an=class{_key;constructor(e){Fo(e),this._key=e}async verify(e,r){return Rf(this._key,r,e)}marshal(){return Lf(this._key)}get bytes(){return ge.encode({Type:gt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Ft(this.bytes,e.bytes)}async hash(){let{bytes:e}=await kt.digest(this.bytes);return e}},sn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??Nf(e),Df(this._key),Fo(this._publicKey)}async sign(e){return _f(this._key,e)}get public(){return new an(this._publicKey)}marshal(){return this._key}get bytes(){return me.encode({Type:gt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Ft(this.bytes,e.bytes)}async hash(){let{bytes:e}=await kt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return zt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Ir(this.bytes,e);throw new et(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Sp(t){return new sn(t)}function Ap(t){return new an(t)}async function Cp(){let t=Tf();return new sn(t)}var Ge={rsa:Uo,ed25519:Do,secp256k1:Ho};function zo(t){let e=Object.keys(Ge).join(" / ");return new et(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Go(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return Ge[t];throw zo(t)}async function ii(t,e){return Go(t).generateKeyPair(e??2048)}function kf(t){let e=ge.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case gt.RSA:return Ge.rsa.unmarshalRsaPublicKey(r);case gt.Ed25519:return Ge.ed25519.unmarshalEd25519PublicKey(r);case gt.Secp256k1:return Ge.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw zo(e.Type??"RSA")}}function Wo(t,e){return e=(e??"rsa").toLowerCase(),Go(e),t.bytes}async function Pf(t){let e=me.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case gt.RSA:return Ge.rsa.unmarshalRsaPrivateKey(r);case gt.Ed25519:return Ge.ed25519.unmarshalEd25519PrivateKey(r);case gt.Secp256k1:return Ge.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw zo(e.Type??"RSA")}}function Kf(t,e){return e=(e??"rsa").toLowerCase(),Go(e),t.bytes}var Uf=Symbol.for("@libp2p/peer-id");var Tp=Symbol.for("nodejs.util.inspect.custom"),Of=Object.values(Er).map(t=>t.decoder).reduce((t,e)=>t.or(e),Er.identity.decoder),Mf=114,Yo=36,Zo=37,fn=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Uf]=!0;toString(){return this.string==null&&(this.string=Mt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Je.createV1(Mf,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Ft(this.multihash.bytes,e);if(typeof e=="string")return _p(e).equals(this);if(e?.multihash?.bytes!=null)return Ft(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Tp](){return`PeerId(${this.toString()})`}},Pr=class extends fn{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Kr=class extends fn{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},Ur=class extends fn{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function _p(t,e){if(e=e??Of,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Yr(Mt.decode(`z${t}`));return t.startsWith("12D")?new Kr({multihash:r}):t.startsWith("16U")?new Ur({multihash:r}):new Pr({multihash:r})}return $o(Of.decode(t))}function $o(t){try{let e=Yr(t);if(e.code===Ke.code){if(e.digest.length===Yo)return new Kr({multihash:e});if(e.digest.length===Zo)return new Ur({multihash:e})}if(e.code===kt.code)return new Pr({multihash:e})}catch{return Rp(Je.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function Rp(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==Mf)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===kt.code)return new Pr({multihash:t.multihash});if(e.code===Ke.code){if(e.digest.length===Yo)return new Kr({multihash:t.multihash});if(e.digest.length===Zo)return new Ur({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function Qo(t,e){return t.length===Yo?new Kr({multihash:le(Ke.code,t),privateKey:e}):t.length===Zo?new Ur({multihash:le(Ke.code,t),privateKey:e}):new Pr({multihash:await kt.digest(t),publicKey:t,privateKey:e})}var cn;(function(t){let e;t.codec=()=>(e==null&&(e=Dr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.id!=null&&(n.uint32(10),n.bytes(r.id)),r.pubKey!=null&&(n.uint32(18),n.bytes(r.pubKey)),r.privKey!=null&&(n.uint32(26),n.bytes(r.privKey)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.id=r.bytes();break;case 2:i.pubKey=r.bytes();break;case 3:i.privKey=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Rr(r,t.codec()),t.decode=r=>_r(r,t.codec())})(cn||(cn={}));var Lp=async()=>{let t=await ii("Ed25519"),e=await un(t);if(e.type==="Ed25519")return e;throw new Error(`Generated unexpected PeerId type "${e.type}"`)},Dp=async()=>{let t=await ii("secp256k1"),e=await un(t);if(e.type==="secp256k1")return e;throw new Error(`Generated unexpected PeerId type "${e.type}"`)},Np=async t=>{let e=await ii("RSA",t?.bits??2048),r=await un(e);if(r.type==="RSA")return r;throw new Error(`Generated unexpected PeerId type "${r.type}"`)};async function qf(t){return Qo(Wo(t))}async function un(t){return Qo(Wo(t.public),Kf(t))}function kp(t,e){return cn.encode({id:t.multihash.bytes,pubKey:t.publicKey,privKey:e===!0||t.privateKey==null?void 0:t.privateKey})}async function Pp(t){let{id:e,privKey:r,pubKey:n}=cn.decode(t);return Vf(e??new Uint8Array(0),r,n)}async function Kp(t){return Vf(Pt(t.id,"base58btc"),t.privKey!=null?Pt(t.privKey,"base64pad"):void 0,t.pubKey!=null?Pt(t.pubKey,"base64pad"):void 0)}async function Vf(t,e,r){if(e!=null){let n=await Pf(e);return un(n)}else if(r!=null){let n=kf(r);return qf(n)}return $o(t)}return ec(Up);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerIdFactory}));
